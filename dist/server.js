/*!
 * Copyright (c) 2025 Augment
 * Proprietary and Confidential
 * Licensed for use only with Vim plugin - See LICENSE.md
 * Modification or reverse engineering prohibited
 */
"use strict";var BD=Object.create;var Ma=Object.defineProperty;var UD=Object.getOwnPropertyDescriptor;var $D=Object.getOwnPropertyNames;var WD=Object.getPrototypeOf,jD=Object.prototype.hasOwnProperty;var re=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),zD=(t,e)=>{for(var n in e)Ma(t,n,{get:e[n],enumerable:!0})},Qm=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of $D(e))!jD.call(t,s)&&s!==n&&Ma(t,s,{get:()=>e[s],enumerable:!(i=UD(e,s))||i.enumerable});return t};var Tt=(t,e,n)=>(n=t!=null?BD(WD(t)):{},Qm(e||!t||!t.__esModule?Ma(n,"default",{value:t,enumerable:!0}):n,t)),HD=t=>Qm(Ma({},"__esModule",{value:!0}),t);var qa=re(Dt=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.thenable=Dt.typedArray=Dt.stringArray=Dt.array=Dt.func=Dt.error=Dt.number=Dt.string=Dt.boolean=void 0;function GD(t){return t===!0||t===!1}Dt.boolean=GD;function Km(t){return typeof t=="string"||t instanceof String}Dt.string=Km;function QD(t){return typeof t=="number"||t instanceof Number}Dt.number=QD;function JD(t){return t instanceof Error}Dt.error=JD;function Zm(t){return typeof t=="function"}Dt.func=Zm;function eb(t){return Array.isArray(t)}Dt.array=eb;function XD(t){return eb(t)&&t.every(e=>Km(e))}Dt.stringArray=XD;function YD(t,e){return Array.isArray(t)&&t.every(e)}Dt.typedArray=YD;function KD(t){return t&&Zm(t.then)}Dt.thenable=KD});var eo=re(zt=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.stringArray=zt.array=zt.func=zt.error=zt.number=zt.string=zt.boolean=void 0;function ZD(t){return t===!0||t===!1}zt.boolean=ZD;function tb(t){return typeof t=="string"||t instanceof String}zt.string=tb;function eI(t){return typeof t=="number"||t instanceof Number}zt.number=eI;function tI(t){return t instanceof Error}zt.error=tI;function nI(t){return typeof t=="function"}zt.func=nI;function nb(t){return Array.isArray(t)}zt.array=nb;function rI(t){return nb(t)&&t.every(e=>tb(e))}zt.stringArray=rI});var $d=re(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.Message=ue.NotificationType9=ue.NotificationType8=ue.NotificationType7=ue.NotificationType6=ue.NotificationType5=ue.NotificationType4=ue.NotificationType3=ue.NotificationType2=ue.NotificationType1=ue.NotificationType0=ue.NotificationType=ue.RequestType9=ue.RequestType8=ue.RequestType7=ue.RequestType6=ue.RequestType5=ue.RequestType4=ue.RequestType3=ue.RequestType2=ue.RequestType1=ue.RequestType=ue.RequestType0=ue.AbstractMessageSignature=ue.ParameterStructures=ue.ResponseError=ue.ErrorCodes=void 0;var ki=eo(),bd;(function(t){t.ParseError=-32700,t.InvalidRequest=-32600,t.MethodNotFound=-32601,t.InvalidParams=-32602,t.InternalError=-32603,t.jsonrpcReservedErrorRangeStart=-32099,t.serverErrorStart=-32099,t.MessageWriteError=-32099,t.MessageReadError=-32098,t.PendingResponseRejected=-32097,t.ConnectionInactive=-32096,t.ServerNotInitialized=-32002,t.UnknownErrorCode=-32001,t.jsonrpcReservedErrorRangeEnd=-32e3,t.serverErrorEnd=-32e3})(bd||(ue.ErrorCodes=bd={}));var _d=class t extends Error{constructor(e,n,i){super(n),this.code=ki.number(e)?e:bd.UnknownErrorCode,this.data=i,Object.setPrototypeOf(this,t.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};ue.ResponseError=_d;var un=class t{constructor(e){this.kind=e}static is(e){return e===t.auto||e===t.byName||e===t.byPosition}toString(){return this.kind}};ue.ParameterStructures=un;un.auto=new un("auto");un.byPosition=new un("byPosition");un.byName=new un("byName");var st=class{constructor(e,n){this.method=e,this.numberOfParams=n}get parameterStructures(){return un.auto}};ue.AbstractMessageSignature=st;var vd=class extends st{constructor(e){super(e,0)}};ue.RequestType0=vd;var yd=class extends st{constructor(e,n=un.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};ue.RequestType=yd;var wd=class extends st{constructor(e,n=un.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};ue.RequestType1=wd;var Pd=class extends st{constructor(e){super(e,2)}};ue.RequestType2=Pd;var xd=class extends st{constructor(e){super(e,3)}};ue.RequestType3=xd;var Sd=class extends st{constructor(e){super(e,4)}};ue.RequestType4=Sd;var Cd=class extends st{constructor(e){super(e,5)}};ue.RequestType5=Cd;var kd=class extends st{constructor(e){super(e,6)}};ue.RequestType6=kd;var Rd=class extends st{constructor(e){super(e,7)}};ue.RequestType7=Rd;var Td=class extends st{constructor(e){super(e,8)}};ue.RequestType8=Td;var Dd=class extends st{constructor(e){super(e,9)}};ue.RequestType9=Dd;var Id=class extends st{constructor(e,n=un.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};ue.NotificationType=Id;var Ed=class extends st{constructor(e){super(e,0)}};ue.NotificationType0=Ed;var Fd=class extends st{constructor(e,n=un.auto){super(e,1),this._parameterStructures=n}get parameterStructures(){return this._parameterStructures}};ue.NotificationType1=Fd;var Md=class extends st{constructor(e){super(e,2)}};ue.NotificationType2=Md;var Ad=class extends st{constructor(e){super(e,3)}};ue.NotificationType3=Ad;var Nd=class extends st{constructor(e){super(e,4)}};ue.NotificationType4=Nd;var qd=class extends st{constructor(e){super(e,5)}};ue.NotificationType5=qd;var Ld=class extends st{constructor(e){super(e,6)}};ue.NotificationType6=Ld;var Od=class extends st{constructor(e){super(e,7)}};ue.NotificationType7=Od;var Bd=class extends st{constructor(e){super(e,8)}};ue.NotificationType8=Bd;var Ud=class extends st{constructor(e){super(e,9)}};ue.NotificationType9=Ud;var rb;(function(t){function e(s){let c=s;return c&&ki.string(c.method)&&(ki.string(c.id)||ki.number(c.id))}t.isRequest=e;function n(s){let c=s;return c&&ki.string(c.method)&&s.id===void 0}t.isNotification=n;function i(s){let c=s;return c&&(c.result!==void 0||!!c.error)&&(ki.string(c.id)||ki.number(c.id)||c.id===null)}t.isResponse=i})(rb||(ue.Message=rb={}))});var jd=re(Yr=>{"use strict";var ib;Object.defineProperty(Yr,"__esModule",{value:!0});Yr.LRUCache=Yr.LinkedMap=Yr.Touch=void 0;var Ht;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})(Ht||(Yr.Touch=Ht={}));var La=class{constructor(){this[ib]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,n=Ht.None){let i=this._map.get(e);if(i)return n!==Ht.None&&this.touch(i,n),i.value}set(e,n,i=Ht.None){let s=this._map.get(e);if(s)s.value=n,i!==Ht.None&&this.touch(s,i);else{switch(s={key:e,value:n,next:void 0,previous:void 0},i){case Ht.None:this.addItemLast(s);break;case Ht.First:this.addItemFirst(s);break;case Ht.Last:this.addItemLast(s);break;default:this.addItemLast(s);break}this._map.set(e,s),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let n=this._map.get(e);if(n)return this._map.delete(e),this.removeItem(n),this._size--,n.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,n){let i=this._state,s=this._head;for(;s;){if(n?e.bind(n)(s.value,s.key,this):e(s.value,s.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");s=s.next}}keys(){let e=this._state,n=this._head,i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:n.key,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return i}values(){let e=this._state,n=this._head,i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:n.value,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return i}entries(){let e=this._state,n=this._head,i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:[n.key,n.value],done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return i}[(ib=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let n=this._head,i=this.size;for(;n&&i>e;)this._map.delete(n.key),n=n.next,i--;this._head=n,this._size=i,n&&(n.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let n=e.next,i=e.previous;if(!n||!i)throw new Error("Invalid list");n.previous=i,i.next=n}e.next=void 0,e.previous=void 0,this._state++}touch(e,n){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(n!==Ht.First&&n!==Ht.Last)){if(n===Ht.First){if(e===this._head)return;let i=e.next,s=e.previous;e===this._tail?(s.next=void 0,this._tail=s):(i.previous=s,s.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(n===Ht.Last){if(e===this._tail)return;let i=e.next,s=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=s,s.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((n,i)=>{e.push([i,n])}),e}fromJSON(e){this.clear();for(let[n,i]of e)this.set(n,i)}};Yr.LinkedMap=La;var Wd=class extends La{constructor(e,n=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,n),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,n=Ht.AsNew){return super.get(e,n)}peek(e){return super.get(e,Ht.None)}set(e,n){return super.set(e,n,Ht.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};Yr.LRUCache=Wd});var sb=re(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.Disposable=void 0;var ob;(function(t){function e(n){return{dispose:n}}t.create=e})(ob||(Oa.Disposable=ob={}))});var Kr=re(Vd=>{"use strict";Object.defineProperty(Vd,"__esModule",{value:!0});var zd;function Hd(){if(zd===void 0)throw new Error("No runtime abstraction layer installed");return zd}(function(t){function e(n){if(n===void 0)throw new Error("No runtime abstraction layer provided");zd=n}t.install=e})(Hd||(Hd={}));Vd.default=Hd});var no=re(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});to.Emitter=to.Event=void 0;var iI=Kr(),ab;(function(t){let e={dispose(){}};t.None=function(){return e}})(ab||(to.Event=ab={}));var Gd=class{add(e,n=null,i){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(n),Array.isArray(i)&&i.push({dispose:()=>this.remove(e,n)})}remove(e,n=null){if(!this._callbacks)return;let i=!1;for(let s=0,c=this._callbacks.length;s<c;s++)if(this._callbacks[s]===e)if(this._contexts[s]===n){this._callbacks.splice(s,1),this._contexts.splice(s,1);return}else i=!0;if(i)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let n=[],i=this._callbacks.slice(0),s=this._contexts.slice(0);for(let c=0,u=i.length;c<u;c++)try{n.push(i[c].apply(s[c],e))}catch(h){(0,iI.default)().console.error(h)}return n}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},Ba=class t{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,n,i)=>{this._callbacks||(this._callbacks=new Gd),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,n);let s={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,n),s.dispose=t._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(i)&&i.push(s),s}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};to.Emitter=Ba;Ba._noop=function(){}});var Wa=re(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});ro.CancellationTokenSource=ro.CancellationToken=void 0;var oI=Kr(),sI=eo(),Qd=no(),Ua;(function(t){t.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Qd.Event.None}),t.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Qd.Event.None});function e(n){let i=n;return i&&(i===t.None||i===t.Cancelled||sI.boolean(i.isCancellationRequested)&&!!i.onCancellationRequested)}t.is=e})(Ua||(ro.CancellationToken=Ua={}));var aI=Object.freeze(function(t,e){let n=(0,oI.default)().timer.setTimeout(t.bind(e),0);return{dispose(){n.dispose()}}}),$a=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?aI:(this._emitter||(this._emitter=new Qd.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},Jd=class{get token(){return this._token||(this._token=new $a),this._token}cancel(){this._token?this._token.cancel():this._token=Ua.Cancelled}dispose(){this._token?this._token instanceof $a&&this._token.dispose():this._token=Ua.None}};ro.CancellationTokenSource=Jd});var cb=re(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});io.SharedArrayReceiverStrategy=io.SharedArraySenderStrategy=void 0;var cI=Wa(),is;(function(t){t.Continue=0,t.Cancelled=1})(is||(is={}));var Xd=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let n=new SharedArrayBuffer(4),i=new Int32Array(n,0,1);i[0]=is.Continue,this.buffers.set(e.id,n),e.$cancellationData=n}async sendCancellation(e,n){let i=this.buffers.get(n);if(i===void 0)return;let s=new Int32Array(i,0,1);Atomics.store(s,0,is.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};io.SharedArraySenderStrategy=Xd;var Yd=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===is.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},Kd=class{constructor(e){this.token=new Yd(e)}cancel(){}dispose(){}},Zd=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let n=e.$cancellationData;return n===void 0?new cI.CancellationTokenSource:new Kd(n)}};io.SharedArrayReceiverStrategy=Zd});var tf=re(ja=>{"use strict";Object.defineProperty(ja,"__esModule",{value:!0});ja.Semaphore=void 0;var uI=Kr(),ef=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((n,i)=>{this._waiting.push({thunk:e,resolve:n,reject:i}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,uI.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let n=e.thunk();n instanceof Promise?n.then(i=>{this._active--,e.resolve(i),this.runNext()},i=>{this._active--,e.reject(i),this.runNext()}):(this._active--,e.resolve(n),this.runNext())}catch(n){this._active--,e.reject(n),this.runNext()}}};ja.Semaphore=ef});var lb=re(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.ReadableStreamMessageReader=Zr.AbstractMessageReader=Zr.MessageReader=void 0;var rf=Kr(),oo=eo(),nf=no(),lI=tf(),ub;(function(t){function e(n){let i=n;return i&&oo.func(i.listen)&&oo.func(i.dispose)&&oo.func(i.onError)&&oo.func(i.onClose)&&oo.func(i.onPartialMessage)}t.is=e})(ub||(Zr.MessageReader=ub={}));var za=class{constructor(){this.errorEmitter=new nf.Emitter,this.closeEmitter=new nf.Emitter,this.partialMessageEmitter=new nf.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${oo.string(e.message)?e.message:"unknown"}`)}};Zr.AbstractMessageReader=za;var of;(function(t){function e(n){let i,s,c,u=new Map,h,g=new Map;if(n===void 0||typeof n=="string")i=n??"utf-8";else{if(i=n.charset??"utf-8",n.contentDecoder!==void 0&&(c=n.contentDecoder,u.set(c.name,c)),n.contentDecoders!==void 0)for(let b of n.contentDecoders)u.set(b.name,b);if(n.contentTypeDecoder!==void 0&&(h=n.contentTypeDecoder,g.set(h.name,h)),n.contentTypeDecoders!==void 0)for(let b of n.contentTypeDecoders)g.set(b.name,b)}return h===void 0&&(h=(0,rf.default)().applicationJson.decoder,g.set(h.name,h)),{charset:i,contentDecoder:c,contentDecoders:u,contentTypeDecoder:h,contentTypeDecoders:g}}t.fromOptions=e})(of||(of={}));var sf=class extends za{constructor(e,n){super(),this.readable=e,this.options=of.fromOptions(n),this.buffer=(0,rf.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new lI.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let n=this.readable.onData(i=>{this.onData(i)});return this.readable.onError(i=>this.fireError(i)),this.readable.onClose(()=>this.fireClose()),n}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let i=this.buffer.tryReadHeaders(!0);if(!i)return;let s=i.get("content-length");if(!s){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(i))}`));return}let c=parseInt(s);if(isNaN(c)){this.fireError(new Error(`Content-Length value must be a number. Got ${s}`));return}this.nextMessageLength=c}let n=this.buffer.tryReadBody(this.nextMessageLength);if(n===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let i=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(n):n,s=await this.options.contentTypeDecoder.decode(i,this.options);this.callback(s)}).catch(i=>{this.fireError(i)})}}catch(n){this.fireError(n)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,rf.default)().timer.setTimeout((e,n)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:n}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};Zr.ReadableStreamMessageReader=sf});var pb=re(ei=>{"use strict";Object.defineProperty(ei,"__esModule",{value:!0});ei.WriteableStreamMessageWriter=ei.AbstractMessageWriter=ei.MessageWriter=void 0;var db=Kr(),os=eo(),dI=tf(),fb=no(),fI="Content-Length: ",hb=`\r
`,gb;(function(t){function e(n){let i=n;return i&&os.func(i.dispose)&&os.func(i.onClose)&&os.func(i.onError)&&os.func(i.write)}t.is=e})(gb||(ei.MessageWriter=gb={}));var Ha=class{constructor(){this.errorEmitter=new fb.Emitter,this.closeEmitter=new fb.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,n,i){this.errorEmitter.fire([this.asError(e),n,i])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${os.string(e.message)?e.message:"unknown"}`)}};ei.AbstractMessageWriter=Ha;var af;(function(t){function e(n){return n===void 0||typeof n=="string"?{charset:n??"utf-8",contentTypeEncoder:(0,db.default)().applicationJson.encoder}:{charset:n.charset??"utf-8",contentEncoder:n.contentEncoder,contentTypeEncoder:n.contentTypeEncoder??(0,db.default)().applicationJson.encoder}}t.fromOptions=e})(af||(af={}));var cf=class extends Ha{constructor(e,n){super(),this.writable=e,this.options=af.fromOptions(n),this.errorCount=0,this.writeSemaphore=new dI.Semaphore(1),this.writable.onError(i=>this.fireError(i)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(i=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(i):i).then(i=>{let s=[];return s.push(fI,i.byteLength.toString(),hb),s.push(hb),this.doWrite(e,s,i)},i=>{throw this.fireError(i),i}))}async doWrite(e,n,i){try{return await this.writable.write(n.join(""),"ascii"),this.writable.write(i)}catch(s){return this.handleError(s,e),Promise.reject(s)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){this.writable.end()}};ei.WriteableStreamMessageWriter=cf});var mb=re(Va=>{"use strict";Object.defineProperty(Va,"__esModule",{value:!0});Va.AbstractMessageBuffer=void 0;var hI=13,gI=10,pI=`\r
`,uf=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let n=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(n),this._totalLength+=n.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let n=0,i=0,s=0,c=0;e:for(;i<this._chunks.length;){let b=this._chunks[i];for(s=0;s<b.length;){switch(b[s]){case hI:switch(n){case 0:n=1;break;case 2:n=3;break;default:n=0}break;case gI:switch(n){case 1:n=2;break;case 3:n=4,s++;break e;default:n=0}break;default:n=0}s++}c+=b.byteLength,i++}if(n!==4)return;let u=this._read(c+s),h=new Map,g=this.toString(u,"ascii").split(pI);if(g.length<2)return h;for(let b=0;b<g.length-2;b++){let y=g[b],T=y.indexOf(":");if(T===-1)throw new Error(`Message header must separate key and value using ':'
${y}`);let F=y.substr(0,T),E=y.substr(T+1).trim();h.set(e?F.toLowerCase():F,E)}return h}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let c=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(c)}if(this._chunks[0].byteLength>e){let c=this._chunks[0],u=this.asNative(c,e);return this._chunks[0]=c.slice(e),this._totalLength-=e,u}let n=this.allocNative(e),i=0,s=0;for(;e>0;){let c=this._chunks[s];if(c.byteLength>e){let u=c.slice(0,e);n.set(u,i),i+=e,this._chunks[s]=c.slice(e),this._totalLength-=e,e-=e}else n.set(c,i),i+=c.byteLength,this._chunks.shift(),this._totalLength-=c.byteLength,e-=c.byteLength}return n}};Va.AbstractMessageBuffer=uf});var wb=re(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.createMessageConnection=xe.ConnectionOptions=xe.MessageStrategy=xe.CancellationStrategy=xe.CancellationSenderStrategy=xe.CancellationReceiverStrategy=xe.RequestCancellationReceiverStrategy=xe.IdCancellationReceiverStrategy=xe.ConnectionStrategy=xe.ConnectionError=xe.ConnectionErrors=xe.LogTraceNotification=xe.SetTraceNotification=xe.TraceFormat=xe.TraceValues=xe.Trace=xe.NullLogger=xe.ProgressType=xe.ProgressToken=void 0;var bb=Kr(),mt=eo(),he=$d(),_b=jd(),ss=no(),lf=Wa(),us;(function(t){t.type=new he.NotificationType("$/cancelRequest")})(us||(us={}));var df;(function(t){function e(n){return typeof n=="string"||typeof n=="number"}t.is=e})(df||(xe.ProgressToken=df={}));var as;(function(t){t.type=new he.NotificationType("$/progress")})(as||(as={}));var ff=class{constructor(){}};xe.ProgressType=ff;var hf;(function(t){function e(n){return mt.func(n)}t.is=e})(hf||(hf={}));xe.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var He;(function(t){t[t.Off=0]="Off",t[t.Messages=1]="Messages",t[t.Compact=2]="Compact",t[t.Verbose=3]="Verbose"})(He||(xe.Trace=He={}));var vb;(function(t){t.Off="off",t.Messages="messages",t.Compact="compact",t.Verbose="verbose"})(vb||(xe.TraceValues=vb={}));(function(t){function e(i){if(!mt.string(i))return t.Off;switch(i=i.toLowerCase(),i){case"off":return t.Off;case"messages":return t.Messages;case"compact":return t.Compact;case"verbose":return t.Verbose;default:return t.Off}}t.fromString=e;function n(i){switch(i){case t.Off:return"off";case t.Messages:return"messages";case t.Compact:return"compact";case t.Verbose:return"verbose";default:return"off"}}t.toString=n})(He||(xe.Trace=He={}));var Cn;(function(t){t.Text="text",t.JSON="json"})(Cn||(xe.TraceFormat=Cn={}));(function(t){function e(n){return mt.string(n)?(n=n.toLowerCase(),n==="json"?t.JSON:t.Text):t.Text}t.fromString=e})(Cn||(xe.TraceFormat=Cn={}));var gf;(function(t){t.type=new he.NotificationType("$/setTrace")})(gf||(xe.SetTraceNotification=gf={}));var Ga;(function(t){t.type=new he.NotificationType("$/logTrace")})(Ga||(xe.LogTraceNotification=Ga={}));var cs;(function(t){t[t.Closed=1]="Closed",t[t.Disposed=2]="Disposed",t[t.AlreadyListening=3]="AlreadyListening"})(cs||(xe.ConnectionErrors=cs={}));var so=class t extends Error{constructor(e,n){super(n),this.code=e,Object.setPrototypeOf(this,t.prototype)}};xe.ConnectionError=so;var pf;(function(t){function e(n){let i=n;return i&&mt.func(i.cancelUndispatched)}t.is=e})(pf||(xe.ConnectionStrategy=pf={}));var Qa;(function(t){function e(n){let i=n;return i&&(i.kind===void 0||i.kind==="id")&&mt.func(i.createCancellationTokenSource)&&(i.dispose===void 0||mt.func(i.dispose))}t.is=e})(Qa||(xe.IdCancellationReceiverStrategy=Qa={}));var mf;(function(t){function e(n){let i=n;return i&&i.kind==="request"&&mt.func(i.createCancellationTokenSource)&&(i.dispose===void 0||mt.func(i.dispose))}t.is=e})(mf||(xe.RequestCancellationReceiverStrategy=mf={}));var Ja;(function(t){t.Message=Object.freeze({createCancellationTokenSource(n){return new lf.CancellationTokenSource}});function e(n){return Qa.is(n)||mf.is(n)}t.is=e})(Ja||(xe.CancellationReceiverStrategy=Ja={}));var Xa;(function(t){t.Message=Object.freeze({sendCancellation(n,i){return n.sendNotification(us.type,{id:i})},cleanup(n){}});function e(n){let i=n;return i&&mt.func(i.sendCancellation)&&mt.func(i.cleanup)}t.is=e})(Xa||(xe.CancellationSenderStrategy=Xa={}));var Ya;(function(t){t.Message=Object.freeze({receiver:Ja.Message,sender:Xa.Message});function e(n){let i=n;return i&&Ja.is(i.receiver)&&Xa.is(i.sender)}t.is=e})(Ya||(xe.CancellationStrategy=Ya={}));var Ka;(function(t){function e(n){let i=n;return i&&mt.func(i.handleMessage)}t.is=e})(Ka||(xe.MessageStrategy=Ka={}));var yb;(function(t){function e(n){let i=n;return i&&(Ya.is(i.cancellationStrategy)||pf.is(i.connectionStrategy)||Ka.is(i.messageStrategy))}t.is=e})(yb||(xe.ConnectionOptions=yb={}));var Yn;(function(t){t[t.New=1]="New",t[t.Listening=2]="Listening",t[t.Closed=3]="Closed",t[t.Disposed=4]="Disposed"})(Yn||(Yn={}));function mI(t,e,n,i){let s=n!==void 0?n:xe.NullLogger,c=0,u=0,h=0,g="2.0",b,y=new Map,T,F=new Map,E=new Map,L,B=new _b.LinkedMap,$=new Map,X=new Set,D=new Map,x=He.Off,O=Cn.Text,te,_e=Yn.New,Be=new ss.Emitter,Ye=new ss.Emitter,kt=new ss.Emitter,we=new ss.Emitter,Y=new ss.Emitter,z=i&&i.cancellationStrategy?i.cancellationStrategy:Ya.Message;function ae(S){if(S===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+S.toString()}function ie(S){return S===null?"res-unknown-"+(++h).toString():"res-"+S.toString()}function ke(){return"not-"+(++u).toString()}function ge(S,H){he.Message.isRequest(H)?S.set(ae(H.id),H):he.Message.isResponse(H)?S.set(ie(H.id),H):S.set(ke(),H)}function pe(S){}function wt(){return _e===Yn.Listening}function We(){return _e===Yn.Closed}function je(){return _e===Yn.Disposed}function pn(){(_e===Yn.New||_e===Yn.Listening)&&(_e=Yn.Closed,Ye.fire(void 0))}function _r(S){Be.fire([S,void 0,void 0])}function zn(S){Be.fire(S)}t.onClose(pn),t.onError(_r),e.onClose(pn),e.onError(zn);function sr(){L||B.size===0||(L=(0,bb.default)().timer.setImmediate(()=>{L=void 0,ar()}))}function gi(S){he.Message.isRequest(S)?qi(S):he.Message.isNotification(S)?yr(S):he.Message.isResponse(S)?vr(S):wr(S)}function ar(){if(B.size===0)return;let S=B.shift();try{let H=i?.messageStrategy;Ka.is(H)?H.handleMessage(S,gi):gi(S)}finally{sr()}}let cr=S=>{try{if(he.Message.isNotification(S)&&S.method===us.type.method){let H=S.params.id,Z=ae(H),oe=B.get(Z);if(he.Message.isRequest(oe)){let Le=i?.connectionStrategy,Qe=Le&&Le.cancelUndispatched?Le.cancelUndispatched(oe,pe):void 0;if(Qe&&(Qe.error!==void 0||Qe.result!==void 0)){B.delete(Z),D.delete(H),Qe.id=oe.id,Lt(Qe,S.method,Date.now()),e.write(Qe).catch(()=>s.error("Sending response for canceled message failed."));return}}let Ue=D.get(H);if(Ue!==void 0){Ue.cancel(),Br(S);return}else X.add(H)}ge(B,S)}finally{sr()}};function qi(S){if(je())return;function H(Re,Je,Ae){let it={jsonrpc:g,id:S.id};Re instanceof he.ResponseError?it.error=Re.toJson():it.result=Re===void 0?null:Re,Lt(it,Je,Ae),e.write(it).catch(()=>s.error("Sending response failed."))}function Z(Re,Je,Ae){let it={jsonrpc:g,id:S.id,error:Re.toJson()};Lt(it,Je,Ae),e.write(it).catch(()=>s.error("Sending response failed."))}function oe(Re,Je,Ae){Re===void 0&&(Re=null);let it={jsonrpc:g,id:S.id,result:Re};Lt(it,Je,Ae),e.write(it).catch(()=>s.error("Sending response failed."))}pi(S);let Ue=y.get(S.method),Le,Qe;Ue&&(Le=Ue.type,Qe=Ue.handler);let et=Date.now();if(Qe||b){let Re=S.id??String(Date.now()),Je=Qa.is(z.receiver)?z.receiver.createCancellationTokenSource(Re):z.receiver.createCancellationTokenSource(S);S.id!==null&&X.has(S.id)&&Je.cancel(),S.id!==null&&D.set(Re,Je);try{let Ae;if(Qe)if(S.params===void 0){if(Le!==void 0&&Le.numberOfParams!==0){Z(new he.ResponseError(he.ErrorCodes.InvalidParams,`Request ${S.method} defines ${Le.numberOfParams} params but received none.`),S.method,et);return}Ae=Qe(Je.token)}else if(Array.isArray(S.params)){if(Le!==void 0&&Le.parameterStructures===he.ParameterStructures.byName){Z(new he.ResponseError(he.ErrorCodes.InvalidParams,`Request ${S.method} defines parameters by name but received parameters by position`),S.method,et);return}Ae=Qe(...S.params,Je.token)}else{if(Le!==void 0&&Le.parameterStructures===he.ParameterStructures.byPosition){Z(new he.ResponseError(he.ErrorCodes.InvalidParams,`Request ${S.method} defines parameters by position but received parameters by name`),S.method,et);return}Ae=Qe(S.params,Je.token)}else b&&(Ae=b(S.method,S.params,Je.token));let it=Ae;Ae?it.then?it.then(Rt=>{D.delete(Re),H(Rt,S.method,et)},Rt=>{D.delete(Re),Rt instanceof he.ResponseError?Z(Rt,S.method,et):Rt&&mt.string(Rt.message)?Z(new he.ResponseError(he.ErrorCodes.InternalError,`Request ${S.method} failed with message: ${Rt.message}`),S.method,et):Z(new he.ResponseError(he.ErrorCodes.InternalError,`Request ${S.method} failed unexpectedly without providing any details.`),S.method,et)}):(D.delete(Re),H(Ae,S.method,et)):(D.delete(Re),oe(Ae,S.method,et))}catch(Ae){D.delete(Re),Ae instanceof he.ResponseError?H(Ae,S.method,et):Ae&&mt.string(Ae.message)?Z(new he.ResponseError(he.ErrorCodes.InternalError,`Request ${S.method} failed with message: ${Ae.message}`),S.method,et):Z(new he.ResponseError(he.ErrorCodes.InternalError,`Request ${S.method} failed unexpectedly without providing any details.`),S.method,et)}}else Z(new he.ResponseError(he.ErrorCodes.MethodNotFound,`Unhandled method ${S.method}`),S.method,et)}function vr(S){if(!je())if(S.id===null)S.error?s.error(`Received response message without id: Error is: 
${JSON.stringify(S.error,void 0,4)}`):s.error("Received response message without id. No further error information provided.");else{let H=S.id,Z=$.get(H);if(lr(S,Z),Z!==void 0){$.delete(H);try{if(S.error){let oe=S.error;Z.reject(new he.ResponseError(oe.code,oe.message,oe.data))}else if(S.result!==void 0)Z.resolve(S.result);else throw new Error("Should never happen.")}catch(oe){oe.message?s.error(`Response handler '${Z.method}' failed with message: ${oe.message}`):s.error(`Response handler '${Z.method}' failed unexpectedly.`)}}}}function yr(S){if(je())return;let H,Z;if(S.method===us.type.method){let oe=S.params.id;X.delete(oe),Br(S);return}else{let oe=F.get(S.method);oe&&(Z=oe.handler,H=oe.type)}if(Z||T)try{if(Br(S),Z)if(S.params===void 0)H!==void 0&&H.numberOfParams!==0&&H.parameterStructures!==he.ParameterStructures.byName&&s.error(`Notification ${S.method} defines ${H.numberOfParams} params but received none.`),Z();else if(Array.isArray(S.params)){let oe=S.params;S.method===as.type.method&&oe.length===2&&df.is(oe[0])?Z({token:oe[0],value:oe[1]}):(H!==void 0&&(H.parameterStructures===he.ParameterStructures.byName&&s.error(`Notification ${S.method} defines parameters by name but received parameters by position`),H.numberOfParams!==S.params.length&&s.error(`Notification ${S.method} defines ${H.numberOfParams} params but received ${oe.length} arguments`)),Z(...oe))}else H!==void 0&&H.parameterStructures===he.ParameterStructures.byPosition&&s.error(`Notification ${S.method} defines parameters by position but received parameters by name`),Z(S.params);else T&&T(S.method,S.params)}catch(oe){oe.message?s.error(`Notification handler '${S.method}' failed with message: ${oe.message}`):s.error(`Notification handler '${S.method}' failed unexpectedly.`)}else kt.fire(S)}function wr(S){if(!S){s.error("Received empty message.");return}s.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(S,null,4)}`);let H=S;if(mt.string(H.id)||mt.number(H.id)){let Z=H.id,oe=$.get(Z);oe&&oe.reject(new Error("The received response has neither a result nor an error property."))}}function gt(S){if(S!=null)switch(x){case He.Verbose:return JSON.stringify(S,null,4);case He.Compact:return JSON.stringify(S);default:return}}function ur(S){if(!(x===He.Off||!te))if(O===Cn.Text){let H;(x===He.Verbose||x===He.Compact)&&S.params&&(H=`Params: ${gt(S.params)}

`),te.log(`Sending request '${S.method} - (${S.id})'.`,H)}else Pt("send-request",S)}function Li(S){if(!(x===He.Off||!te))if(O===Cn.Text){let H;(x===He.Verbose||x===He.Compact)&&(S.params?H=`Params: ${gt(S.params)}

`:H=`No parameters provided.

`),te.log(`Sending notification '${S.method}'.`,H)}else Pt("send-notification",S)}function Lt(S,H,Z){if(!(x===He.Off||!te))if(O===Cn.Text){let oe;(x===He.Verbose||x===He.Compact)&&(S.error&&S.error.data?oe=`Error data: ${gt(S.error.data)}

`:S.result?oe=`Result: ${gt(S.result)}

`:S.error===void 0&&(oe=`No result returned.

`)),te.log(`Sending response '${H} - (${S.id})'. Processing request took ${Date.now()-Z}ms`,oe)}else Pt("send-response",S)}function pi(S){if(!(x===He.Off||!te))if(O===Cn.Text){let H;(x===He.Verbose||x===He.Compact)&&S.params&&(H=`Params: ${gt(S.params)}

`),te.log(`Received request '${S.method} - (${S.id})'.`,H)}else Pt("receive-request",S)}function Br(S){if(!(x===He.Off||!te||S.method===Ga.type.method))if(O===Cn.Text){let H;(x===He.Verbose||x===He.Compact)&&(S.params?H=`Params: ${gt(S.params)}

`:H=`No parameters provided.

`),te.log(`Received notification '${S.method}'.`,H)}else Pt("receive-notification",S)}function lr(S,H){if(!(x===He.Off||!te))if(O===Cn.Text){let Z;if((x===He.Verbose||x===He.Compact)&&(S.error&&S.error.data?Z=`Error data: ${gt(S.error.data)}

`:S.result?Z=`Result: ${gt(S.result)}

`:S.error===void 0&&(Z=`No result returned.

`)),H){let oe=S.error?` Request failed: ${S.error.message} (${S.error.code}).`:"";te.log(`Received response '${H.method} - (${S.id})' in ${Date.now()-H.timerStart}ms.${oe}`,Z)}else te.log(`Received response ${S.id} without active response promise.`,Z)}else Pt("receive-response",S)}function Pt(S,H){if(!te||x===He.Off)return;let Z={isLSPMessage:!0,type:S,message:H,timestamp:Date.now()};te.log(Z)}function nn(){if(We())throw new so(cs.Closed,"Connection is closed.");if(je())throw new so(cs.Disposed,"Connection is disposed.")}function Pr(){if(wt())throw new so(cs.AlreadyListening,"Connection is already listening")}function Oi(){if(!wt())throw new Error("Call listen() first.")}function $t(S){return S===void 0?null:S}function mi(S){if(S!==null)return S}function Hn(S){return S!=null&&!Array.isArray(S)&&typeof S=="object"}function mn(S,H){switch(S){case he.ParameterStructures.auto:return Hn(H)?mi(H):[$t(H)];case he.ParameterStructures.byName:if(!Hn(H))throw new Error("Received parameters by name but param is not an object literal.");return mi(H);case he.ParameterStructures.byPosition:return[$t(H)];default:throw new Error(`Unknown parameter structure ${S.toString()}`)}}function xr(S,H){let Z,oe=S.numberOfParams;switch(oe){case 0:Z=void 0;break;case 1:Z=mn(S.parameterStructures,H[0]);break;default:Z=[];for(let Ue=0;Ue<H.length&&Ue<oe;Ue++)Z.push($t(H[Ue]));if(H.length<oe)for(let Ue=H.length;Ue<oe;Ue++)Z.push(null);break}return Z}let bn={sendNotification:(S,...H)=>{nn();let Z,oe;if(mt.string(S)){Z=S;let Le=H[0],Qe=0,et=he.ParameterStructures.auto;he.ParameterStructures.is(Le)&&(Qe=1,et=Le);let Re=H.length,Je=Re-Qe;switch(Je){case 0:oe=void 0;break;case 1:oe=mn(et,H[Qe]);break;default:if(et===he.ParameterStructures.byName)throw new Error(`Received ${Je} parameters for 'by Name' notification parameter structure.`);oe=H.slice(Qe,Re).map(Ae=>$t(Ae));break}}else{let Le=H;Z=S.method,oe=xr(S,Le)}let Ue={jsonrpc:g,method:Z,params:oe};return Li(Ue),e.write(Ue).catch(Le=>{throw s.error("Sending notification failed."),Le})},onNotification:(S,H)=>{nn();let Z;return mt.func(S)?T=S:H&&(mt.string(S)?(Z=S,F.set(S,{type:void 0,handler:H})):(Z=S.method,F.set(S.method,{type:S,handler:H}))),{dispose:()=>{Z!==void 0?F.delete(Z):T=void 0}}},onProgress:(S,H,Z)=>{if(E.has(H))throw new Error(`Progress handler for token ${H} already registered`);return E.set(H,Z),{dispose:()=>{E.delete(H)}}},sendProgress:(S,H,Z)=>bn.sendNotification(as.type,{token:H,value:Z}),onUnhandledProgress:we.event,sendRequest:(S,...H)=>{nn(),Oi();let Z,oe,Ue;if(mt.string(S)){Z=S;let Re=H[0],Je=H[H.length-1],Ae=0,it=he.ParameterStructures.auto;he.ParameterStructures.is(Re)&&(Ae=1,it=Re);let Rt=H.length;lf.CancellationToken.is(Je)&&(Rt=Rt-1,Ue=Je);let Xt=Rt-Ae;switch(Xt){case 0:oe=void 0;break;case 1:oe=mn(it,H[Ae]);break;default:if(it===he.ParameterStructures.byName)throw new Error(`Received ${Xt} parameters for 'by Name' request parameter structure.`);oe=H.slice(Ae,Rt).map(Bi=>$t(Bi));break}}else{let Re=H;Z=S.method,oe=xr(S,Re);let Je=S.numberOfParams;Ue=lf.CancellationToken.is(Re[Je])?Re[Je]:void 0}let Le=c++,Qe;Ue&&(Qe=Ue.onCancellationRequested(()=>{let Re=z.sender.sendCancellation(bn,Le);return Re===void 0?(s.log(`Received no promise from cancellation strategy when cancelling id ${Le}`),Promise.resolve()):Re.catch(()=>{s.log(`Sending cancellation messages for id ${Le} failed`)})}));let et={jsonrpc:g,id:Le,method:Z,params:oe};return ur(et),typeof z.sender.enableCancellation=="function"&&z.sender.enableCancellation(et),new Promise(async(Re,Je)=>{let Ae=Xt=>{Re(Xt),z.sender.cleanup(Le),Qe?.dispose()},it=Xt=>{Je(Xt),z.sender.cleanup(Le),Qe?.dispose()},Rt={method:Z,timerStart:Date.now(),resolve:Ae,reject:it};try{await e.write(et),$.set(Le,Rt)}catch(Xt){throw s.error("Sending request failed."),Rt.reject(new he.ResponseError(he.ErrorCodes.MessageWriteError,Xt.message?Xt.message:"Unknown reason")),Xt}})},onRequest:(S,H)=>{nn();let Z=null;return hf.is(S)?(Z=void 0,b=S):mt.string(S)?(Z=null,H!==void 0&&(Z=S,y.set(S,{handler:H,type:void 0}))):H!==void 0&&(Z=S.method,y.set(S.method,{type:S,handler:H})),{dispose:()=>{Z!==null&&(Z!==void 0?y.delete(Z):b=void 0)}}},hasPendingResponse:()=>$.size>0,trace:async(S,H,Z)=>{let oe=!1,Ue=Cn.Text;Z!==void 0&&(mt.boolean(Z)?oe=Z:(oe=Z.sendNotification||!1,Ue=Z.traceFormat||Cn.Text)),x=S,O=Ue,x===He.Off?te=void 0:te=H,oe&&!We()&&!je()&&await bn.sendNotification(gf.type,{value:He.toString(S)})},onError:Be.event,onClose:Ye.event,onUnhandledNotification:kt.event,onDispose:Y.event,end:()=>{e.end()},dispose:()=>{if(je())return;_e=Yn.Disposed,Y.fire(void 0);let S=new he.ResponseError(he.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let H of $.values())H.reject(S);$=new Map,D=new Map,X=new Set,B=new _b.LinkedMap,mt.func(e.dispose)&&e.dispose(),mt.func(t.dispose)&&t.dispose()},listen:()=>{nn(),Pr(),_e=Yn.Listening,t.listen(cr)},inspect:()=>{(0,bb.default)().console.log("inspect")}};return bn.onNotification(Ga.type,S=>{if(x===He.Off||!te)return;let H=x===He.Verbose||x===He.Compact;te.log(S.message,H?S.verbose:void 0)}),bn.onNotification(as.type,S=>{let H=E.get(S.token);H?H(S.value):we.fire(S)}),bn}xe.createMessageConnection=mI});var Za=re(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.ProgressType=j.ProgressToken=j.createMessageConnection=j.NullLogger=j.ConnectionOptions=j.ConnectionStrategy=j.AbstractMessageBuffer=j.WriteableStreamMessageWriter=j.AbstractMessageWriter=j.MessageWriter=j.ReadableStreamMessageReader=j.AbstractMessageReader=j.MessageReader=j.SharedArrayReceiverStrategy=j.SharedArraySenderStrategy=j.CancellationToken=j.CancellationTokenSource=j.Emitter=j.Event=j.Disposable=j.LRUCache=j.Touch=j.LinkedMap=j.ParameterStructures=j.NotificationType9=j.NotificationType8=j.NotificationType7=j.NotificationType6=j.NotificationType5=j.NotificationType4=j.NotificationType3=j.NotificationType2=j.NotificationType1=j.NotificationType0=j.NotificationType=j.ErrorCodes=j.ResponseError=j.RequestType9=j.RequestType8=j.RequestType7=j.RequestType6=j.RequestType5=j.RequestType4=j.RequestType3=j.RequestType2=j.RequestType1=j.RequestType0=j.RequestType=j.Message=j.RAL=void 0;j.MessageStrategy=j.CancellationStrategy=j.CancellationSenderStrategy=j.CancellationReceiverStrategy=j.ConnectionError=j.ConnectionErrors=j.LogTraceNotification=j.SetTraceNotification=j.TraceFormat=j.TraceValues=j.Trace=void 0;var nt=$d();Object.defineProperty(j,"Message",{enumerable:!0,get:function(){return nt.Message}});Object.defineProperty(j,"RequestType",{enumerable:!0,get:function(){return nt.RequestType}});Object.defineProperty(j,"RequestType0",{enumerable:!0,get:function(){return nt.RequestType0}});Object.defineProperty(j,"RequestType1",{enumerable:!0,get:function(){return nt.RequestType1}});Object.defineProperty(j,"RequestType2",{enumerable:!0,get:function(){return nt.RequestType2}});Object.defineProperty(j,"RequestType3",{enumerable:!0,get:function(){return nt.RequestType3}});Object.defineProperty(j,"RequestType4",{enumerable:!0,get:function(){return nt.RequestType4}});Object.defineProperty(j,"RequestType5",{enumerable:!0,get:function(){return nt.RequestType5}});Object.defineProperty(j,"RequestType6",{enumerable:!0,get:function(){return nt.RequestType6}});Object.defineProperty(j,"RequestType7",{enumerable:!0,get:function(){return nt.RequestType7}});Object.defineProperty(j,"RequestType8",{enumerable:!0,get:function(){return nt.RequestType8}});Object.defineProperty(j,"RequestType9",{enumerable:!0,get:function(){return nt.RequestType9}});Object.defineProperty(j,"ResponseError",{enumerable:!0,get:function(){return nt.ResponseError}});Object.defineProperty(j,"ErrorCodes",{enumerable:!0,get:function(){return nt.ErrorCodes}});Object.defineProperty(j,"NotificationType",{enumerable:!0,get:function(){return nt.NotificationType}});Object.defineProperty(j,"NotificationType0",{enumerable:!0,get:function(){return nt.NotificationType0}});Object.defineProperty(j,"NotificationType1",{enumerable:!0,get:function(){return nt.NotificationType1}});Object.defineProperty(j,"NotificationType2",{enumerable:!0,get:function(){return nt.NotificationType2}});Object.defineProperty(j,"NotificationType3",{enumerable:!0,get:function(){return nt.NotificationType3}});Object.defineProperty(j,"NotificationType4",{enumerable:!0,get:function(){return nt.NotificationType4}});Object.defineProperty(j,"NotificationType5",{enumerable:!0,get:function(){return nt.NotificationType5}});Object.defineProperty(j,"NotificationType6",{enumerable:!0,get:function(){return nt.NotificationType6}});Object.defineProperty(j,"NotificationType7",{enumerable:!0,get:function(){return nt.NotificationType7}});Object.defineProperty(j,"NotificationType8",{enumerable:!0,get:function(){return nt.NotificationType8}});Object.defineProperty(j,"NotificationType9",{enumerable:!0,get:function(){return nt.NotificationType9}});Object.defineProperty(j,"ParameterStructures",{enumerable:!0,get:function(){return nt.ParameterStructures}});var bf=jd();Object.defineProperty(j,"LinkedMap",{enumerable:!0,get:function(){return bf.LinkedMap}});Object.defineProperty(j,"LRUCache",{enumerable:!0,get:function(){return bf.LRUCache}});Object.defineProperty(j,"Touch",{enumerable:!0,get:function(){return bf.Touch}});var bI=sb();Object.defineProperty(j,"Disposable",{enumerable:!0,get:function(){return bI.Disposable}});var Pb=no();Object.defineProperty(j,"Event",{enumerable:!0,get:function(){return Pb.Event}});Object.defineProperty(j,"Emitter",{enumerable:!0,get:function(){return Pb.Emitter}});var xb=Wa();Object.defineProperty(j,"CancellationTokenSource",{enumerable:!0,get:function(){return xb.CancellationTokenSource}});Object.defineProperty(j,"CancellationToken",{enumerable:!0,get:function(){return xb.CancellationToken}});var Sb=cb();Object.defineProperty(j,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return Sb.SharedArraySenderStrategy}});Object.defineProperty(j,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return Sb.SharedArrayReceiverStrategy}});var _f=lb();Object.defineProperty(j,"MessageReader",{enumerable:!0,get:function(){return _f.MessageReader}});Object.defineProperty(j,"AbstractMessageReader",{enumerable:!0,get:function(){return _f.AbstractMessageReader}});Object.defineProperty(j,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return _f.ReadableStreamMessageReader}});var vf=pb();Object.defineProperty(j,"MessageWriter",{enumerable:!0,get:function(){return vf.MessageWriter}});Object.defineProperty(j,"AbstractMessageWriter",{enumerable:!0,get:function(){return vf.AbstractMessageWriter}});Object.defineProperty(j,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return vf.WriteableStreamMessageWriter}});var _I=mb();Object.defineProperty(j,"AbstractMessageBuffer",{enumerable:!0,get:function(){return _I.AbstractMessageBuffer}});var Bt=wb();Object.defineProperty(j,"ConnectionStrategy",{enumerable:!0,get:function(){return Bt.ConnectionStrategy}});Object.defineProperty(j,"ConnectionOptions",{enumerable:!0,get:function(){return Bt.ConnectionOptions}});Object.defineProperty(j,"NullLogger",{enumerable:!0,get:function(){return Bt.NullLogger}});Object.defineProperty(j,"createMessageConnection",{enumerable:!0,get:function(){return Bt.createMessageConnection}});Object.defineProperty(j,"ProgressToken",{enumerable:!0,get:function(){return Bt.ProgressToken}});Object.defineProperty(j,"ProgressType",{enumerable:!0,get:function(){return Bt.ProgressType}});Object.defineProperty(j,"Trace",{enumerable:!0,get:function(){return Bt.Trace}});Object.defineProperty(j,"TraceValues",{enumerable:!0,get:function(){return Bt.TraceValues}});Object.defineProperty(j,"TraceFormat",{enumerable:!0,get:function(){return Bt.TraceFormat}});Object.defineProperty(j,"SetTraceNotification",{enumerable:!0,get:function(){return Bt.SetTraceNotification}});Object.defineProperty(j,"LogTraceNotification",{enumerable:!0,get:function(){return Bt.LogTraceNotification}});Object.defineProperty(j,"ConnectionErrors",{enumerable:!0,get:function(){return Bt.ConnectionErrors}});Object.defineProperty(j,"ConnectionError",{enumerable:!0,get:function(){return Bt.ConnectionError}});Object.defineProperty(j,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return Bt.CancellationReceiverStrategy}});Object.defineProperty(j,"CancellationSenderStrategy",{enumerable:!0,get:function(){return Bt.CancellationSenderStrategy}});Object.defineProperty(j,"CancellationStrategy",{enumerable:!0,get:function(){return Bt.CancellationStrategy}});Object.defineProperty(j,"MessageStrategy",{enumerable:!0,get:function(){return Bt.MessageStrategy}});var vI=Kr();j.RAL=vI.default});var Rb=re(xf=>{"use strict";Object.defineProperty(xf,"__esModule",{value:!0});var Cb=require("util"),Mr=Za(),ec=class t extends Mr.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return t.emptyBuffer}fromString(e,n){return Buffer.from(e,n)}toString(e,n){return e instanceof Buffer?e.toString(n):new Cb.TextDecoder(n).decode(e)}asNative(e,n){return n===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,n):Buffer.from(e,0,n)}allocNative(e){return Buffer.allocUnsafe(e)}};ec.emptyBuffer=Buffer.allocUnsafe(0);var yf=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Mr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Mr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Mr.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),Mr.Disposable.create(()=>this.stream.off("data",e))}},wf=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Mr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Mr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Mr.Disposable.create(()=>this.stream.off("end",e))}write(e,n){return new Promise((i,s)=>{let c=u=>{u==null?i():s(u)};typeof e=="string"?this.stream.write(e,n,c):this.stream.write(e,c)})}end(){this.stream.end()}},kb=Object.freeze({messageBuffer:Object.freeze({create:t=>new ec(t)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(t,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(t,void 0,0),e.charset))}catch(n){return Promise.reject(n)}}}),decoder:Object.freeze({name:"application/json",decode:(t,e)=>{try{return t instanceof Buffer?Promise.resolve(JSON.parse(t.toString(e.charset))):Promise.resolve(JSON.parse(new Cb.TextDecoder(e.charset).decode(t)))}catch(n){return Promise.reject(n)}}})}),stream:Object.freeze({asReadableStream:t=>new yf(t),asWritableStream:t=>new wf(t)}),console,timer:Object.freeze({setTimeout(t,e,...n){let i=setTimeout(t,e,...n);return{dispose:()=>clearTimeout(i)}},setImmediate(t,...e){let n=setImmediate(t,...e);return{dispose:()=>clearImmediate(n)}},setInterval(t,e,...n){let i=setInterval(t,e,...n);return{dispose:()=>clearInterval(i)}}})});function Pf(){return kb}(function(t){function e(){Mr.RAL.install(kb)}t.install=e})(Pf||(Pf={}));xf.default=Pf});var Di=re(qe=>{"use strict";var yI=qe&&qe.__createBinding||(Object.create?function(t,e,n,i){i===void 0&&(i=n);var s=Object.getOwnPropertyDescriptor(e,n);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,s)}:function(t,e,n,i){i===void 0&&(i=n),t[i]=e[n]}),wI=qe&&qe.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&yI(e,t,n)};Object.defineProperty(qe,"__esModule",{value:!0});qe.createMessageConnection=qe.createServerSocketTransport=qe.createClientSocketTransport=qe.createServerPipeTransport=qe.createClientPipeTransport=qe.generateRandomPipeName=qe.StreamMessageWriter=qe.StreamMessageReader=qe.SocketMessageWriter=qe.SocketMessageReader=qe.PortMessageWriter=qe.PortMessageReader=qe.IPCMessageWriter=qe.IPCMessageReader=void 0;var ao=Rb();ao.default.install();var Tb=require("path"),PI=require("os"),xI=require("crypto"),rc=require("net"),kn=Za();wI(Za(),qe);var Sf=class extends kn.AbstractMessageReader{constructor(e){super(),this.process=e;let n=this.process;n.on("error",i=>this.fireError(i)),n.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),kn.Disposable.create(()=>this.process.off("message",e))}};qe.IPCMessageReader=Sf;var Cf=class extends kn.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let n=this.process;n.on("error",i=>this.fireError(i)),n.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,n=>{n?(this.errorCount++,this.handleError(n,e)):this.errorCount=0}),Promise.resolve()}catch(n){return this.handleError(n,e),Promise.reject(n)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){}};qe.IPCMessageWriter=Cf;var kf=class extends kn.AbstractMessageReader{constructor(e){super(),this.onData=new kn.Emitter,e.on("close",()=>this.fireClose),e.on("error",n=>this.fireError(n)),e.on("message",n=>{this.onData.fire(n)})}listen(e){return this.onData.event(e)}};qe.PortMessageReader=kf;var Rf=class extends kn.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",n=>this.fireError(n))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(n){return this.handleError(n,e),Promise.reject(n)}}handleError(e,n){this.errorCount++,this.fireError(e,n,this.errorCount)}end(){}};qe.PortMessageWriter=Rf;var Ri=class extends kn.ReadableStreamMessageReader{constructor(e,n="utf-8"){super((0,ao.default)().stream.asReadableStream(e),n)}};qe.SocketMessageReader=Ri;var Ti=class extends kn.WriteableStreamMessageWriter{constructor(e,n){super((0,ao.default)().stream.asWritableStream(e),n),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};qe.SocketMessageWriter=Ti;var tc=class extends kn.ReadableStreamMessageReader{constructor(e,n){super((0,ao.default)().stream.asReadableStream(e),n)}};qe.StreamMessageReader=tc;var nc=class extends kn.WriteableStreamMessageWriter{constructor(e,n){super((0,ao.default)().stream.asWritableStream(e),n)}};qe.StreamMessageWriter=nc;var Db=process.env.XDG_RUNTIME_DIR,SI=new Map([["linux",107],["darwin",103]]);function CI(){let t=(0,xI.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${t}-sock`;let e;Db?e=Tb.join(Db,`vscode-ipc-${t}.sock`):e=Tb.join(PI.tmpdir(),`vscode-${t}.sock`);let n=SI.get(process.platform);return n!==void 0&&e.length>n&&(0,ao.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${n} characters.`),e}qe.generateRandomPipeName=CI;function kI(t,e="utf-8"){let n,i=new Promise((s,c)=>{n=s});return new Promise((s,c)=>{let u=(0,rc.createServer)(h=>{u.close(),n([new Ri(h,e),new Ti(h,e)])});u.on("error",c),u.listen(t,()=>{u.removeListener("error",c),s({onConnected:()=>i})})})}qe.createClientPipeTransport=kI;function RI(t,e="utf-8"){let n=(0,rc.createConnection)(t);return[new Ri(n,e),new Ti(n,e)]}qe.createServerPipeTransport=RI;function TI(t,e="utf-8"){let n,i=new Promise((s,c)=>{n=s});return new Promise((s,c)=>{let u=(0,rc.createServer)(h=>{u.close(),n([new Ri(h,e),new Ti(h,e)])});u.on("error",c),u.listen(t,"127.0.0.1",()=>{u.removeListener("error",c),s({onConnected:()=>i})})})}qe.createClientSocketTransport=TI;function DI(t,e="utf-8"){let n=(0,rc.createConnection)(t,"127.0.0.1");return[new Ri(n,e),new Ti(n,e)]}qe.createServerSocketTransport=DI;function II(t){let e=t;return e.read!==void 0&&e.addListener!==void 0}function EI(t){let e=t;return e.write!==void 0&&e.addListener!==void 0}function FI(t,e,n,i){n||(n=kn.NullLogger);let s=II(t)?new tc(t):t,c=EI(e)?new nc(e):e;return kn.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,kn.createMessageConnection)(s,c,n,i)}qe.createMessageConnection=FI});var Tf=re((RM,Ib)=>{"use strict";Ib.exports=Di()});var oc=re((Eb,ic)=>{"use strict";(function(t){if(typeof ic=="object"&&typeof ic.exports=="object"){var e=t(require,Eb);e!==void 0&&(ic.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],t)})(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlineCompletionContext=e.SelectedCompletionInfo=e.InlineCompletionTriggerKind=e.InlineCompletionList=e.InlineCompletionItem=e.StringValue=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var n;(function(p){function C(R){return typeof R=="string"}p.is=C})(n||(e.DocumentUri=n={}));var i;(function(p){function C(R){return typeof R=="string"}p.is=C})(i||(e.URI=i={}));var s;(function(p){p.MIN_VALUE=-2147483648,p.MAX_VALUE=2147483647;function C(R){return typeof R=="number"&&p.MIN_VALUE<=R&&R<=p.MAX_VALUE}p.is=C})(s||(e.integer=s={}));var c;(function(p){p.MIN_VALUE=0,p.MAX_VALUE=2147483647;function C(R){return typeof R=="number"&&p.MIN_VALUE<=R&&R<=p.MAX_VALUE}p.is=C})(c||(e.uinteger=c={}));var u;(function(p){function C(v,f){return v===Number.MAX_VALUE&&(v=c.MAX_VALUE),f===Number.MAX_VALUE&&(f=c.MAX_VALUE),{line:v,character:f}}p.create=C;function R(v){var f=v;return A.objectLiteral(f)&&A.uinteger(f.line)&&A.uinteger(f.character)}p.is=R})(u||(e.Position=u={}));var h;(function(p){function C(v,f,N,G){if(A.uinteger(v)&&A.uinteger(f)&&A.uinteger(N)&&A.uinteger(G))return{start:u.create(v,f),end:u.create(N,G)};if(u.is(v)&&u.is(f))return{start:v,end:f};throw new Error("Range#create called with invalid arguments[".concat(v,", ").concat(f,", ").concat(N,", ").concat(G,"]"))}p.create=C;function R(v){var f=v;return A.objectLiteral(f)&&u.is(f.start)&&u.is(f.end)}p.is=R})(h||(e.Range=h={}));var g;(function(p){function C(v,f){return{uri:v,range:f}}p.create=C;function R(v){var f=v;return A.objectLiteral(f)&&h.is(f.range)&&(A.string(f.uri)||A.undefined(f.uri))}p.is=R})(g||(e.Location=g={}));var b;(function(p){function C(v,f,N,G){return{targetUri:v,targetRange:f,targetSelectionRange:N,originSelectionRange:G}}p.create=C;function R(v){var f=v;return A.objectLiteral(f)&&h.is(f.targetRange)&&A.string(f.targetUri)&&h.is(f.targetSelectionRange)&&(h.is(f.originSelectionRange)||A.undefined(f.originSelectionRange))}p.is=R})(b||(e.LocationLink=b={}));var y;(function(p){function C(v,f,N,G){return{red:v,green:f,blue:N,alpha:G}}p.create=C;function R(v){var f=v;return A.objectLiteral(f)&&A.numberRange(f.red,0,1)&&A.numberRange(f.green,0,1)&&A.numberRange(f.blue,0,1)&&A.numberRange(f.alpha,0,1)}p.is=R})(y||(e.Color=y={}));var T;(function(p){function C(v,f){return{range:v,color:f}}p.create=C;function R(v){var f=v;return A.objectLiteral(f)&&h.is(f.range)&&y.is(f.color)}p.is=R})(T||(e.ColorInformation=T={}));var F;(function(p){function C(v,f,N){return{label:v,textEdit:f,additionalTextEdits:N}}p.create=C;function R(v){var f=v;return A.objectLiteral(f)&&A.string(f.label)&&(A.undefined(f.textEdit)||te.is(f))&&(A.undefined(f.additionalTextEdits)||A.typedArray(f.additionalTextEdits,te.is))}p.is=R})(F||(e.ColorPresentation=F={}));var E;(function(p){p.Comment="comment",p.Imports="imports",p.Region="region"})(E||(e.FoldingRangeKind=E={}));var L;(function(p){function C(v,f,N,G,me,lt){var Ke={startLine:v,endLine:f};return A.defined(N)&&(Ke.startCharacter=N),A.defined(G)&&(Ke.endCharacter=G),A.defined(me)&&(Ke.kind=me),A.defined(lt)&&(Ke.collapsedText=lt),Ke}p.create=C;function R(v){var f=v;return A.objectLiteral(f)&&A.uinteger(f.startLine)&&A.uinteger(f.startLine)&&(A.undefined(f.startCharacter)||A.uinteger(f.startCharacter))&&(A.undefined(f.endCharacter)||A.uinteger(f.endCharacter))&&(A.undefined(f.kind)||A.string(f.kind))}p.is=R})(L||(e.FoldingRange=L={}));var B;(function(p){function C(v,f){return{location:v,message:f}}p.create=C;function R(v){var f=v;return A.defined(f)&&g.is(f.location)&&A.string(f.message)}p.is=R})(B||(e.DiagnosticRelatedInformation=B={}));var $;(function(p){p.Error=1,p.Warning=2,p.Information=3,p.Hint=4})($||(e.DiagnosticSeverity=$={}));var X;(function(p){p.Unnecessary=1,p.Deprecated=2})(X||(e.DiagnosticTag=X={}));var D;(function(p){function C(R){var v=R;return A.objectLiteral(v)&&A.string(v.href)}p.is=C})(D||(e.CodeDescription=D={}));var x;(function(p){function C(v,f,N,G,me,lt){var Ke={range:v,message:f};return A.defined(N)&&(Ke.severity=N),A.defined(G)&&(Ke.code=G),A.defined(me)&&(Ke.source=me),A.defined(lt)&&(Ke.relatedInformation=lt),Ke}p.create=C;function R(v){var f,N=v;return A.defined(N)&&h.is(N.range)&&A.string(N.message)&&(A.number(N.severity)||A.undefined(N.severity))&&(A.integer(N.code)||A.string(N.code)||A.undefined(N.code))&&(A.undefined(N.codeDescription)||A.string((f=N.codeDescription)===null||f===void 0?void 0:f.href))&&(A.string(N.source)||A.undefined(N.source))&&(A.undefined(N.relatedInformation)||A.typedArray(N.relatedInformation,B.is))}p.is=R})(x||(e.Diagnostic=x={}));var O;(function(p){function C(v,f){for(var N=[],G=2;G<arguments.length;G++)N[G-2]=arguments[G];var me={title:v,command:f};return A.defined(N)&&N.length>0&&(me.arguments=N),me}p.create=C;function R(v){var f=v;return A.defined(f)&&A.string(f.title)&&A.string(f.command)}p.is=R})(O||(e.Command=O={}));var te;(function(p){function C(N,G){return{range:N,newText:G}}p.replace=C;function R(N,G){return{range:{start:N,end:N},newText:G}}p.insert=R;function v(N){return{range:N,newText:""}}p.del=v;function f(N){var G=N;return A.objectLiteral(G)&&A.string(G.newText)&&h.is(G.range)}p.is=f})(te||(e.TextEdit=te={}));var _e;(function(p){function C(v,f,N){var G={label:v};return f!==void 0&&(G.needsConfirmation=f),N!==void 0&&(G.description=N),G}p.create=C;function R(v){var f=v;return A.objectLiteral(f)&&A.string(f.label)&&(A.boolean(f.needsConfirmation)||f.needsConfirmation===void 0)&&(A.string(f.description)||f.description===void 0)}p.is=R})(_e||(e.ChangeAnnotation=_e={}));var Be;(function(p){function C(R){var v=R;return A.string(v)}p.is=C})(Be||(e.ChangeAnnotationIdentifier=Be={}));var Ye;(function(p){function C(N,G,me){return{range:N,newText:G,annotationId:me}}p.replace=C;function R(N,G,me){return{range:{start:N,end:N},newText:G,annotationId:me}}p.insert=R;function v(N,G){return{range:N,newText:"",annotationId:G}}p.del=v;function f(N){var G=N;return te.is(G)&&(_e.is(G.annotationId)||Be.is(G.annotationId))}p.is=f})(Ye||(e.AnnotatedTextEdit=Ye={}));var kt;(function(p){function C(v,f){return{textDocument:v,edits:f}}p.create=C;function R(v){var f=v;return A.defined(f)&&We.is(f.textDocument)&&Array.isArray(f.edits)}p.is=R})(kt||(e.TextDocumentEdit=kt={}));var we;(function(p){function C(v,f,N){var G={kind:"create",uri:v};return f!==void 0&&(f.overwrite!==void 0||f.ignoreIfExists!==void 0)&&(G.options=f),N!==void 0&&(G.annotationId=N),G}p.create=C;function R(v){var f=v;return f&&f.kind==="create"&&A.string(f.uri)&&(f.options===void 0||(f.options.overwrite===void 0||A.boolean(f.options.overwrite))&&(f.options.ignoreIfExists===void 0||A.boolean(f.options.ignoreIfExists)))&&(f.annotationId===void 0||Be.is(f.annotationId))}p.is=R})(we||(e.CreateFile=we={}));var Y;(function(p){function C(v,f,N,G){var me={kind:"rename",oldUri:v,newUri:f};return N!==void 0&&(N.overwrite!==void 0||N.ignoreIfExists!==void 0)&&(me.options=N),G!==void 0&&(me.annotationId=G),me}p.create=C;function R(v){var f=v;return f&&f.kind==="rename"&&A.string(f.oldUri)&&A.string(f.newUri)&&(f.options===void 0||(f.options.overwrite===void 0||A.boolean(f.options.overwrite))&&(f.options.ignoreIfExists===void 0||A.boolean(f.options.ignoreIfExists)))&&(f.annotationId===void 0||Be.is(f.annotationId))}p.is=R})(Y||(e.RenameFile=Y={}));var z;(function(p){function C(v,f,N){var G={kind:"delete",uri:v};return f!==void 0&&(f.recursive!==void 0||f.ignoreIfNotExists!==void 0)&&(G.options=f),N!==void 0&&(G.annotationId=N),G}p.create=C;function R(v){var f=v;return f&&f.kind==="delete"&&A.string(f.uri)&&(f.options===void 0||(f.options.recursive===void 0||A.boolean(f.options.recursive))&&(f.options.ignoreIfNotExists===void 0||A.boolean(f.options.ignoreIfNotExists)))&&(f.annotationId===void 0||Be.is(f.annotationId))}p.is=R})(z||(e.DeleteFile=z={}));var ae;(function(p){function C(R){var v=R;return v&&(v.changes!==void 0||v.documentChanges!==void 0)&&(v.documentChanges===void 0||v.documentChanges.every(function(f){return A.string(f.kind)?we.is(f)||Y.is(f)||z.is(f):kt.is(f)}))}p.is=C})(ae||(e.WorkspaceEdit=ae={}));var ie=function(){function p(C,R){this.edits=C,this.changeAnnotations=R}return p.prototype.insert=function(C,R,v){var f,N;if(v===void 0?f=te.insert(C,R):Be.is(v)?(N=v,f=Ye.insert(C,R,v)):(this.assertChangeAnnotations(this.changeAnnotations),N=this.changeAnnotations.manage(v),f=Ye.insert(C,R,N)),this.edits.push(f),N!==void 0)return N},p.prototype.replace=function(C,R,v){var f,N;if(v===void 0?f=te.replace(C,R):Be.is(v)?(N=v,f=Ye.replace(C,R,v)):(this.assertChangeAnnotations(this.changeAnnotations),N=this.changeAnnotations.manage(v),f=Ye.replace(C,R,N)),this.edits.push(f),N!==void 0)return N},p.prototype.delete=function(C,R){var v,f;if(R===void 0?v=te.del(C):Be.is(R)?(f=R,v=Ye.del(C,R)):(this.assertChangeAnnotations(this.changeAnnotations),f=this.changeAnnotations.manage(R),v=Ye.del(C,f)),this.edits.push(v),f!==void 0)return f},p.prototype.add=function(C){this.edits.push(C)},p.prototype.all=function(){return this.edits},p.prototype.clear=function(){this.edits.splice(0,this.edits.length)},p.prototype.assertChangeAnnotations=function(C){if(C===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},p}(),ke=function(){function p(C){this._annotations=C===void 0?Object.create(null):C,this._counter=0,this._size=0}return p.prototype.all=function(){return this._annotations},Object.defineProperty(p.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),p.prototype.manage=function(C,R){var v;if(Be.is(C)?v=C:(v=this.nextId(),R=C),this._annotations[v]!==void 0)throw new Error("Id ".concat(v," is already in use."));if(R===void 0)throw new Error("No annotation provided for id ".concat(v));return this._annotations[v]=R,this._size++,v},p.prototype.nextId=function(){return this._counter++,this._counter.toString()},p}(),ge=function(){function p(C){var R=this;this._textEditChanges=Object.create(null),C!==void 0?(this._workspaceEdit=C,C.documentChanges?(this._changeAnnotations=new ke(C.changeAnnotations),C.changeAnnotations=this._changeAnnotations.all(),C.documentChanges.forEach(function(v){if(kt.is(v)){var f=new ie(v.edits,R._changeAnnotations);R._textEditChanges[v.textDocument.uri]=f}})):C.changes&&Object.keys(C.changes).forEach(function(v){var f=new ie(C.changes[v]);R._textEditChanges[v]=f})):this._workspaceEdit={}}return Object.defineProperty(p.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),p.prototype.getTextEditChange=function(C){if(We.is(C)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var R={uri:C.uri,version:C.version},v=this._textEditChanges[R.uri];if(!v){var f=[],N={textDocument:R,edits:f};this._workspaceEdit.documentChanges.push(N),v=new ie(f,this._changeAnnotations),this._textEditChanges[R.uri]=v}return v}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var v=this._textEditChanges[C];if(!v){var f=[];this._workspaceEdit.changes[C]=f,v=new ie(f),this._textEditChanges[C]=v}return v}},p.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new ke,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},p.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},p.prototype.createFile=function(C,R,v){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var f;_e.is(R)||Be.is(R)?f=R:v=R;var N,G;if(f===void 0?N=we.create(C,v):(G=Be.is(f)?f:this._changeAnnotations.manage(f),N=we.create(C,v,G)),this._workspaceEdit.documentChanges.push(N),G!==void 0)return G},p.prototype.renameFile=function(C,R,v,f){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var N;_e.is(v)||Be.is(v)?N=v:f=v;var G,me;if(N===void 0?G=Y.create(C,R,f):(me=Be.is(N)?N:this._changeAnnotations.manage(N),G=Y.create(C,R,f,me)),this._workspaceEdit.documentChanges.push(G),me!==void 0)return me},p.prototype.deleteFile=function(C,R,v){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var f;_e.is(R)||Be.is(R)?f=R:v=R;var N,G;if(f===void 0?N=z.create(C,v):(G=Be.is(f)?f:this._changeAnnotations.manage(f),N=z.create(C,v,G)),this._workspaceEdit.documentChanges.push(N),G!==void 0)return G},p}();e.WorkspaceChange=ge;var pe;(function(p){function C(v){return{uri:v}}p.create=C;function R(v){var f=v;return A.defined(f)&&A.string(f.uri)}p.is=R})(pe||(e.TextDocumentIdentifier=pe={}));var wt;(function(p){function C(v,f){return{uri:v,version:f}}p.create=C;function R(v){var f=v;return A.defined(f)&&A.string(f.uri)&&A.integer(f.version)}p.is=R})(wt||(e.VersionedTextDocumentIdentifier=wt={}));var We;(function(p){function C(v,f){return{uri:v,version:f}}p.create=C;function R(v){var f=v;return A.defined(f)&&A.string(f.uri)&&(f.version===null||A.integer(f.version))}p.is=R})(We||(e.OptionalVersionedTextDocumentIdentifier=We={}));var je;(function(p){function C(v,f,N,G){return{uri:v,languageId:f,version:N,text:G}}p.create=C;function R(v){var f=v;return A.defined(f)&&A.string(f.uri)&&A.string(f.languageId)&&A.integer(f.version)&&A.string(f.text)}p.is=R})(je||(e.TextDocumentItem=je={}));var pn;(function(p){p.PlainText="plaintext",p.Markdown="markdown";function C(R){var v=R;return v===p.PlainText||v===p.Markdown}p.is=C})(pn||(e.MarkupKind=pn={}));var _r;(function(p){function C(R){var v=R;return A.objectLiteral(R)&&pn.is(v.kind)&&A.string(v.value)}p.is=C})(_r||(e.MarkupContent=_r={}));var zn;(function(p){p.Text=1,p.Method=2,p.Function=3,p.Constructor=4,p.Field=5,p.Variable=6,p.Class=7,p.Interface=8,p.Module=9,p.Property=10,p.Unit=11,p.Value=12,p.Enum=13,p.Keyword=14,p.Snippet=15,p.Color=16,p.File=17,p.Reference=18,p.Folder=19,p.EnumMember=20,p.Constant=21,p.Struct=22,p.Event=23,p.Operator=24,p.TypeParameter=25})(zn||(e.CompletionItemKind=zn={}));var sr;(function(p){p.PlainText=1,p.Snippet=2})(sr||(e.InsertTextFormat=sr={}));var gi;(function(p){p.Deprecated=1})(gi||(e.CompletionItemTag=gi={}));var ar;(function(p){function C(v,f,N){return{newText:v,insert:f,replace:N}}p.create=C;function R(v){var f=v;return f&&A.string(f.newText)&&h.is(f.insert)&&h.is(f.replace)}p.is=R})(ar||(e.InsertReplaceEdit=ar={}));var cr;(function(p){p.asIs=1,p.adjustIndentation=2})(cr||(e.InsertTextMode=cr={}));var qi;(function(p){function C(R){var v=R;return v&&(A.string(v.detail)||v.detail===void 0)&&(A.string(v.description)||v.description===void 0)}p.is=C})(qi||(e.CompletionItemLabelDetails=qi={}));var vr;(function(p){function C(R){return{label:R}}p.create=C})(vr||(e.CompletionItem=vr={}));var yr;(function(p){function C(R,v){return{items:R||[],isIncomplete:!!v}}p.create=C})(yr||(e.CompletionList=yr={}));var wr;(function(p){function C(v){return v.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}p.fromPlainText=C;function R(v){var f=v;return A.string(f)||A.objectLiteral(f)&&A.string(f.language)&&A.string(f.value)}p.is=R})(wr||(e.MarkedString=wr={}));var gt;(function(p){function C(R){var v=R;return!!v&&A.objectLiteral(v)&&(_r.is(v.contents)||wr.is(v.contents)||A.typedArray(v.contents,wr.is))&&(R.range===void 0||h.is(R.range))}p.is=C})(gt||(e.Hover=gt={}));var ur;(function(p){function C(R,v){return v?{label:R,documentation:v}:{label:R}}p.create=C})(ur||(e.ParameterInformation=ur={}));var Li;(function(p){function C(R,v){for(var f=[],N=2;N<arguments.length;N++)f[N-2]=arguments[N];var G={label:R};return A.defined(v)&&(G.documentation=v),A.defined(f)?G.parameters=f:G.parameters=[],G}p.create=C})(Li||(e.SignatureInformation=Li={}));var Lt;(function(p){p.Text=1,p.Read=2,p.Write=3})(Lt||(e.DocumentHighlightKind=Lt={}));var pi;(function(p){function C(R,v){var f={range:R};return A.number(v)&&(f.kind=v),f}p.create=C})(pi||(e.DocumentHighlight=pi={}));var Br;(function(p){p.File=1,p.Module=2,p.Namespace=3,p.Package=4,p.Class=5,p.Method=6,p.Property=7,p.Field=8,p.Constructor=9,p.Enum=10,p.Interface=11,p.Function=12,p.Variable=13,p.Constant=14,p.String=15,p.Number=16,p.Boolean=17,p.Array=18,p.Object=19,p.Key=20,p.Null=21,p.EnumMember=22,p.Struct=23,p.Event=24,p.Operator=25,p.TypeParameter=26})(Br||(e.SymbolKind=Br={}));var lr;(function(p){p.Deprecated=1})(lr||(e.SymbolTag=lr={}));var Pt;(function(p){function C(R,v,f,N,G){var me={name:R,kind:v,location:{uri:N,range:f}};return G&&(me.containerName=G),me}p.create=C})(Pt||(e.SymbolInformation=Pt={}));var nn;(function(p){function C(R,v,f,N){return N!==void 0?{name:R,kind:v,location:{uri:f,range:N}}:{name:R,kind:v,location:{uri:f}}}p.create=C})(nn||(e.WorkspaceSymbol=nn={}));var Pr;(function(p){function C(v,f,N,G,me,lt){var Ke={name:v,detail:f,kind:N,range:G,selectionRange:me};return lt!==void 0&&(Ke.children=lt),Ke}p.create=C;function R(v){var f=v;return f&&A.string(f.name)&&A.number(f.kind)&&h.is(f.range)&&h.is(f.selectionRange)&&(f.detail===void 0||A.string(f.detail))&&(f.deprecated===void 0||A.boolean(f.deprecated))&&(f.children===void 0||Array.isArray(f.children))&&(f.tags===void 0||Array.isArray(f.tags))}p.is=R})(Pr||(e.DocumentSymbol=Pr={}));var Oi;(function(p){p.Empty="",p.QuickFix="quickfix",p.Refactor="refactor",p.RefactorExtract="refactor.extract",p.RefactorInline="refactor.inline",p.RefactorRewrite="refactor.rewrite",p.Source="source",p.SourceOrganizeImports="source.organizeImports",p.SourceFixAll="source.fixAll"})(Oi||(e.CodeActionKind=Oi={}));var $t;(function(p){p.Invoked=1,p.Automatic=2})($t||(e.CodeActionTriggerKind=$t={}));var mi;(function(p){function C(v,f,N){var G={diagnostics:v};return f!=null&&(G.only=f),N!=null&&(G.triggerKind=N),G}p.create=C;function R(v){var f=v;return A.defined(f)&&A.typedArray(f.diagnostics,x.is)&&(f.only===void 0||A.typedArray(f.only,A.string))&&(f.triggerKind===void 0||f.triggerKind===$t.Invoked||f.triggerKind===$t.Automatic)}p.is=R})(mi||(e.CodeActionContext=mi={}));var Hn;(function(p){function C(v,f,N){var G={title:v},me=!0;return typeof f=="string"?(me=!1,G.kind=f):O.is(f)?G.command=f:G.edit=f,me&&N!==void 0&&(G.kind=N),G}p.create=C;function R(v){var f=v;return f&&A.string(f.title)&&(f.diagnostics===void 0||A.typedArray(f.diagnostics,x.is))&&(f.kind===void 0||A.string(f.kind))&&(f.edit!==void 0||f.command!==void 0)&&(f.command===void 0||O.is(f.command))&&(f.isPreferred===void 0||A.boolean(f.isPreferred))&&(f.edit===void 0||ae.is(f.edit))}p.is=R})(Hn||(e.CodeAction=Hn={}));var mn;(function(p){function C(v,f){var N={range:v};return A.defined(f)&&(N.data=f),N}p.create=C;function R(v){var f=v;return A.defined(f)&&h.is(f.range)&&(A.undefined(f.command)||O.is(f.command))}p.is=R})(mn||(e.CodeLens=mn={}));var xr;(function(p){function C(v,f){return{tabSize:v,insertSpaces:f}}p.create=C;function R(v){var f=v;return A.defined(f)&&A.uinteger(f.tabSize)&&A.boolean(f.insertSpaces)}p.is=R})(xr||(e.FormattingOptions=xr={}));var bn;(function(p){function C(v,f,N){return{range:v,target:f,data:N}}p.create=C;function R(v){var f=v;return A.defined(f)&&h.is(f.range)&&(A.undefined(f.target)||A.string(f.target))}p.is=R})(bn||(e.DocumentLink=bn={}));var S;(function(p){function C(v,f){return{range:v,parent:f}}p.create=C;function R(v){var f=v;return A.objectLiteral(f)&&h.is(f.range)&&(f.parent===void 0||p.is(f.parent))}p.is=R})(S||(e.SelectionRange=S={}));var H;(function(p){p.namespace="namespace",p.type="type",p.class="class",p.enum="enum",p.interface="interface",p.struct="struct",p.typeParameter="typeParameter",p.parameter="parameter",p.variable="variable",p.property="property",p.enumMember="enumMember",p.event="event",p.function="function",p.method="method",p.macro="macro",p.keyword="keyword",p.modifier="modifier",p.comment="comment",p.string="string",p.number="number",p.regexp="regexp",p.operator="operator",p.decorator="decorator"})(H||(e.SemanticTokenTypes=H={}));var Z;(function(p){p.declaration="declaration",p.definition="definition",p.readonly="readonly",p.static="static",p.deprecated="deprecated",p.abstract="abstract",p.async="async",p.modification="modification",p.documentation="documentation",p.defaultLibrary="defaultLibrary"})(Z||(e.SemanticTokenModifiers=Z={}));var oe;(function(p){function C(R){var v=R;return A.objectLiteral(v)&&(v.resultId===void 0||typeof v.resultId=="string")&&Array.isArray(v.data)&&(v.data.length===0||typeof v.data[0]=="number")}p.is=C})(oe||(e.SemanticTokens=oe={}));var Ue;(function(p){function C(v,f){return{range:v,text:f}}p.create=C;function R(v){var f=v;return f!=null&&h.is(f.range)&&A.string(f.text)}p.is=R})(Ue||(e.InlineValueText=Ue={}));var Le;(function(p){function C(v,f,N){return{range:v,variableName:f,caseSensitiveLookup:N}}p.create=C;function R(v){var f=v;return f!=null&&h.is(f.range)&&A.boolean(f.caseSensitiveLookup)&&(A.string(f.variableName)||f.variableName===void 0)}p.is=R})(Le||(e.InlineValueVariableLookup=Le={}));var Qe;(function(p){function C(v,f){return{range:v,expression:f}}p.create=C;function R(v){var f=v;return f!=null&&h.is(f.range)&&(A.string(f.expression)||f.expression===void 0)}p.is=R})(Qe||(e.InlineValueEvaluatableExpression=Qe={}));var et;(function(p){function C(v,f){return{frameId:v,stoppedLocation:f}}p.create=C;function R(v){var f=v;return A.defined(f)&&h.is(v.stoppedLocation)}p.is=R})(et||(e.InlineValueContext=et={}));var Re;(function(p){p.Type=1,p.Parameter=2;function C(R){return R===1||R===2}p.is=C})(Re||(e.InlayHintKind=Re={}));var Je;(function(p){function C(v){return{value:v}}p.create=C;function R(v){var f=v;return A.objectLiteral(f)&&(f.tooltip===void 0||A.string(f.tooltip)||_r.is(f.tooltip))&&(f.location===void 0||g.is(f.location))&&(f.command===void 0||O.is(f.command))}p.is=R})(Je||(e.InlayHintLabelPart=Je={}));var Ae;(function(p){function C(v,f,N){var G={position:v,label:f};return N!==void 0&&(G.kind=N),G}p.create=C;function R(v){var f=v;return A.objectLiteral(f)&&u.is(f.position)&&(A.string(f.label)||A.typedArray(f.label,Je.is))&&(f.kind===void 0||Re.is(f.kind))&&f.textEdits===void 0||A.typedArray(f.textEdits,te.is)&&(f.tooltip===void 0||A.string(f.tooltip)||_r.is(f.tooltip))&&(f.paddingLeft===void 0||A.boolean(f.paddingLeft))&&(f.paddingRight===void 0||A.boolean(f.paddingRight))}p.is=R})(Ae||(e.InlayHint=Ae={}));var it;(function(p){function C(R){return{kind:"snippet",value:R}}p.createSnippet=C})(it||(e.StringValue=it={}));var Rt;(function(p){function C(R,v,f,N){return{insertText:R,filterText:v,range:f,command:N}}p.create=C})(Rt||(e.InlineCompletionItem=Rt={}));var Xt;(function(p){function C(R){return{items:R}}p.create=C})(Xt||(e.InlineCompletionList=Xt={}));var Bi;(function(p){p.Invoked=0,p.Automatic=1})(Bi||(e.InlineCompletionTriggerKind=Bi={}));var $s;(function(p){function C(R,v){return{range:R,text:v}}p.create=C})($s||(e.SelectedCompletionInfo=$s={}));var Wo;(function(p){function C(R,v){return{triggerKind:R,selectedCompletionInfo:v}}p.create=C})(Wo||(e.InlineCompletionContext=Wo={}));var Ws;(function(p){function C(R){var v=R;return A.objectLiteral(v)&&i.is(v.uri)&&A.string(v.name)}p.is=C})(Ws||(e.WorkspaceFolder=Ws={})),e.EOL=[`
`,`\r
`,"\r"];var js;(function(p){function C(N,G,me,lt){return new ol(N,G,me,lt)}p.create=C;function R(N){var G=N;return!!(A.defined(G)&&A.string(G.uri)&&(A.undefined(G.languageId)||A.string(G.languageId))&&A.uinteger(G.lineCount)&&A.func(G.getText)&&A.func(G.positionAt)&&A.func(G.offsetAt))}p.is=R;function v(N,G){for(var me=N.getText(),lt=f(G,function(Ur,Ui){var zs=Ur.range.start.line-Ui.range.start.line;return zs===0?Ur.range.start.character-Ui.range.start.character:zs}),Ke=me.length,rn=lt.length-1;rn>=0;rn--){var _n=lt[rn],Vn=N.offsetAt(_n.range.start),Ie=N.offsetAt(_n.range.end);if(Ie<=Ke)me=me.substring(0,Vn)+_n.newText+me.substring(Ie,me.length);else throw new Error("Overlapping edit");Ke=Vn}return me}p.applyEdits=v;function f(N,G){if(N.length<=1)return N;var me=N.length/2|0,lt=N.slice(0,me),Ke=N.slice(me);f(lt,G),f(Ke,G);for(var rn=0,_n=0,Vn=0;rn<lt.length&&_n<Ke.length;){var Ie=G(lt[rn],Ke[_n]);Ie<=0?N[Vn++]=lt[rn++]:N[Vn++]=Ke[_n++]}for(;rn<lt.length;)N[Vn++]=lt[rn++];for(;_n<Ke.length;)N[Vn++]=Ke[_n++];return N}})(js||(e.TextDocument=js={}));var ol=function(){function p(C,R,v,f){this._uri=C,this._languageId=R,this._version=v,this._content=f,this._lineOffsets=void 0}return Object.defineProperty(p.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),p.prototype.getText=function(C){if(C){var R=this.offsetAt(C.start),v=this.offsetAt(C.end);return this._content.substring(R,v)}return this._content},p.prototype.update=function(C,R){this._content=C.text,this._version=R,this._lineOffsets=void 0},p.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var C=[],R=this._content,v=!0,f=0;f<R.length;f++){v&&(C.push(f),v=!1);var N=R.charAt(f);v=N==="\r"||N===`
`,N==="\r"&&f+1<R.length&&R.charAt(f+1)===`
`&&f++}v&&R.length>0&&C.push(R.length),this._lineOffsets=C}return this._lineOffsets},p.prototype.positionAt=function(C){C=Math.max(Math.min(C,this._content.length),0);var R=this.getLineOffsets(),v=0,f=R.length;if(f===0)return u.create(0,C);for(;v<f;){var N=Math.floor((v+f)/2);R[N]>C?f=N:v=N+1}var G=v-1;return u.create(G,C-R[G])},p.prototype.offsetAt=function(C){var R=this.getLineOffsets();if(C.line>=R.length)return this._content.length;if(C.line<0)return 0;var v=R[C.line],f=C.line+1<R.length?R[C.line+1]:this._content.length;return Math.max(Math.min(v+C.character,f),v)},Object.defineProperty(p.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),p}(),A;(function(p){var C=Object.prototype.toString;function R(Ie){return typeof Ie<"u"}p.defined=R;function v(Ie){return typeof Ie>"u"}p.undefined=v;function f(Ie){return Ie===!0||Ie===!1}p.boolean=f;function N(Ie){return C.call(Ie)==="[object String]"}p.string=N;function G(Ie){return C.call(Ie)==="[object Number]"}p.number=G;function me(Ie,Ur,Ui){return C.call(Ie)==="[object Number]"&&Ur<=Ie&&Ie<=Ui}p.numberRange=me;function lt(Ie){return C.call(Ie)==="[object Number]"&&-2147483648<=Ie&&Ie<=2147483647}p.integer=lt;function Ke(Ie){return C.call(Ie)==="[object Number]"&&0<=Ie&&Ie<=2147483647}p.uinteger=Ke;function rn(Ie){return C.call(Ie)==="[object Function]"}p.func=rn;function _n(Ie){return Ie!==null&&typeof Ie=="object"}p.objectLiteral=_n;function Vn(Ie,Ur){return Array.isArray(Ie)&&Ie.every(Ur)}p.typedArray=Vn})(A||(A={}))})});var ft=re(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.ProtocolNotificationType=ln.ProtocolNotificationType0=ln.ProtocolRequestType=ln.ProtocolRequestType0=ln.RegistrationType=ln.MessageDirection=void 0;var co=Di(),Fb;(function(t){t.clientToServer="clientToServer",t.serverToClient="serverToClient",t.both="both"})(Fb||(ln.MessageDirection=Fb={}));var Df=class{constructor(e){this.method=e}};ln.RegistrationType=Df;var If=class extends co.RequestType0{constructor(e){super(e)}};ln.ProtocolRequestType0=If;var Ef=class extends co.RequestType{constructor(e){super(e,co.ParameterStructures.byName)}};ln.ProtocolRequestType=Ef;var Ff=class extends co.NotificationType0{constructor(e){super(e)}};ln.ProtocolNotificationType0=Ff;var Mf=class extends co.NotificationType{constructor(e){super(e,co.ParameterStructures.byName)}};ln.ProtocolNotificationType=Mf});var sc=re(It=>{"use strict";Object.defineProperty(It,"__esModule",{value:!0});It.objectLiteral=It.typedArray=It.stringArray=It.array=It.func=It.error=It.number=It.string=It.boolean=void 0;function MI(t){return t===!0||t===!1}It.boolean=MI;function Mb(t){return typeof t=="string"||t instanceof String}It.string=Mb;function AI(t){return typeof t=="number"||t instanceof Number}It.number=AI;function NI(t){return t instanceof Error}It.error=NI;function qI(t){return typeof t=="function"}It.func=qI;function Ab(t){return Array.isArray(t)}It.array=Ab;function LI(t){return Ab(t)&&t.every(e=>Mb(e))}It.stringArray=LI;function OI(t,e){return Array.isArray(t)&&t.every(e)}It.typedArray=OI;function BI(t){return t!==null&&typeof t=="object"}It.objectLiteral=BI});var Lb=re(ac=>{"use strict";Object.defineProperty(ac,"__esModule",{value:!0});ac.ImplementationRequest=void 0;var Nb=ft(),qb;(function(t){t.method="textDocument/implementation",t.messageDirection=Nb.MessageDirection.clientToServer,t.type=new Nb.ProtocolRequestType(t.method)})(qb||(ac.ImplementationRequest=qb={}))});var Ub=re(cc=>{"use strict";Object.defineProperty(cc,"__esModule",{value:!0});cc.TypeDefinitionRequest=void 0;var Ob=ft(),Bb;(function(t){t.method="textDocument/typeDefinition",t.messageDirection=Ob.MessageDirection.clientToServer,t.type=new Ob.ProtocolRequestType(t.method)})(Bb||(cc.TypeDefinitionRequest=Bb={}))});var jb=re(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});uo.DidChangeWorkspaceFoldersNotification=uo.WorkspaceFoldersRequest=void 0;var uc=ft(),$b;(function(t){t.method="workspace/workspaceFolders",t.messageDirection=uc.MessageDirection.serverToClient,t.type=new uc.ProtocolRequestType0(t.method)})($b||(uo.WorkspaceFoldersRequest=$b={}));var Wb;(function(t){t.method="workspace/didChangeWorkspaceFolders",t.messageDirection=uc.MessageDirection.clientToServer,t.type=new uc.ProtocolNotificationType(t.method)})(Wb||(uo.DidChangeWorkspaceFoldersNotification=Wb={}))});var Vb=re(lc=>{"use strict";Object.defineProperty(lc,"__esModule",{value:!0});lc.ConfigurationRequest=void 0;var zb=ft(),Hb;(function(t){t.method="workspace/configuration",t.messageDirection=zb.MessageDirection.serverToClient,t.type=new zb.ProtocolRequestType(t.method)})(Hb||(lc.ConfigurationRequest=Hb={}))});var Jb=re(lo=>{"use strict";Object.defineProperty(lo,"__esModule",{value:!0});lo.ColorPresentationRequest=lo.DocumentColorRequest=void 0;var dc=ft(),Gb;(function(t){t.method="textDocument/documentColor",t.messageDirection=dc.MessageDirection.clientToServer,t.type=new dc.ProtocolRequestType(t.method)})(Gb||(lo.DocumentColorRequest=Gb={}));var Qb;(function(t){t.method="textDocument/colorPresentation",t.messageDirection=dc.MessageDirection.clientToServer,t.type=new dc.ProtocolRequestType(t.method)})(Qb||(lo.ColorPresentationRequest=Qb={}))});var Kb=re(fo=>{"use strict";Object.defineProperty(fo,"__esModule",{value:!0});fo.FoldingRangeRefreshRequest=fo.FoldingRangeRequest=void 0;var fc=ft(),Xb;(function(t){t.method="textDocument/foldingRange",t.messageDirection=fc.MessageDirection.clientToServer,t.type=new fc.ProtocolRequestType(t.method)})(Xb||(fo.FoldingRangeRequest=Xb={}));var Yb;(function(t){t.method="workspace/foldingRange/refresh",t.messageDirection=fc.MessageDirection.serverToClient,t.type=new fc.ProtocolRequestType0(t.method)})(Yb||(fo.FoldingRangeRefreshRequest=Yb={}))});var t_=re(hc=>{"use strict";Object.defineProperty(hc,"__esModule",{value:!0});hc.DeclarationRequest=void 0;var Zb=ft(),e_;(function(t){t.method="textDocument/declaration",t.messageDirection=Zb.MessageDirection.clientToServer,t.type=new Zb.ProtocolRequestType(t.method)})(e_||(hc.DeclarationRequest=e_={}))});var i_=re(gc=>{"use strict";Object.defineProperty(gc,"__esModule",{value:!0});gc.SelectionRangeRequest=void 0;var n_=ft(),r_;(function(t){t.method="textDocument/selectionRange",t.messageDirection=n_.MessageDirection.clientToServer,t.type=new n_.ProtocolRequestType(t.method)})(r_||(gc.SelectionRangeRequest=r_={}))});var c_=re(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.WorkDoneProgressCancelNotification=ti.WorkDoneProgressCreateRequest=ti.WorkDoneProgress=void 0;var UI=Di(),pc=ft(),o_;(function(t){t.type=new UI.ProgressType;function e(n){return n===t.type}t.is=e})(o_||(ti.WorkDoneProgress=o_={}));var s_;(function(t){t.method="window/workDoneProgress/create",t.messageDirection=pc.MessageDirection.serverToClient,t.type=new pc.ProtocolRequestType(t.method)})(s_||(ti.WorkDoneProgressCreateRequest=s_={}));var a_;(function(t){t.method="window/workDoneProgress/cancel",t.messageDirection=pc.MessageDirection.clientToServer,t.type=new pc.ProtocolNotificationType(t.method)})(a_||(ti.WorkDoneProgressCancelNotification=a_={}))});var f_=re(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.CallHierarchyOutgoingCallsRequest=ni.CallHierarchyIncomingCallsRequest=ni.CallHierarchyPrepareRequest=void 0;var ho=ft(),u_;(function(t){t.method="textDocument/prepareCallHierarchy",t.messageDirection=ho.MessageDirection.clientToServer,t.type=new ho.ProtocolRequestType(t.method)})(u_||(ni.CallHierarchyPrepareRequest=u_={}));var l_;(function(t){t.method="callHierarchy/incomingCalls",t.messageDirection=ho.MessageDirection.clientToServer,t.type=new ho.ProtocolRequestType(t.method)})(l_||(ni.CallHierarchyIncomingCallsRequest=l_={}));var d_;(function(t){t.method="callHierarchy/outgoingCalls",t.messageDirection=ho.MessageDirection.clientToServer,t.type=new ho.ProtocolRequestType(t.method)})(d_||(ni.CallHierarchyOutgoingCallsRequest=d_={}))});var __=re(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});dn.SemanticTokensRefreshRequest=dn.SemanticTokensRangeRequest=dn.SemanticTokensDeltaRequest=dn.SemanticTokensRequest=dn.SemanticTokensRegistrationType=dn.TokenFormat=void 0;var Ar=ft(),h_;(function(t){t.Relative="relative"})(h_||(dn.TokenFormat=h_={}));var ls;(function(t){t.method="textDocument/semanticTokens",t.type=new Ar.RegistrationType(t.method)})(ls||(dn.SemanticTokensRegistrationType=ls={}));var g_;(function(t){t.method="textDocument/semanticTokens/full",t.messageDirection=Ar.MessageDirection.clientToServer,t.type=new Ar.ProtocolRequestType(t.method),t.registrationMethod=ls.method})(g_||(dn.SemanticTokensRequest=g_={}));var p_;(function(t){t.method="textDocument/semanticTokens/full/delta",t.messageDirection=Ar.MessageDirection.clientToServer,t.type=new Ar.ProtocolRequestType(t.method),t.registrationMethod=ls.method})(p_||(dn.SemanticTokensDeltaRequest=p_={}));var m_;(function(t){t.method="textDocument/semanticTokens/range",t.messageDirection=Ar.MessageDirection.clientToServer,t.type=new Ar.ProtocolRequestType(t.method),t.registrationMethod=ls.method})(m_||(dn.SemanticTokensRangeRequest=m_={}));var b_;(function(t){t.method="workspace/semanticTokens/refresh",t.messageDirection=Ar.MessageDirection.serverToClient,t.type=new Ar.ProtocolRequestType0(t.method)})(b_||(dn.SemanticTokensRefreshRequest=b_={}))});var w_=re(mc=>{"use strict";Object.defineProperty(mc,"__esModule",{value:!0});mc.ShowDocumentRequest=void 0;var v_=ft(),y_;(function(t){t.method="window/showDocument",t.messageDirection=v_.MessageDirection.serverToClient,t.type=new v_.ProtocolRequestType(t.method)})(y_||(mc.ShowDocumentRequest=y_={}))});var S_=re(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0});bc.LinkedEditingRangeRequest=void 0;var P_=ft(),x_;(function(t){t.method="textDocument/linkedEditingRange",t.messageDirection=P_.MessageDirection.clientToServer,t.type=new P_.ProtocolRequestType(t.method)})(x_||(bc.LinkedEditingRangeRequest=x_={}))});var F_=re(Vt=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});Vt.WillDeleteFilesRequest=Vt.DidDeleteFilesNotification=Vt.DidRenameFilesNotification=Vt.WillRenameFilesRequest=Vt.DidCreateFilesNotification=Vt.WillCreateFilesRequest=Vt.FileOperationPatternKind=void 0;var Ln=ft(),C_;(function(t){t.file="file",t.folder="folder"})(C_||(Vt.FileOperationPatternKind=C_={}));var k_;(function(t){t.method="workspace/willCreateFiles",t.messageDirection=Ln.MessageDirection.clientToServer,t.type=new Ln.ProtocolRequestType(t.method)})(k_||(Vt.WillCreateFilesRequest=k_={}));var R_;(function(t){t.method="workspace/didCreateFiles",t.messageDirection=Ln.MessageDirection.clientToServer,t.type=new Ln.ProtocolNotificationType(t.method)})(R_||(Vt.DidCreateFilesNotification=R_={}));var T_;(function(t){t.method="workspace/willRenameFiles",t.messageDirection=Ln.MessageDirection.clientToServer,t.type=new Ln.ProtocolRequestType(t.method)})(T_||(Vt.WillRenameFilesRequest=T_={}));var D_;(function(t){t.method="workspace/didRenameFiles",t.messageDirection=Ln.MessageDirection.clientToServer,t.type=new Ln.ProtocolNotificationType(t.method)})(D_||(Vt.DidRenameFilesNotification=D_={}));var I_;(function(t){t.method="workspace/didDeleteFiles",t.messageDirection=Ln.MessageDirection.clientToServer,t.type=new Ln.ProtocolNotificationType(t.method)})(I_||(Vt.DidDeleteFilesNotification=I_={}));var E_;(function(t){t.method="workspace/willDeleteFiles",t.messageDirection=Ln.MessageDirection.clientToServer,t.type=new Ln.ProtocolRequestType(t.method)})(E_||(Vt.WillDeleteFilesRequest=E_={}))});var L_=re(ri=>{"use strict";Object.defineProperty(ri,"__esModule",{value:!0});ri.MonikerRequest=ri.MonikerKind=ri.UniquenessLevel=void 0;var M_=ft(),A_;(function(t){t.document="document",t.project="project",t.group="group",t.scheme="scheme",t.global="global"})(A_||(ri.UniquenessLevel=A_={}));var N_;(function(t){t.$import="import",t.$export="export",t.local="local"})(N_||(ri.MonikerKind=N_={}));var q_;(function(t){t.method="textDocument/moniker",t.messageDirection=M_.MessageDirection.clientToServer,t.type=new M_.ProtocolRequestType(t.method)})(q_||(ri.MonikerRequest=q_={}))});var $_=re(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.TypeHierarchySubtypesRequest=ii.TypeHierarchySupertypesRequest=ii.TypeHierarchyPrepareRequest=void 0;var go=ft(),O_;(function(t){t.method="textDocument/prepareTypeHierarchy",t.messageDirection=go.MessageDirection.clientToServer,t.type=new go.ProtocolRequestType(t.method)})(O_||(ii.TypeHierarchyPrepareRequest=O_={}));var B_;(function(t){t.method="typeHierarchy/supertypes",t.messageDirection=go.MessageDirection.clientToServer,t.type=new go.ProtocolRequestType(t.method)})(B_||(ii.TypeHierarchySupertypesRequest=B_={}));var U_;(function(t){t.method="typeHierarchy/subtypes",t.messageDirection=go.MessageDirection.clientToServer,t.type=new go.ProtocolRequestType(t.method)})(U_||(ii.TypeHierarchySubtypesRequest=U_={}))});var z_=re(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.InlineValueRefreshRequest=po.InlineValueRequest=void 0;var _c=ft(),W_;(function(t){t.method="textDocument/inlineValue",t.messageDirection=_c.MessageDirection.clientToServer,t.type=new _c.ProtocolRequestType(t.method)})(W_||(po.InlineValueRequest=W_={}));var j_;(function(t){t.method="workspace/inlineValue/refresh",t.messageDirection=_c.MessageDirection.serverToClient,t.type=new _c.ProtocolRequestType0(t.method)})(j_||(po.InlineValueRefreshRequest=j_={}))});var Q_=re(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.InlayHintRefreshRequest=oi.InlayHintResolveRequest=oi.InlayHintRequest=void 0;var mo=ft(),H_;(function(t){t.method="textDocument/inlayHint",t.messageDirection=mo.MessageDirection.clientToServer,t.type=new mo.ProtocolRequestType(t.method)})(H_||(oi.InlayHintRequest=H_={}));var V_;(function(t){t.method="inlayHint/resolve",t.messageDirection=mo.MessageDirection.clientToServer,t.type=new mo.ProtocolRequestType(t.method)})(V_||(oi.InlayHintResolveRequest=V_={}));var G_;(function(t){t.method="workspace/inlayHint/refresh",t.messageDirection=mo.MessageDirection.serverToClient,t.type=new mo.ProtocolRequestType0(t.method)})(G_||(oi.InlayHintRefreshRequest=G_={}))});var tv=re(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});On.DiagnosticRefreshRequest=On.WorkspaceDiagnosticRequest=On.DocumentDiagnosticRequest=On.DocumentDiagnosticReportKind=On.DiagnosticServerCancellationData=void 0;var ev=Di(),$I=sc(),bo=ft(),J_;(function(t){function e(n){let i=n;return i&&$I.boolean(i.retriggerRequest)}t.is=e})(J_||(On.DiagnosticServerCancellationData=J_={}));var X_;(function(t){t.Full="full",t.Unchanged="unchanged"})(X_||(On.DocumentDiagnosticReportKind=X_={}));var Y_;(function(t){t.method="textDocument/diagnostic",t.messageDirection=bo.MessageDirection.clientToServer,t.type=new bo.ProtocolRequestType(t.method),t.partialResult=new ev.ProgressType})(Y_||(On.DocumentDiagnosticRequest=Y_={}));var K_;(function(t){t.method="workspace/diagnostic",t.messageDirection=bo.MessageDirection.clientToServer,t.type=new bo.ProtocolRequestType(t.method),t.partialResult=new ev.ProgressType})(K_||(On.WorkspaceDiagnosticRequest=K_={}));var Z_;(function(t){t.method="workspace/diagnostic/refresh",t.messageDirection=bo.MessageDirection.serverToClient,t.type=new bo.ProtocolRequestType0(t.method)})(Z_||(On.DiagnosticRefreshRequest=Z_={}))});var cv=re(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.DidCloseNotebookDocumentNotification=_t.DidSaveNotebookDocumentNotification=_t.DidChangeNotebookDocumentNotification=_t.NotebookCellArrayChange=_t.DidOpenNotebookDocumentNotification=_t.NotebookDocumentSyncRegistrationType=_t.NotebookDocument=_t.NotebookCell=_t.ExecutionSummary=_t.NotebookCellKind=void 0;var ds=oc(),Kn=sc(),gr=ft(),Af;(function(t){t.Markup=1,t.Code=2;function e(n){return n===1||n===2}t.is=e})(Af||(_t.NotebookCellKind=Af={}));var Nf;(function(t){function e(s,c){let u={executionOrder:s};return(c===!0||c===!1)&&(u.success=c),u}t.create=e;function n(s){let c=s;return Kn.objectLiteral(c)&&ds.uinteger.is(c.executionOrder)&&(c.success===void 0||Kn.boolean(c.success))}t.is=n;function i(s,c){return s===c?!0:s==null||c===null||c===void 0?!1:s.executionOrder===c.executionOrder&&s.success===c.success}t.equals=i})(Nf||(_t.ExecutionSummary=Nf={}));var vc;(function(t){function e(c,u){return{kind:c,document:u}}t.create=e;function n(c){let u=c;return Kn.objectLiteral(u)&&Af.is(u.kind)&&ds.DocumentUri.is(u.document)&&(u.metadata===void 0||Kn.objectLiteral(u.metadata))}t.is=n;function i(c,u){let h=new Set;return c.document!==u.document&&h.add("document"),c.kind!==u.kind&&h.add("kind"),c.executionSummary!==u.executionSummary&&h.add("executionSummary"),(c.metadata!==void 0||u.metadata!==void 0)&&!s(c.metadata,u.metadata)&&h.add("metadata"),(c.executionSummary!==void 0||u.executionSummary!==void 0)&&!Nf.equals(c.executionSummary,u.executionSummary)&&h.add("executionSummary"),h}t.diff=i;function s(c,u){if(c===u)return!0;if(c==null||u===null||u===void 0||typeof c!=typeof u||typeof c!="object")return!1;let h=Array.isArray(c),g=Array.isArray(u);if(h!==g)return!1;if(h&&g){if(c.length!==u.length)return!1;for(let b=0;b<c.length;b++)if(!s(c[b],u[b]))return!1}if(Kn.objectLiteral(c)&&Kn.objectLiteral(u)){let b=Object.keys(c),y=Object.keys(u);if(b.length!==y.length||(b.sort(),y.sort(),!s(b,y)))return!1;for(let T=0;T<b.length;T++){let F=b[T];if(!s(c[F],u[F]))return!1}}return!0}})(vc||(_t.NotebookCell=vc={}));var nv;(function(t){function e(i,s,c,u){return{uri:i,notebookType:s,version:c,cells:u}}t.create=e;function n(i){let s=i;return Kn.objectLiteral(s)&&Kn.string(s.uri)&&ds.integer.is(s.version)&&Kn.typedArray(s.cells,vc.is)}t.is=n})(nv||(_t.NotebookDocument=nv={}));var _o;(function(t){t.method="notebookDocument/sync",t.messageDirection=gr.MessageDirection.clientToServer,t.type=new gr.RegistrationType(t.method)})(_o||(_t.NotebookDocumentSyncRegistrationType=_o={}));var rv;(function(t){t.method="notebookDocument/didOpen",t.messageDirection=gr.MessageDirection.clientToServer,t.type=new gr.ProtocolNotificationType(t.method),t.registrationMethod=_o.method})(rv||(_t.DidOpenNotebookDocumentNotification=rv={}));var iv;(function(t){function e(i){let s=i;return Kn.objectLiteral(s)&&ds.uinteger.is(s.start)&&ds.uinteger.is(s.deleteCount)&&(s.cells===void 0||Kn.typedArray(s.cells,vc.is))}t.is=e;function n(i,s,c){let u={start:i,deleteCount:s};return c!==void 0&&(u.cells=c),u}t.create=n})(iv||(_t.NotebookCellArrayChange=iv={}));var ov;(function(t){t.method="notebookDocument/didChange",t.messageDirection=gr.MessageDirection.clientToServer,t.type=new gr.ProtocolNotificationType(t.method),t.registrationMethod=_o.method})(ov||(_t.DidChangeNotebookDocumentNotification=ov={}));var sv;(function(t){t.method="notebookDocument/didSave",t.messageDirection=gr.MessageDirection.clientToServer,t.type=new gr.ProtocolNotificationType(t.method),t.registrationMethod=_o.method})(sv||(_t.DidSaveNotebookDocumentNotification=sv={}));var av;(function(t){t.method="notebookDocument/didClose",t.messageDirection=gr.MessageDirection.clientToServer,t.type=new gr.ProtocolNotificationType(t.method),t.registrationMethod=_o.method})(av||(_t.DidCloseNotebookDocumentNotification=av={}))});var dv=re(yc=>{"use strict";Object.defineProperty(yc,"__esModule",{value:!0});yc.InlineCompletionRequest=void 0;var uv=ft(),lv;(function(t){t.method="textDocument/inlineCompletion",t.messageDirection=uv.MessageDirection.clientToServer,t.type=new uv.ProtocolRequestType(t.method)})(lv||(yc.InlineCompletionRequest=lv={}))});var Sy=re(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.WorkspaceSymbolRequest=w.CodeActionResolveRequest=w.CodeActionRequest=w.DocumentSymbolRequest=w.DocumentHighlightRequest=w.ReferencesRequest=w.DefinitionRequest=w.SignatureHelpRequest=w.SignatureHelpTriggerKind=w.HoverRequest=w.CompletionResolveRequest=w.CompletionRequest=w.CompletionTriggerKind=w.PublishDiagnosticsNotification=w.WatchKind=w.RelativePattern=w.FileChangeType=w.DidChangeWatchedFilesNotification=w.WillSaveTextDocumentWaitUntilRequest=w.WillSaveTextDocumentNotification=w.TextDocumentSaveReason=w.DidSaveTextDocumentNotification=w.DidCloseTextDocumentNotification=w.DidChangeTextDocumentNotification=w.TextDocumentContentChangeEvent=w.DidOpenTextDocumentNotification=w.TextDocumentSyncKind=w.TelemetryEventNotification=w.LogMessageNotification=w.ShowMessageRequest=w.ShowMessageNotification=w.MessageType=w.DidChangeConfigurationNotification=w.ExitNotification=w.ShutdownRequest=w.InitializedNotification=w.InitializeErrorCodes=w.InitializeRequest=w.WorkDoneProgressOptions=w.TextDocumentRegistrationOptions=w.StaticRegistrationOptions=w.PositionEncodingKind=w.FailureHandlingKind=w.ResourceOperationKind=w.UnregistrationRequest=w.RegistrationRequest=w.DocumentSelector=w.NotebookCellTextDocumentFilter=w.NotebookDocumentFilter=w.TextDocumentFilter=void 0;w.MonikerRequest=w.MonikerKind=w.UniquenessLevel=w.WillDeleteFilesRequest=w.DidDeleteFilesNotification=w.WillRenameFilesRequest=w.DidRenameFilesNotification=w.WillCreateFilesRequest=w.DidCreateFilesNotification=w.FileOperationPatternKind=w.LinkedEditingRangeRequest=w.ShowDocumentRequest=w.SemanticTokensRegistrationType=w.SemanticTokensRefreshRequest=w.SemanticTokensRangeRequest=w.SemanticTokensDeltaRequest=w.SemanticTokensRequest=w.TokenFormat=w.CallHierarchyPrepareRequest=w.CallHierarchyOutgoingCallsRequest=w.CallHierarchyIncomingCallsRequest=w.WorkDoneProgressCancelNotification=w.WorkDoneProgressCreateRequest=w.WorkDoneProgress=w.SelectionRangeRequest=w.DeclarationRequest=w.FoldingRangeRefreshRequest=w.FoldingRangeRequest=w.ColorPresentationRequest=w.DocumentColorRequest=w.ConfigurationRequest=w.DidChangeWorkspaceFoldersNotification=w.WorkspaceFoldersRequest=w.TypeDefinitionRequest=w.ImplementationRequest=w.ApplyWorkspaceEditRequest=w.ExecuteCommandRequest=w.PrepareRenameRequest=w.RenameRequest=w.PrepareSupportDefaultBehavior=w.DocumentOnTypeFormattingRequest=w.DocumentRangesFormattingRequest=w.DocumentRangeFormattingRequest=w.DocumentFormattingRequest=w.DocumentLinkResolveRequest=w.DocumentLinkRequest=w.CodeLensRefreshRequest=w.CodeLensResolveRequest=w.CodeLensRequest=w.WorkspaceSymbolResolveRequest=void 0;w.InlineCompletionRequest=w.DidCloseNotebookDocumentNotification=w.DidSaveNotebookDocumentNotification=w.DidChangeNotebookDocumentNotification=w.NotebookCellArrayChange=w.DidOpenNotebookDocumentNotification=w.NotebookDocumentSyncRegistrationType=w.NotebookDocument=w.NotebookCell=w.ExecutionSummary=w.NotebookCellKind=w.DiagnosticRefreshRequest=w.WorkspaceDiagnosticRequest=w.DocumentDiagnosticRequest=w.DocumentDiagnosticReportKind=w.DiagnosticServerCancellationData=w.InlayHintRefreshRequest=w.InlayHintResolveRequest=w.InlayHintRequest=w.InlineValueRefreshRequest=w.InlineValueRequest=w.TypeHierarchySupertypesRequest=w.TypeHierarchySubtypesRequest=w.TypeHierarchyPrepareRequest=void 0;var K=ft(),fv=oc(),qt=sc(),WI=Lb();Object.defineProperty(w,"ImplementationRequest",{enumerable:!0,get:function(){return WI.ImplementationRequest}});var jI=Ub();Object.defineProperty(w,"TypeDefinitionRequest",{enumerable:!0,get:function(){return jI.TypeDefinitionRequest}});var yy=jb();Object.defineProperty(w,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return yy.WorkspaceFoldersRequest}});Object.defineProperty(w,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return yy.DidChangeWorkspaceFoldersNotification}});var zI=Vb();Object.defineProperty(w,"ConfigurationRequest",{enumerable:!0,get:function(){return zI.ConfigurationRequest}});var wy=Jb();Object.defineProperty(w,"DocumentColorRequest",{enumerable:!0,get:function(){return wy.DocumentColorRequest}});Object.defineProperty(w,"ColorPresentationRequest",{enumerable:!0,get:function(){return wy.ColorPresentationRequest}});var Py=Kb();Object.defineProperty(w,"FoldingRangeRequest",{enumerable:!0,get:function(){return Py.FoldingRangeRequest}});Object.defineProperty(w,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return Py.FoldingRangeRefreshRequest}});var HI=t_();Object.defineProperty(w,"DeclarationRequest",{enumerable:!0,get:function(){return HI.DeclarationRequest}});var VI=i_();Object.defineProperty(w,"SelectionRangeRequest",{enumerable:!0,get:function(){return VI.SelectionRangeRequest}});var Uf=c_();Object.defineProperty(w,"WorkDoneProgress",{enumerable:!0,get:function(){return Uf.WorkDoneProgress}});Object.defineProperty(w,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return Uf.WorkDoneProgressCreateRequest}});Object.defineProperty(w,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return Uf.WorkDoneProgressCancelNotification}});var $f=f_();Object.defineProperty(w,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return $f.CallHierarchyIncomingCallsRequest}});Object.defineProperty(w,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return $f.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(w,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return $f.CallHierarchyPrepareRequest}});var vo=__();Object.defineProperty(w,"TokenFormat",{enumerable:!0,get:function(){return vo.TokenFormat}});Object.defineProperty(w,"SemanticTokensRequest",{enumerable:!0,get:function(){return vo.SemanticTokensRequest}});Object.defineProperty(w,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return vo.SemanticTokensDeltaRequest}});Object.defineProperty(w,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return vo.SemanticTokensRangeRequest}});Object.defineProperty(w,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return vo.SemanticTokensRefreshRequest}});Object.defineProperty(w,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return vo.SemanticTokensRegistrationType}});var GI=w_();Object.defineProperty(w,"ShowDocumentRequest",{enumerable:!0,get:function(){return GI.ShowDocumentRequest}});var QI=S_();Object.defineProperty(w,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return QI.LinkedEditingRangeRequest}});var Ii=F_();Object.defineProperty(w,"FileOperationPatternKind",{enumerable:!0,get:function(){return Ii.FileOperationPatternKind}});Object.defineProperty(w,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Ii.DidCreateFilesNotification}});Object.defineProperty(w,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Ii.WillCreateFilesRequest}});Object.defineProperty(w,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Ii.DidRenameFilesNotification}});Object.defineProperty(w,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Ii.WillRenameFilesRequest}});Object.defineProperty(w,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Ii.DidDeleteFilesNotification}});Object.defineProperty(w,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Ii.WillDeleteFilesRequest}});var Wf=L_();Object.defineProperty(w,"UniquenessLevel",{enumerable:!0,get:function(){return Wf.UniquenessLevel}});Object.defineProperty(w,"MonikerKind",{enumerable:!0,get:function(){return Wf.MonikerKind}});Object.defineProperty(w,"MonikerRequest",{enumerable:!0,get:function(){return Wf.MonikerRequest}});var jf=$_();Object.defineProperty(w,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return jf.TypeHierarchyPrepareRequest}});Object.defineProperty(w,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return jf.TypeHierarchySubtypesRequest}});Object.defineProperty(w,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return jf.TypeHierarchySupertypesRequest}});var xy=z_();Object.defineProperty(w,"InlineValueRequest",{enumerable:!0,get:function(){return xy.InlineValueRequest}});Object.defineProperty(w,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return xy.InlineValueRefreshRequest}});var zf=Q_();Object.defineProperty(w,"InlayHintRequest",{enumerable:!0,get:function(){return zf.InlayHintRequest}});Object.defineProperty(w,"InlayHintResolveRequest",{enumerable:!0,get:function(){return zf.InlayHintResolveRequest}});Object.defineProperty(w,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return zf.InlayHintRefreshRequest}});var fs=tv();Object.defineProperty(w,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return fs.DiagnosticServerCancellationData}});Object.defineProperty(w,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return fs.DocumentDiagnosticReportKind}});Object.defineProperty(w,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return fs.DocumentDiagnosticRequest}});Object.defineProperty(w,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return fs.WorkspaceDiagnosticRequest}});Object.defineProperty(w,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return fs.DiagnosticRefreshRequest}});var pr=cv();Object.defineProperty(w,"NotebookCellKind",{enumerable:!0,get:function(){return pr.NotebookCellKind}});Object.defineProperty(w,"ExecutionSummary",{enumerable:!0,get:function(){return pr.ExecutionSummary}});Object.defineProperty(w,"NotebookCell",{enumerable:!0,get:function(){return pr.NotebookCell}});Object.defineProperty(w,"NotebookDocument",{enumerable:!0,get:function(){return pr.NotebookDocument}});Object.defineProperty(w,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return pr.NotebookDocumentSyncRegistrationType}});Object.defineProperty(w,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return pr.DidOpenNotebookDocumentNotification}});Object.defineProperty(w,"NotebookCellArrayChange",{enumerable:!0,get:function(){return pr.NotebookCellArrayChange}});Object.defineProperty(w,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return pr.DidChangeNotebookDocumentNotification}});Object.defineProperty(w,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return pr.DidSaveNotebookDocumentNotification}});Object.defineProperty(w,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return pr.DidCloseNotebookDocumentNotification}});var JI=dv();Object.defineProperty(w,"InlineCompletionRequest",{enumerable:!0,get:function(){return JI.InlineCompletionRequest}});var qf;(function(t){function e(n){let i=n;return qt.string(i)||qt.string(i.language)||qt.string(i.scheme)||qt.string(i.pattern)}t.is=e})(qf||(w.TextDocumentFilter=qf={}));var Lf;(function(t){function e(n){let i=n;return qt.objectLiteral(i)&&(qt.string(i.notebookType)||qt.string(i.scheme)||qt.string(i.pattern))}t.is=e})(Lf||(w.NotebookDocumentFilter=Lf={}));var Of;(function(t){function e(n){let i=n;return qt.objectLiteral(i)&&(qt.string(i.notebook)||Lf.is(i.notebook))&&(i.language===void 0||qt.string(i.language))}t.is=e})(Of||(w.NotebookCellTextDocumentFilter=Of={}));var Bf;(function(t){function e(n){if(!Array.isArray(n))return!1;for(let i of n)if(!qt.string(i)&&!qf.is(i)&&!Of.is(i))return!1;return!0}t.is=e})(Bf||(w.DocumentSelector=Bf={}));var hv;(function(t){t.method="client/registerCapability",t.messageDirection=K.MessageDirection.serverToClient,t.type=new K.ProtocolRequestType(t.method)})(hv||(w.RegistrationRequest=hv={}));var gv;(function(t){t.method="client/unregisterCapability",t.messageDirection=K.MessageDirection.serverToClient,t.type=new K.ProtocolRequestType(t.method)})(gv||(w.UnregistrationRequest=gv={}));var pv;(function(t){t.Create="create",t.Rename="rename",t.Delete="delete"})(pv||(w.ResourceOperationKind=pv={}));var mv;(function(t){t.Abort="abort",t.Transactional="transactional",t.TextOnlyTransactional="textOnlyTransactional",t.Undo="undo"})(mv||(w.FailureHandlingKind=mv={}));var bv;(function(t){t.UTF8="utf-8",t.UTF16="utf-16",t.UTF32="utf-32"})(bv||(w.PositionEncodingKind=bv={}));var _v;(function(t){function e(n){let i=n;return i&&qt.string(i.id)&&i.id.length>0}t.hasId=e})(_v||(w.StaticRegistrationOptions=_v={}));var vv;(function(t){function e(n){let i=n;return i&&(i.documentSelector===null||Bf.is(i.documentSelector))}t.is=e})(vv||(w.TextDocumentRegistrationOptions=vv={}));var yv;(function(t){function e(i){let s=i;return qt.objectLiteral(s)&&(s.workDoneProgress===void 0||qt.boolean(s.workDoneProgress))}t.is=e;function n(i){let s=i;return s&&qt.boolean(s.workDoneProgress)}t.hasWorkDoneProgress=n})(yv||(w.WorkDoneProgressOptions=yv={}));var wv;(function(t){t.method="initialize",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(wv||(w.InitializeRequest=wv={}));var Pv;(function(t){t.unknownProtocolVersion=1})(Pv||(w.InitializeErrorCodes=Pv={}));var xv;(function(t){t.method="initialized",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolNotificationType(t.method)})(xv||(w.InitializedNotification=xv={}));var Sv;(function(t){t.method="shutdown",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType0(t.method)})(Sv||(w.ShutdownRequest=Sv={}));var Cv;(function(t){t.method="exit",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolNotificationType0(t.method)})(Cv||(w.ExitNotification=Cv={}));var kv;(function(t){t.method="workspace/didChangeConfiguration",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolNotificationType(t.method)})(kv||(w.DidChangeConfigurationNotification=kv={}));var Rv;(function(t){t.Error=1,t.Warning=2,t.Info=3,t.Log=4,t.Debug=5})(Rv||(w.MessageType=Rv={}));var Tv;(function(t){t.method="window/showMessage",t.messageDirection=K.MessageDirection.serverToClient,t.type=new K.ProtocolNotificationType(t.method)})(Tv||(w.ShowMessageNotification=Tv={}));var Dv;(function(t){t.method="window/showMessageRequest",t.messageDirection=K.MessageDirection.serverToClient,t.type=new K.ProtocolRequestType(t.method)})(Dv||(w.ShowMessageRequest=Dv={}));var Iv;(function(t){t.method="window/logMessage",t.messageDirection=K.MessageDirection.serverToClient,t.type=new K.ProtocolNotificationType(t.method)})(Iv||(w.LogMessageNotification=Iv={}));var Ev;(function(t){t.method="telemetry/event",t.messageDirection=K.MessageDirection.serverToClient,t.type=new K.ProtocolNotificationType(t.method)})(Ev||(w.TelemetryEventNotification=Ev={}));var Fv;(function(t){t.None=0,t.Full=1,t.Incremental=2})(Fv||(w.TextDocumentSyncKind=Fv={}));var Mv;(function(t){t.method="textDocument/didOpen",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolNotificationType(t.method)})(Mv||(w.DidOpenTextDocumentNotification=Mv={}));var Av;(function(t){function e(i){let s=i;return s!=null&&typeof s.text=="string"&&s.range!==void 0&&(s.rangeLength===void 0||typeof s.rangeLength=="number")}t.isIncremental=e;function n(i){let s=i;return s!=null&&typeof s.text=="string"&&s.range===void 0&&s.rangeLength===void 0}t.isFull=n})(Av||(w.TextDocumentContentChangeEvent=Av={}));var Nv;(function(t){t.method="textDocument/didChange",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolNotificationType(t.method)})(Nv||(w.DidChangeTextDocumentNotification=Nv={}));var qv;(function(t){t.method="textDocument/didClose",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolNotificationType(t.method)})(qv||(w.DidCloseTextDocumentNotification=qv={}));var Lv;(function(t){t.method="textDocument/didSave",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolNotificationType(t.method)})(Lv||(w.DidSaveTextDocumentNotification=Lv={}));var Ov;(function(t){t.Manual=1,t.AfterDelay=2,t.FocusOut=3})(Ov||(w.TextDocumentSaveReason=Ov={}));var Bv;(function(t){t.method="textDocument/willSave",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolNotificationType(t.method)})(Bv||(w.WillSaveTextDocumentNotification=Bv={}));var Uv;(function(t){t.method="textDocument/willSaveWaitUntil",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(Uv||(w.WillSaveTextDocumentWaitUntilRequest=Uv={}));var $v;(function(t){t.method="workspace/didChangeWatchedFiles",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolNotificationType(t.method)})($v||(w.DidChangeWatchedFilesNotification=$v={}));var Wv;(function(t){t.Created=1,t.Changed=2,t.Deleted=3})(Wv||(w.FileChangeType=Wv={}));var jv;(function(t){function e(n){let i=n;return qt.objectLiteral(i)&&(fv.URI.is(i.baseUri)||fv.WorkspaceFolder.is(i.baseUri))&&qt.string(i.pattern)}t.is=e})(jv||(w.RelativePattern=jv={}));var zv;(function(t){t.Create=1,t.Change=2,t.Delete=4})(zv||(w.WatchKind=zv={}));var Hv;(function(t){t.method="textDocument/publishDiagnostics",t.messageDirection=K.MessageDirection.serverToClient,t.type=new K.ProtocolNotificationType(t.method)})(Hv||(w.PublishDiagnosticsNotification=Hv={}));var Vv;(function(t){t.Invoked=1,t.TriggerCharacter=2,t.TriggerForIncompleteCompletions=3})(Vv||(w.CompletionTriggerKind=Vv={}));var Gv;(function(t){t.method="textDocument/completion",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(Gv||(w.CompletionRequest=Gv={}));var Qv;(function(t){t.method="completionItem/resolve",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(Qv||(w.CompletionResolveRequest=Qv={}));var Jv;(function(t){t.method="textDocument/hover",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(Jv||(w.HoverRequest=Jv={}));var Xv;(function(t){t.Invoked=1,t.TriggerCharacter=2,t.ContentChange=3})(Xv||(w.SignatureHelpTriggerKind=Xv={}));var Yv;(function(t){t.method="textDocument/signatureHelp",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(Yv||(w.SignatureHelpRequest=Yv={}));var Kv;(function(t){t.method="textDocument/definition",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(Kv||(w.DefinitionRequest=Kv={}));var Zv;(function(t){t.method="textDocument/references",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(Zv||(w.ReferencesRequest=Zv={}));var ey;(function(t){t.method="textDocument/documentHighlight",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(ey||(w.DocumentHighlightRequest=ey={}));var ty;(function(t){t.method="textDocument/documentSymbol",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(ty||(w.DocumentSymbolRequest=ty={}));var ny;(function(t){t.method="textDocument/codeAction",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(ny||(w.CodeActionRequest=ny={}));var ry;(function(t){t.method="codeAction/resolve",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(ry||(w.CodeActionResolveRequest=ry={}));var iy;(function(t){t.method="workspace/symbol",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(iy||(w.WorkspaceSymbolRequest=iy={}));var oy;(function(t){t.method="workspaceSymbol/resolve",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(oy||(w.WorkspaceSymbolResolveRequest=oy={}));var sy;(function(t){t.method="textDocument/codeLens",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(sy||(w.CodeLensRequest=sy={}));var ay;(function(t){t.method="codeLens/resolve",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(ay||(w.CodeLensResolveRequest=ay={}));var cy;(function(t){t.method="workspace/codeLens/refresh",t.messageDirection=K.MessageDirection.serverToClient,t.type=new K.ProtocolRequestType0(t.method)})(cy||(w.CodeLensRefreshRequest=cy={}));var uy;(function(t){t.method="textDocument/documentLink",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(uy||(w.DocumentLinkRequest=uy={}));var ly;(function(t){t.method="documentLink/resolve",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(ly||(w.DocumentLinkResolveRequest=ly={}));var dy;(function(t){t.method="textDocument/formatting",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(dy||(w.DocumentFormattingRequest=dy={}));var fy;(function(t){t.method="textDocument/rangeFormatting",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(fy||(w.DocumentRangeFormattingRequest=fy={}));var hy;(function(t){t.method="textDocument/rangesFormatting",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(hy||(w.DocumentRangesFormattingRequest=hy={}));var gy;(function(t){t.method="textDocument/onTypeFormatting",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(gy||(w.DocumentOnTypeFormattingRequest=gy={}));var py;(function(t){t.Identifier=1})(py||(w.PrepareSupportDefaultBehavior=py={}));var my;(function(t){t.method="textDocument/rename",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(my||(w.RenameRequest=my={}));var by;(function(t){t.method="textDocument/prepareRename",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(by||(w.PrepareRenameRequest=by={}));var _y;(function(t){t.method="workspace/executeCommand",t.messageDirection=K.MessageDirection.clientToServer,t.type=new K.ProtocolRequestType(t.method)})(_y||(w.ExecuteCommandRequest=_y={}));var vy;(function(t){t.method="workspace/applyEdit",t.messageDirection=K.MessageDirection.serverToClient,t.type=new K.ProtocolRequestType("workspace/applyEdit")})(vy||(w.ApplyWorkspaceEditRequest=vy={}))});var ky=re(wc=>{"use strict";Object.defineProperty(wc,"__esModule",{value:!0});wc.createProtocolConnection=void 0;var Cy=Di();function XI(t,e,n,i){return Cy.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,Cy.createMessageConnection)(t,e,n,i)}wc.createProtocolConnection=XI});var Ty=re(fn=>{"use strict";var YI=fn&&fn.__createBinding||(Object.create?function(t,e,n,i){i===void 0&&(i=n);var s=Object.getOwnPropertyDescriptor(e,n);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,s)}:function(t,e,n,i){i===void 0&&(i=n),t[i]=e[n]}),Pc=fn&&fn.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&YI(e,t,n)};Object.defineProperty(fn,"__esModule",{value:!0});fn.LSPErrorCodes=fn.createProtocolConnection=void 0;Pc(Di(),fn);Pc(oc(),fn);Pc(ft(),fn);Pc(Sy(),fn);var KI=ky();Object.defineProperty(fn,"createProtocolConnection",{enumerable:!0,get:function(){return KI.createProtocolConnection}});var Ry;(function(t){t.lspReservedErrorRangeStart=-32899,t.RequestFailed=-32803,t.ServerCancelled=-32802,t.ContentModified=-32801,t.RequestCancelled=-32800,t.lspReservedErrorRangeEnd=-32800})(Ry||(fn.LSPErrorCodes=Ry={}))});var Ct=re(mr=>{"use strict";var ZI=mr&&mr.__createBinding||(Object.create?function(t,e,n,i){i===void 0&&(i=n);var s=Object.getOwnPropertyDescriptor(e,n);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,s)}:function(t,e,n,i){i===void 0&&(i=n),t[i]=e[n]}),Dy=mr&&mr.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&ZI(e,t,n)};Object.defineProperty(mr,"__esModule",{value:!0});mr.createProtocolConnection=void 0;var eE=Tf();Dy(Tf(),mr);Dy(Ty(),mr);function tE(t,e,n,i){return(0,eE.createMessageConnection)(t,e,n,i)}mr.createProtocolConnection=tE});var Hf=re(Bn=>{"use strict";Object.defineProperty(Bn,"__esModule",{value:!0});Bn.generateUuid=Bn.parse=Bn.isUUID=Bn.v4=Bn.empty=void 0;var hs=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},gs=class t extends hs{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return t._oneOf(t._chars)}constructor(){super([t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),"-",t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),"-","4",t._randomHex(),t._randomHex(),t._randomHex(),"-",t._oneOf(t._timeHighBits),t._randomHex(),t._randomHex(),t._randomHex(),"-",t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex()].join(""))}};gs._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];gs._timeHighBits=["8","9","a","b"];Bn.empty=new hs("00000000-0000-0000-0000-000000000000");function Iy(){return new gs}Bn.v4=Iy;var nE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Ey(t){return nE.test(t)}Bn.isUUID=Ey;function rE(t){if(!Ey(t))throw new Error("invalid uuid");return new hs(t)}Bn.parse=rE;function iE(){return Iy().asHex()}Bn.generateUuid=iE});var Fy=re(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});ai.attachPartialResult=ai.ProgressFeature=ai.attachWorkDone=void 0;var si=Ct(),oE=Hf(),Ei=class t{constructor(e,n){this._connection=e,this._token=n,t.Instances.set(this._token,this)}begin(e,n,i,s){let c={kind:"begin",title:e,percentage:n,message:i,cancellable:s};this._connection.sendProgress(si.WorkDoneProgress.type,this._token,c)}report(e,n){let i={kind:"report"};typeof e=="number"?(i.percentage=e,n!==void 0&&(i.message=n)):i.message=e,this._connection.sendProgress(si.WorkDoneProgress.type,this._token,i)}done(){t.Instances.delete(this._token),this._connection.sendProgress(si.WorkDoneProgress.type,this._token,{kind:"end"})}};Ei.Instances=new Map;var xc=class extends Ei{constructor(e,n){super(e,n),this._source=new si.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}},ps=class{constructor(){}begin(){}report(){}done(){}},Sc=class extends ps{constructor(){super(),this._source=new si.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}};function sE(t,e){if(e===void 0||e.workDoneToken===void 0)return new ps;let n=e.workDoneToken;return delete e.workDoneToken,new Ei(t,n)}ai.attachWorkDone=sE;var aE=t=>class extends t{constructor(){super(),this._progressSupported=!1}initialize(e){super.initialize(e),e?.window?.workDoneProgress===!0&&(this._progressSupported=!0,this.connection.onNotification(si.WorkDoneProgressCancelNotification.type,n=>{let i=Ei.Instances.get(n.token);(i instanceof xc||i instanceof Sc)&&i.cancel()}))}attachWorkDoneProgress(e){return e===void 0?new ps:new Ei(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){let e=(0,oE.generateUuid)();return this.connection.sendRequest(si.WorkDoneProgressCreateRequest.type,{token:e}).then(()=>new xc(this.connection,e))}else return Promise.resolve(new Sc)}};ai.ProgressFeature=aE;var Vf;(function(t){t.type=new si.ProgressType})(Vf||(Vf={}));var Gf=class{constructor(e,n){this._connection=e,this._token=n}report(e){this._connection.sendProgress(Vf.type,this._token,e)}};function cE(t,e){if(e===void 0||e.partialResultToken===void 0)return;let n=e.partialResultToken;return delete e.partialResultToken,new Gf(t,n)}ai.attachPartialResult=cE});var My=re(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.ConfigurationFeature=void 0;var uE=Ct(),lE=qa(),dE=t=>class extends t{getConfiguration(e){return e?lE.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let n={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(uE.ConfigurationRequest.type,n).then(i=>Array.isArray(i)?Array.isArray(e)?i:i[0]:Array.isArray(e)?[]:null)}};Cc.ConfigurationFeature=dE});var Ay=re(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.WorkspaceFoldersFeature=void 0;var kc=Ct(),fE=t=>class extends t{constructor(){super(),this._notificationIsAutoRegistered=!1}initialize(e){super.initialize(e);let n=e.workspace;n&&n.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new kc.Emitter,this.connection.onNotification(kc.DidChangeWorkspaceFoldersNotification.type,i=>{this._onDidChangeWorkspaceFolders.fire(i.event)}))}fillServerCapabilities(e){super.fillServerCapabilities(e);let n=e.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=n===!0||typeof n=="string"}getWorkspaceFolders(){return this.connection.sendRequest(kc.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return!this._notificationIsAutoRegistered&&!this._unregistration&&(this._unregistration=this.connection.client.register(kc.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}};Rc.WorkspaceFoldersFeature=fE});var Ny=re(Tc=>{"use strict";Object.defineProperty(Tc,"__esModule",{value:!0});Tc.CallHierarchyFeature=void 0;var Qf=Ct(),hE=t=>class extends t{get callHierarchy(){return{onPrepare:e=>this.connection.onRequest(Qf.CallHierarchyPrepareRequest.type,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),void 0)),onIncomingCalls:e=>{let n=Qf.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(n,(i,s)=>e(i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))},onOutgoingCalls:e=>{let n=Qf.CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(n,(i,s)=>e(i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};Tc.CallHierarchyFeature=hE});var Xf=re(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.SemanticTokensBuilder=ci.SemanticTokensDiff=ci.SemanticTokensFeature=void 0;var Dc=Ct(),gE=t=>class extends t{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(Dc.SemanticTokensRefreshRequest.type),on:e=>{let n=Dc.SemanticTokensRequest.type;return this.connection.onRequest(n,(i,s)=>e(i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))},onDelta:e=>{let n=Dc.SemanticTokensDeltaRequest.type;return this.connection.onRequest(n,(i,s)=>e(i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))},onRange:e=>{let n=Dc.SemanticTokensRangeRequest.type;return this.connection.onRequest(n,(i,s)=>e(i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};ci.SemanticTokensFeature=gE;var Ic=class{constructor(e,n){this.originalSequence=e,this.modifiedSequence=n}computeDiff(){let e=this.originalSequence.length,n=this.modifiedSequence.length,i=0;for(;i<n&&i<e&&this.originalSequence[i]===this.modifiedSequence[i];)i++;if(i<n&&i<e){let s=e-1,c=n-1;for(;s>=i&&c>=i&&this.originalSequence[s]===this.modifiedSequence[c];)s--,c--;(s<i||c<i)&&(s++,c++);let u=s-i+1,h=this.modifiedSequence.slice(i,c+1);return h.length===1&&h[0]===this.originalSequence[s]?[{start:i,deleteCount:u-1}]:[{start:i,deleteCount:u,data:h}]}else return i<n?[{start:i,deleteCount:0,data:this.modifiedSequence.slice(i)}]:i<e?[{start:i,deleteCount:e-i}]:[]}};ci.SemanticTokensDiff=Ic;var Jf=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,n,i,s,c){let u=e,h=n;this._dataLen>0&&(u-=this._prevLine,u===0&&(h-=this._prevChar)),this._data[this._dataLen++]=u,this._data[this._dataLen++]=h,this._data[this._dataLen++]=i,this._data[this._dataLen++]=s,this._data[this._dataLen++]=c,this._prevLine=e,this._prevChar=n}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return this._prevData!==void 0}buildEdits(){return this._prevData!==void 0?{resultId:this.id,edits:new Ic(this._prevData,this._data).computeDiff()}:this.build()}};ci.SemanticTokensBuilder=Jf});var qy=re(Ec=>{"use strict";Object.defineProperty(Ec,"__esModule",{value:!0});Ec.ShowDocumentFeature=void 0;var pE=Ct(),mE=t=>class extends t{showDocument(e){return this.connection.sendRequest(pE.ShowDocumentRequest.type,e)}};Ec.ShowDocumentFeature=mE});var Ly=re(Fc=>{"use strict";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.FileOperationsFeature=void 0;var yo=Ct(),bE=t=>class extends t{onDidCreateFiles(e){return this.connection.onNotification(yo.DidCreateFilesNotification.type,n=>{e(n)})}onDidRenameFiles(e){return this.connection.onNotification(yo.DidRenameFilesNotification.type,n=>{e(n)})}onDidDeleteFiles(e){return this.connection.onNotification(yo.DidDeleteFilesNotification.type,n=>{e(n)})}onWillCreateFiles(e){return this.connection.onRequest(yo.WillCreateFilesRequest.type,(n,i)=>e(n,i))}onWillRenameFiles(e){return this.connection.onRequest(yo.WillRenameFilesRequest.type,(n,i)=>e(n,i))}onWillDeleteFiles(e){return this.connection.onRequest(yo.WillDeleteFilesRequest.type,(n,i)=>e(n,i))}};Fc.FileOperationsFeature=bE});var Oy=re(Mc=>{"use strict";Object.defineProperty(Mc,"__esModule",{value:!0});Mc.LinkedEditingRangeFeature=void 0;var _E=Ct(),vE=t=>class extends t{onLinkedEditingRange(e){return this.connection.onRequest(_E.LinkedEditingRangeRequest.type,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),void 0))}};Mc.LinkedEditingRangeFeature=vE});var By=re(Ac=>{"use strict";Object.defineProperty(Ac,"__esModule",{value:!0});Ac.TypeHierarchyFeature=void 0;var Yf=Ct(),yE=t=>class extends t{get typeHierarchy(){return{onPrepare:e=>this.connection.onRequest(Yf.TypeHierarchyPrepareRequest.type,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),void 0)),onSupertypes:e=>{let n=Yf.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(n,(i,s)=>e(i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))},onSubtypes:e=>{let n=Yf.TypeHierarchySubtypesRequest.type;return this.connection.onRequest(n,(i,s)=>e(i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};Ac.TypeHierarchyFeature=yE});var $y=re(Nc=>{"use strict";Object.defineProperty(Nc,"__esModule",{value:!0});Nc.InlineValueFeature=void 0;var Uy=Ct(),wE=t=>class extends t{get inlineValue(){return{refresh:()=>this.connection.sendRequest(Uy.InlineValueRefreshRequest.type),on:e=>this.connection.onRequest(Uy.InlineValueRequest.type,(n,i)=>e(n,i,this.attachWorkDoneProgress(n)))}}};Nc.InlineValueFeature=wE});var jy=re(qc=>{"use strict";Object.defineProperty(qc,"__esModule",{value:!0});qc.FoldingRangeFeature=void 0;var Wy=Ct(),PE=t=>class extends t{get foldingRange(){return{refresh:()=>this.connection.sendRequest(Wy.FoldingRangeRefreshRequest.type),on:e=>{let n=Wy.FoldingRangeRequest.type;return this.connection.onRequest(n,(i,s)=>e(i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};qc.FoldingRangeFeature=PE});var zy=re(Lc=>{"use strict";Object.defineProperty(Lc,"__esModule",{value:!0});Lc.InlayHintFeature=void 0;var Kf=Ct(),xE=t=>class extends t{get inlayHint(){return{refresh:()=>this.connection.sendRequest(Kf.InlayHintRefreshRequest.type),on:e=>this.connection.onRequest(Kf.InlayHintRequest.type,(n,i)=>e(n,i,this.attachWorkDoneProgress(n))),resolve:e=>this.connection.onRequest(Kf.InlayHintResolveRequest.type,(n,i)=>e(n,i))}}};Lc.InlayHintFeature=xE});var Hy=re(Oc=>{"use strict";Object.defineProperty(Oc,"__esModule",{value:!0});Oc.DiagnosticFeature=void 0;var ms=Ct(),SE=t=>class extends t{get diagnostics(){return{refresh:()=>this.connection.sendRequest(ms.DiagnosticRefreshRequest.type),on:e=>this.connection.onRequest(ms.DocumentDiagnosticRequest.type,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(ms.DocumentDiagnosticRequest.partialResult,n))),onWorkspace:e=>this.connection.onRequest(ms.WorkspaceDiagnosticRequest.type,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(ms.WorkspaceDiagnosticRequest.partialResult,n)))}}};Oc.DiagnosticFeature=SE});var eh=re(Bc=>{"use strict";Object.defineProperty(Bc,"__esModule",{value:!0});Bc.TextDocuments=void 0;var Fi=Ct(),Zf=class{constructor(e){this._configuration=e,this._syncedDocuments=new Map,this._onDidChangeContent=new Fi.Emitter,this._onDidOpen=new Fi.Emitter,this._onDidClose=new Fi.Emitter,this._onDidSave=new Fi.Emitter,this._onWillSave=new Fi.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._syncedDocuments.get(e)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(e){e.__textDocumentSync=Fi.TextDocumentSyncKind.Incremental;let n=[];return n.push(e.onDidOpenTextDocument(i=>{let s=i.textDocument,c=this._configuration.create(s.uri,s.languageId,s.version,s.text);this._syncedDocuments.set(s.uri,c);let u=Object.freeze({document:c});this._onDidOpen.fire(u),this._onDidChangeContent.fire(u)})),n.push(e.onDidChangeTextDocument(i=>{let s=i.textDocument,c=i.contentChanges;if(c.length===0)return;let{version:u}=s;if(u==null)throw new Error(`Received document change event for ${s.uri} without valid version identifier`);let h=this._syncedDocuments.get(s.uri);h!==void 0&&(h=this._configuration.update(h,c,u),this._syncedDocuments.set(s.uri,h),this._onDidChangeContent.fire(Object.freeze({document:h})))})),n.push(e.onDidCloseTextDocument(i=>{let s=this._syncedDocuments.get(i.textDocument.uri);s!==void 0&&(this._syncedDocuments.delete(i.textDocument.uri),this._onDidClose.fire(Object.freeze({document:s})))})),n.push(e.onWillSaveTextDocument(i=>{let s=this._syncedDocuments.get(i.textDocument.uri);s!==void 0&&this._onWillSave.fire(Object.freeze({document:s,reason:i.reason}))})),n.push(e.onWillSaveTextDocumentWaitUntil((i,s)=>{let c=this._syncedDocuments.get(i.textDocument.uri);return c!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:c,reason:i.reason}),s):[]})),n.push(e.onDidSaveTextDocument(i=>{let s=this._syncedDocuments.get(i.textDocument.uri);s!==void 0&&this._onDidSave.fire(Object.freeze({document:s}))})),Fi.Disposable.create(()=>{n.forEach(i=>i.dispose())})}};Bc.TextDocuments=Zf});var nh=re(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.NotebookDocuments=wo.NotebookSyncFeature=void 0;var Un=Ct(),Vy=eh(),CE=t=>class extends t{get synchronization(){return{onDidOpenNotebookDocument:e=>this.connection.onNotification(Un.DidOpenNotebookDocumentNotification.type,n=>{e(n)}),onDidChangeNotebookDocument:e=>this.connection.onNotification(Un.DidChangeNotebookDocumentNotification.type,n=>{e(n)}),onDidSaveNotebookDocument:e=>this.connection.onNotification(Un.DidSaveNotebookDocumentNotification.type,n=>{e(n)}),onDidCloseNotebookDocument:e=>this.connection.onNotification(Un.DidCloseNotebookDocumentNotification.type,n=>{e(n)})}}};wo.NotebookSyncFeature=CE;var Uc=class t{onDidOpenTextDocument(e){return this.openHandler=e,Un.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(e){this.openHandler&&this.openHandler(e)}onDidChangeTextDocument(e){return this.changeHandler=e,Un.Disposable.create(()=>{this.changeHandler=e})}changeTextDocument(e){this.changeHandler&&this.changeHandler(e)}onDidCloseTextDocument(e){return this.closeHandler=e,Un.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(e){this.closeHandler&&this.closeHandler(e)}onWillSaveTextDocument(){return t.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return t.NULL_DISPOSE}onDidSaveTextDocument(){return t.NULL_DISPOSE}};Uc.NULL_DISPOSE=Object.freeze({dispose:()=>{}});var th=class{constructor(e){e instanceof Vy.TextDocuments?this._cellTextDocuments=e:this._cellTextDocuments=new Vy.TextDocuments(e),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new Un.Emitter,this._onDidChange=new Un.Emitter,this._onDidSave=new Un.Emitter,this._onDidClose=new Un.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(e){return this._cellTextDocuments.get(e.document)}getNotebookDocument(e){return this.notebookDocuments.get(e)}getNotebookCell(e){let n=this.notebookCellMap.get(e);return n&&n[0]}findNotebookDocumentForCell(e){let n=typeof e=="string"?e:e.document,i=this.notebookCellMap.get(n);return i&&i[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(e){let n=new Uc,i=[];return i.push(this.cellTextDocuments.listen(n)),i.push(e.notebooks.synchronization.onDidOpenNotebookDocument(s=>{this.notebookDocuments.set(s.notebookDocument.uri,s.notebookDocument);for(let c of s.cellTextDocuments)n.openTextDocument({textDocument:c});this.updateCellMap(s.notebookDocument),this._onDidOpen.fire(s.notebookDocument)})),i.push(e.notebooks.synchronization.onDidChangeNotebookDocument(s=>{let c=this.notebookDocuments.get(s.notebookDocument.uri);if(c===void 0)return;c.version=s.notebookDocument.version;let u=c.metadata,h=!1,g=s.change;g.metadata!==void 0&&(h=!0,c.metadata=g.metadata);let b=[],y=[],T=[],F=[];if(g.cells!==void 0){let X=g.cells;if(X.structure!==void 0){let D=X.structure.array;if(c.cells.splice(D.start,D.deleteCount,...D.cells!==void 0?D.cells:[]),X.structure.didOpen!==void 0)for(let x of X.structure.didOpen)n.openTextDocument({textDocument:x}),b.push(x.uri);if(X.structure.didClose)for(let x of X.structure.didClose)n.closeTextDocument({textDocument:x}),y.push(x.uri)}if(X.data!==void 0){let D=new Map(X.data.map(x=>[x.document,x]));for(let x=0;x<=c.cells.length;x++){let O=D.get(c.cells[x].document);if(O!==void 0){let te=c.cells.splice(x,1,O);if(T.push({old:te[0],new:O}),D.delete(O.document),D.size===0)break}}}if(X.textContent!==void 0)for(let D of X.textContent)n.changeTextDocument({textDocument:D.document,contentChanges:D.changes}),F.push(D.document.uri)}this.updateCellMap(c);let E={notebookDocument:c};h&&(E.metadata={old:u,new:c.metadata});let L=[];for(let X of b)L.push(this.getNotebookCell(X));let B=[];for(let X of y)B.push(this.getNotebookCell(X));let $=[];for(let X of F)$.push(this.getNotebookCell(X));(L.length>0||B.length>0||T.length>0||$.length>0)&&(E.cells={added:L,removed:B,changed:{data:T,textContent:$}}),(E.metadata!==void 0||E.cells!==void 0)&&this._onDidChange.fire(E)})),i.push(e.notebooks.synchronization.onDidSaveNotebookDocument(s=>{let c=this.notebookDocuments.get(s.notebookDocument.uri);c!==void 0&&this._onDidSave.fire(c)})),i.push(e.notebooks.synchronization.onDidCloseNotebookDocument(s=>{let c=this.notebookDocuments.get(s.notebookDocument.uri);if(c!==void 0){this._onDidClose.fire(c);for(let u of s.cellTextDocuments)n.closeTextDocument({textDocument:u});this.notebookDocuments.delete(s.notebookDocument.uri);for(let u of c.cells)this.notebookCellMap.delete(u.document)}})),Un.Disposable.create(()=>{i.forEach(s=>s.dispose())})}updateCellMap(e){for(let n of e.cells)this.notebookCellMap.set(n.document,[n,e])}};wo.NotebookDocuments=th});var Gy=re($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});$c.MonikerFeature=void 0;var kE=Ct(),RE=t=>class extends t{get moniker(){return{on:e=>{let n=kE.MonikerRequest.type;return this.connection.onRequest(n,(i,s)=>e(i,s,this.attachWorkDoneProgress(i),this.attachPartialResultProgress(n,i)))}}}};$c.MonikerFeature=RE});var ch=re($e=>{"use strict";Object.defineProperty($e,"__esModule",{value:!0});$e.createConnection=$e.combineFeatures=$e.combineNotebooksFeatures=$e.combineLanguagesFeatures=$e.combineWorkspaceFeatures=$e.combineWindowFeatures=$e.combineClientFeatures=$e.combineTracerFeatures=$e.combineTelemetryFeatures=$e.combineConsoleFeatures=$e._NotebooksImpl=$e._LanguagesImpl=$e.BulkUnregistration=$e.BulkRegistration=$e.ErrorMessageTracker=void 0;var ee=Ct(),$n=qa(),ih=Hf(),ye=Fy(),TE=My(),DE=Ay(),IE=Ny(),EE=Xf(),FE=qy(),ME=Ly(),AE=Oy(),NE=By(),qE=$y(),LE=jy(),OE=zy(),BE=Hy(),UE=nh(),$E=Gy();function rh(t){if(t!==null)return t}var oh=class{constructor(){this._messages=Object.create(null)}add(e){let n=this._messages[e];n||(n=0),n++,this._messages[e]=n}sendErrors(e){Object.keys(this._messages).forEach(n=>{e.window.showErrorMessage(n)})}};$e.ErrorMessageTracker=oh;var Wc=class{constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(ee.MessageType.Error,e)}warn(e){this.send(ee.MessageType.Warning,e)}info(e){this.send(ee.MessageType.Info,e)}log(e){this.send(ee.MessageType.Log,e)}debug(e){this.send(ee.MessageType.Debug,e)}send(e,n){this._rawConnection&&this._rawConnection.sendNotification(ee.LogMessageNotification.type,{type:e,message:n}).catch(()=>{(0,ee.RAL)().console.error("Sending log message failed")})}},sh=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...n){let i={type:ee.MessageType.Error,message:e,actions:n};return this.connection.sendRequest(ee.ShowMessageRequest.type,i).then(rh)}showWarningMessage(e,...n){let i={type:ee.MessageType.Warning,message:e,actions:n};return this.connection.sendRequest(ee.ShowMessageRequest.type,i).then(rh)}showInformationMessage(e,...n){let i={type:ee.MessageType.Info,message:e,actions:n};return this.connection.sendRequest(ee.ShowMessageRequest.type,i).then(rh)}},Qy=(0,FE.ShowDocumentFeature)((0,ye.ProgressFeature)(sh)),Jy;(function(t){function e(){return new jc}t.create=e})(Jy||($e.BulkRegistration=Jy={}));var jc=class{constructor(){this._registrations=[],this._registered=new Set}add(e,n){let i=$n.string(e)?e:e.method;if(this._registered.has(i))throw new Error(`${i} is already added to this registration`);let s=ih.generateUuid();this._registrations.push({id:s,method:i,registerOptions:n||{}}),this._registered.add(i)}asRegistrationParams(){return{registrations:this._registrations}}},Xy;(function(t){function e(){return new bs(void 0,[])}t.create=e})(Xy||($e.BulkUnregistration=Xy={}));var bs=class{constructor(e,n){this._connection=e,this._unregistrations=new Map,n.forEach(i=>{this._unregistrations.set(i.method,i)})}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let i of this._unregistrations.values())e.push(i);let n={unregisterations:e};this._connection.sendRequest(ee.UnregistrationRequest.type,n).catch(()=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(e){let n=$n.string(e)?e:e.method,i=this._unregistrations.get(n);if(!i)return!1;let s={unregisterations:[i]};return this._connection.sendRequest(ee.UnregistrationRequest.type,s).then(()=>{this._unregistrations.delete(n)},c=>{this._connection.console.info(`Un-registering request handler for ${i.id} failed.`)}),!0}},zc=class{attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,n,i){return e instanceof jc?this.registerMany(e):e instanceof bs?this.registerSingle1(e,n,i):this.registerSingle2(e,n)}registerSingle1(e,n,i){let s=$n.string(n)?n:n.method,c=ih.generateUuid(),u={registrations:[{id:c,method:s,registerOptions:i||{}}]};return e.isAttached||e.attach(this.connection),this.connection.sendRequest(ee.RegistrationRequest.type,u).then(h=>(e.add({id:c,method:s}),e),h=>(this.connection.console.info(`Registering request handler for ${s} failed.`),Promise.reject(h)))}registerSingle2(e,n){let i=$n.string(e)?e:e.method,s=ih.generateUuid(),c={registrations:[{id:s,method:i,registerOptions:n||{}}]};return this.connection.sendRequest(ee.RegistrationRequest.type,c).then(u=>ee.Disposable.create(()=>{this.unregisterSingle(s,i).catch(()=>{this.connection.console.info(`Un-registering capability with id ${s} failed.`)})}),u=>(this.connection.console.info(`Registering request handler for ${i} failed.`),Promise.reject(u)))}unregisterSingle(e,n){let i={unregisterations:[{id:e,method:n}]};return this.connection.sendRequest(ee.UnregistrationRequest.type,i).catch(()=>{this.connection.console.info(`Un-registering request handler for ${e} failed.`)})}registerMany(e){let n=e.asRegistrationParams();return this.connection.sendRequest(ee.RegistrationRequest.type,n).then(()=>new bs(this._connection,n.registrations.map(i=>({id:i.id,method:i.method}))),i=>(this.connection.console.info("Bulk registration failed."),Promise.reject(i)))}},ah=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){function n(s){return s&&!!s.edit}let i=n(e)?e:{edit:e};return this.connection.sendRequest(ee.ApplyWorkspaceEditRequest.type,i)}},Yy=(0,ME.FileOperationsFeature)((0,DE.WorkspaceFoldersFeature)((0,TE.ConfigurationFeature)(ah))),Hc=class{constructor(){this._trace=ee.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,n){this._trace!==ee.Trace.Off&&this.connection.sendNotification(ee.LogTraceNotification.type,{message:e,verbose:this._trace===ee.Trace.Verbose?n:void 0}).catch(()=>{})}},Vc=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this.connection.sendNotification(ee.TelemetryEventNotification.type,e).catch(()=>{this.connection.console.log("Sending TelemetryEventNotification failed")})}},Gc=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,ye.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,n){return(0,ye.attachPartialResult)(this.connection,n)}};$e._LanguagesImpl=Gc;var Ky=(0,LE.FoldingRangeFeature)((0,$E.MonikerFeature)((0,BE.DiagnosticFeature)((0,OE.InlayHintFeature)((0,qE.InlineValueFeature)((0,NE.TypeHierarchyFeature)((0,AE.LinkedEditingRangeFeature)((0,EE.SemanticTokensFeature)((0,IE.CallHierarchyFeature)(Gc))))))))),Qc=class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,ye.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,n){return(0,ye.attachPartialResult)(this.connection,n)}};$e._NotebooksImpl=Qc;var Zy=(0,UE.NotebookSyncFeature)(Qc);function ew(t,e){return function(n){return e(t(n))}}$e.combineConsoleFeatures=ew;function tw(t,e){return function(n){return e(t(n))}}$e.combineTelemetryFeatures=tw;function nw(t,e){return function(n){return e(t(n))}}$e.combineTracerFeatures=nw;function rw(t,e){return function(n){return e(t(n))}}$e.combineClientFeatures=rw;function iw(t,e){return function(n){return e(t(n))}}$e.combineWindowFeatures=iw;function ow(t,e){return function(n){return e(t(n))}}$e.combineWorkspaceFeatures=ow;function sw(t,e){return function(n){return e(t(n))}}$e.combineLanguagesFeatures=sw;function aw(t,e){return function(n){return e(t(n))}}$e.combineNotebooksFeatures=aw;function WE(t,e){function n(s,c,u){return s&&c?u(s,c):s||c}return{__brand:"features",console:n(t.console,e.console,ew),tracer:n(t.tracer,e.tracer,nw),telemetry:n(t.telemetry,e.telemetry,tw),client:n(t.client,e.client,rw),window:n(t.window,e.window,iw),workspace:n(t.workspace,e.workspace,ow),languages:n(t.languages,e.languages,sw),notebooks:n(t.notebooks,e.notebooks,aw)}}$e.combineFeatures=WE;function jE(t,e,n){let i=n&&n.console?new(n.console(Wc)):new Wc,s=t(i);i.rawAttach(s);let c=n&&n.tracer?new(n.tracer(Hc)):new Hc,u=n&&n.telemetry?new(n.telemetry(Vc)):new Vc,h=n&&n.client?new(n.client(zc)):new zc,g=n&&n.window?new(n.window(Qy)):new Qy,b=n&&n.workspace?new(n.workspace(Yy)):new Yy,y=n&&n.languages?new(n.languages(Ky)):new Ky,T=n&&n.notebooks?new(n.notebooks(Zy)):new Zy,F=[i,c,u,h,g,b,y,T];function E(D){return D instanceof Promise?D:$n.thenable(D)?new Promise((x,O)=>{D.then(te=>x(te),te=>O(te))}):Promise.resolve(D)}let L,B,$,X={listen:()=>s.listen(),sendRequest:(D,...x)=>s.sendRequest($n.string(D)?D:D.method,...x),onRequest:(D,x)=>s.onRequest(D,x),sendNotification:(D,x)=>{let O=$n.string(D)?D:D.method;return s.sendNotification(O,x)},onNotification:(D,x)=>s.onNotification(D,x),onProgress:s.onProgress,sendProgress:s.sendProgress,onInitialize:D=>(B=D,{dispose:()=>{B=void 0}}),onInitialized:D=>s.onNotification(ee.InitializedNotification.type,D),onShutdown:D=>(L=D,{dispose:()=>{L=void 0}}),onExit:D=>($=D,{dispose:()=>{$=void 0}}),get console(){return i},get telemetry(){return u},get tracer(){return c},get client(){return h},get window(){return g},get workspace(){return b},get languages(){return y},get notebooks(){return T},onDidChangeConfiguration:D=>s.onNotification(ee.DidChangeConfigurationNotification.type,D),onDidChangeWatchedFiles:D=>s.onNotification(ee.DidChangeWatchedFilesNotification.type,D),__textDocumentSync:void 0,onDidOpenTextDocument:D=>s.onNotification(ee.DidOpenTextDocumentNotification.type,D),onDidChangeTextDocument:D=>s.onNotification(ee.DidChangeTextDocumentNotification.type,D),onDidCloseTextDocument:D=>s.onNotification(ee.DidCloseTextDocumentNotification.type,D),onWillSaveTextDocument:D=>s.onNotification(ee.WillSaveTextDocumentNotification.type,D),onWillSaveTextDocumentWaitUntil:D=>s.onRequest(ee.WillSaveTextDocumentWaitUntilRequest.type,D),onDidSaveTextDocument:D=>s.onNotification(ee.DidSaveTextDocumentNotification.type,D),sendDiagnostics:D=>s.sendNotification(ee.PublishDiagnosticsNotification.type,D),onHover:D=>s.onRequest(ee.HoverRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),void 0)),onCompletion:D=>s.onRequest(ee.CompletionRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onCompletionResolve:D=>s.onRequest(ee.CompletionResolveRequest.type,D),onSignatureHelp:D=>s.onRequest(ee.SignatureHelpRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),void 0)),onDeclaration:D=>s.onRequest(ee.DeclarationRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onDefinition:D=>s.onRequest(ee.DefinitionRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onTypeDefinition:D=>s.onRequest(ee.TypeDefinitionRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onImplementation:D=>s.onRequest(ee.ImplementationRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onReferences:D=>s.onRequest(ee.ReferencesRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onDocumentHighlight:D=>s.onRequest(ee.DocumentHighlightRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onDocumentSymbol:D=>s.onRequest(ee.DocumentSymbolRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onWorkspaceSymbol:D=>s.onRequest(ee.WorkspaceSymbolRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onWorkspaceSymbolResolve:D=>s.onRequest(ee.WorkspaceSymbolResolveRequest.type,D),onCodeAction:D=>s.onRequest(ee.CodeActionRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onCodeActionResolve:D=>s.onRequest(ee.CodeActionResolveRequest.type,(x,O)=>D(x,O)),onCodeLens:D=>s.onRequest(ee.CodeLensRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onCodeLensResolve:D=>s.onRequest(ee.CodeLensResolveRequest.type,(x,O)=>D(x,O)),onDocumentFormatting:D=>s.onRequest(ee.DocumentFormattingRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),void 0)),onDocumentRangeFormatting:D=>s.onRequest(ee.DocumentRangeFormattingRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),void 0)),onDocumentOnTypeFormatting:D=>s.onRequest(ee.DocumentOnTypeFormattingRequest.type,(x,O)=>D(x,O)),onRenameRequest:D=>s.onRequest(ee.RenameRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),void 0)),onPrepareRename:D=>s.onRequest(ee.PrepareRenameRequest.type,(x,O)=>D(x,O)),onDocumentLinks:D=>s.onRequest(ee.DocumentLinkRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onDocumentLinkResolve:D=>s.onRequest(ee.DocumentLinkResolveRequest.type,(x,O)=>D(x,O)),onDocumentColor:D=>s.onRequest(ee.DocumentColorRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onColorPresentation:D=>s.onRequest(ee.ColorPresentationRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onFoldingRanges:D=>s.onRequest(ee.FoldingRangeRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onSelectionRanges:D=>s.onRequest(ee.SelectionRangeRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),(0,ye.attachPartialResult)(s,x))),onExecuteCommand:D=>s.onRequest(ee.ExecuteCommandRequest.type,(x,O)=>D(x,O,(0,ye.attachWorkDone)(s,x),void 0)),dispose:()=>s.dispose()};for(let D of F)D.attach(X);return s.onRequest(ee.InitializeRequest.type,D=>{e.initialize(D),$n.string(D.trace)&&(c.trace=ee.Trace.fromString(D.trace));for(let x of F)x.initialize(D.capabilities);if(B){let x=B(D,new ee.CancellationTokenSource().token,(0,ye.attachWorkDone)(s,D),void 0);return E(x).then(O=>{if(O instanceof ee.ResponseError)return O;let te=O;te||(te={capabilities:{}});let _e=te.capabilities;_e||(_e={},te.capabilities=_e),_e.textDocumentSync===void 0||_e.textDocumentSync===null?_e.textDocumentSync=$n.number(X.__textDocumentSync)?X.__textDocumentSync:ee.TextDocumentSyncKind.None:!$n.number(_e.textDocumentSync)&&!$n.number(_e.textDocumentSync.change)&&(_e.textDocumentSync.change=$n.number(X.__textDocumentSync)?X.__textDocumentSync:ee.TextDocumentSyncKind.None);for(let Be of F)Be.fillServerCapabilities(_e);return te})}else{let x={capabilities:{textDocumentSync:ee.TextDocumentSyncKind.None}};for(let O of F)O.fillServerCapabilities(x.capabilities);return x}}),s.onRequest(ee.ShutdownRequest.type,()=>{if(e.shutdownReceived=!0,L)return L(new ee.CancellationTokenSource().token)}),s.onNotification(ee.ExitNotification.type,()=>{try{$&&$()}finally{e.shutdownReceived?e.exit(0):e.exit(1)}}),s.onNotification(ee.SetTraceNotification.type,D=>{c.trace=ee.Trace.fromString(D.value)}),X}$e.createConnection=jE});var cw=re(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.resolveModulePath=hn.FileSystem=hn.resolveGlobalYarnPath=hn.resolveGlobalNodePath=hn.resolve=hn.uriToFilePath=void 0;var zE=require("url"),Zn=require("path"),uh=require("fs"),hh=require("child_process");function HE(t){let e=zE.parse(t);if(e.protocol!=="file:"||!e.path)return;let n=e.path.split("/");for(var i=0,s=n.length;i<s;i++)n[i]=decodeURIComponent(n[i]);if(process.platform==="win32"&&n.length>1){let c=n[0],u=n[1];c.length===0&&u.length>1&&u[1]===":"&&n.shift()}return Zn.normalize(n.join("/"))}hn.uriToFilePath=HE;function lh(){return process.platform==="win32"}function Jc(t,e,n,i){let s="NODE_PATH",c=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise((u,h)=>{let g=process.env,b=Object.create(null);Object.keys(g).forEach(y=>b[y]=g[y]),e&&uh.existsSync(e)&&(b[s]?b[s]=e+Zn.delimiter+b[s]:b[s]=e,i&&i(`NODE_PATH value is: ${b[s]}`)),b.ELECTRON_RUN_AS_NODE="1";try{let y=(0,hh.fork)("",[],{cwd:n,env:b,execArgv:["-e",c]});if(y.pid===void 0){h(new Error(`Starting process to resolve node module  ${t} failed`));return}y.on("error",F=>{h(F)}),y.on("message",F=>{F.c==="r"&&(y.send({c:"e"}),F.s?u(F.r):h(new Error(`Failed to resolve module: ${t}`)))});let T={c:"rs",a:t};y.send(T)}catch(y){h(y)}})}hn.resolve=Jc;function dh(t){let e="npm",n=Object.create(null);Object.keys(process.env).forEach(c=>n[c]=process.env[c]),n.NO_UPDATE_NOTIFIER="true";let i={encoding:"utf8",env:n};lh()&&(e="npm.cmd",i.shell=!0);let s=()=>{};try{process.on("SIGPIPE",s);let c=(0,hh.spawnSync)(e,["config","get","prefix"],i).stdout;if(!c){t&&t("'npm config get prefix' didn't return a value.");return}let u=c.trim();return t&&t(`'npm config get prefix' value is: ${u}`),u.length>0?lh()?Zn.join(u,"node_modules"):Zn.join(u,"lib","node_modules"):void 0}catch{return}finally{process.removeListener("SIGPIPE",s)}}hn.resolveGlobalNodePath=dh;function VE(t){let e="yarn",n={encoding:"utf8"};lh()&&(e="yarn.cmd",n.shell=!0);let i=()=>{};try{process.on("SIGPIPE",i);let s=(0,hh.spawnSync)(e,["global","dir","--json"],n),c=s.stdout;if(!c){t&&(t("'yarn global dir' didn't return a value."),s.stderr&&t(s.stderr));return}let u=c.trim().split(/\r?\n/);for(let h of u)try{let g=JSON.parse(h);if(g.type==="log")return Zn.join(g.data,"node_modules")}catch{}return}catch{return}finally{process.removeListener("SIGPIPE",i)}}hn.resolveGlobalYarnPath=VE;var fh;(function(t){let e;function n(){return e!==void 0||(process.platform==="win32"?e=!1:e=!uh.existsSync(__filename.toUpperCase())||!uh.existsSync(__filename.toLowerCase())),e}t.isCaseSensitive=n;function i(s,c){return n()?Zn.normalize(c).indexOf(Zn.normalize(s))===0:Zn.normalize(c).toLowerCase().indexOf(Zn.normalize(s).toLowerCase())===0}t.isParent=i})(fh||(hn.FileSystem=fh={}));function GE(t,e,n,i){return n?(Zn.isAbsolute(n)||(n=Zn.join(t,n)),Jc(e,n,n,i).then(s=>fh.isParent(n,s)?s:Promise.reject(new Error(`Failed to load ${e} from node path location.`))).then(void 0,s=>Jc(e,dh(i),t,i))):Jc(e,dh(i),t,i)}hn.resolveModulePath=GE});var gh=re((NA,uw)=>{"use strict";uw.exports=Ct()});var lw=re(Xc=>{"use strict";Object.defineProperty(Xc,"__esModule",{value:!0});Xc.InlineCompletionFeature=void 0;var QE=Ct(),JE=t=>class extends t{get inlineCompletion(){return{on:e=>this.connection.onRequest(QE.InlineCompletionRequest.type,(n,i)=>e(n,i,this.attachWorkDoneProgress(n)))}}};Xc.InlineCompletionFeature=JE});var hw=re(Gt=>{"use strict";var XE=Gt&&Gt.__createBinding||(Object.create?function(t,e,n,i){i===void 0&&(i=n);var s=Object.getOwnPropertyDescriptor(e,n);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,s)}:function(t,e,n,i){i===void 0&&(i=n),t[i]=e[n]}),fw=Gt&&Gt.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&XE(e,t,n)};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.ProposedFeatures=Gt.NotebookDocuments=Gt.TextDocuments=Gt.SemanticTokensBuilder=void 0;var YE=Xf();Object.defineProperty(Gt,"SemanticTokensBuilder",{enumerable:!0,get:function(){return YE.SemanticTokensBuilder}});var KE=lw();fw(Ct(),Gt);var ZE=eh();Object.defineProperty(Gt,"TextDocuments",{enumerable:!0,get:function(){return ZE.TextDocuments}});var eF=nh();Object.defineProperty(Gt,"NotebookDocuments",{enumerable:!0,get:function(){return eF.NotebookDocuments}});fw(ch(),Gt);var dw;(function(t){t.all={__brand:"features",languages:KE.InlineCompletionFeature}})(dw||(Gt.ProposedFeatures=dw={}))});var vw=re(Wn=>{"use strict";var tF=Wn&&Wn.__createBinding||(Object.create?function(t,e,n,i){i===void 0&&(i=n);var s=Object.getOwnPropertyDescriptor(e,n);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,s)}:function(t,e,n,i){i===void 0&&(i=n),t[i]=e[n]}),bw=Wn&&Wn.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&tF(e,t,n)};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.createConnection=Wn.Files=void 0;var gw=require("node:util"),ph=qa(),nF=ch(),_s=cw(),Mi=gh();bw(gh(),Wn);bw(hw(),Wn);var pw;(function(t){t.uriToFilePath=_s.uriToFilePath,t.resolveGlobalNodePath=_s.resolveGlobalNodePath,t.resolveGlobalYarnPath=_s.resolveGlobalYarnPath,t.resolve=_s.resolve,t.resolveModulePath=_s.resolveModulePath})(pw||(Wn.Files=pw={}));var mw;function Yc(){if(mw!==void 0)try{mw.end()}catch{}}var Po=!1,_w;function rF(){let t="--clientProcessId";function e(n){try{let i=parseInt(n);isNaN(i)||(_w=setInterval(()=>{try{process.kill(i,0)}catch{Yc(),process.exit(Po?0:1)}},3e3))}catch{}}for(let n=2;n<process.argv.length;n++){let i=process.argv[n];if(i===t&&n+1<process.argv.length){e(process.argv[n+1]);return}else{let s=i.split("=");s[0]===t&&e(s[1])}}}rF();var iF={initialize:t=>{let e=t.processId;ph.number(e)&&_w===void 0&&setInterval(()=>{try{process.kill(e,0)}catch{process.exit(Po?0:1)}},3e3)},get shutdownReceived(){return Po},set shutdownReceived(t){Po=t},exit:t=>{Yc(),process.exit(t)}};function oF(t,e,n,i){let s,c,u,h;return t!==void 0&&t.__brand==="features"&&(s=t,t=e,e=n,n=i),Mi.ConnectionStrategy.is(t)||Mi.ConnectionOptions.is(t)?h=t:(c=t,u=e,h=n),sF(c,u,h,s)}Wn.createConnection=oF;function sF(t,e,n,i){let s=!1;if(!t&&!e&&process.argv.length>2){let g,b,y=process.argv.slice(2);for(let T=0;T<y.length;T++){let F=y[T];if(F==="--node-ipc"){t=new Mi.IPCMessageReader(process),e=new Mi.IPCMessageWriter(process);break}else if(F==="--stdio"){s=!0,t=process.stdin,e=process.stdout;break}else if(F==="--socket"){g=parseInt(y[T+1]);break}else if(F==="--pipe"){b=y[T+1];break}else{var c=F.split("=");if(c[0]==="--socket"){g=parseInt(c[1]);break}else if(c[0]==="--pipe"){b=c[1];break}}}if(g){let T=(0,Mi.createServerSocketTransport)(g);t=T[0],e=T[1]}else if(b){let T=(0,Mi.createServerPipeTransport)(b);t=T[0],e=T[1]}}var u="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!t)throw new Error("Connection input stream is not set. "+u);if(!e)throw new Error("Connection output stream is not set. "+u);if(ph.func(t.read)&&ph.func(t.on)){let g=t;g.on("end",()=>{Yc(),process.exit(Po?0:1)}),g.on("close",()=>{Yc(),process.exit(Po?0:1)})}let h=g=>{let b=(0,Mi.createProtocolConnection)(t,e,g,n);return s&&aF(g),b};return(0,nF.createConnection)(h,iF,i)}function aF(t){function e(i){return i.map(s=>typeof s=="string"?s:(0,gw.inspect)(s)).join(" ")}let n=new Map;console.assert=function(s,...c){if(!s)if(c.length===0)t.error("Assertion failed");else{let[u,...h]=c;t.error(`Assertion failed: ${u} ${e(h)}`)}},console.count=function(s="default"){let c=String(s),u=n.get(c)??0;u+=1,n.set(c,u),t.log(`${c}: ${c}`)},console.countReset=function(s){s===void 0?n.clear():n.delete(String(s))},console.debug=function(...s){t.log(e(s))},console.dir=function(s,c){t.log((0,gw.inspect)(s,c))},console.log=function(...s){t.log(e(s))},console.error=function(...s){t.error(e(s))},console.trace=function(...s){let c=new Error().stack.replace(/(.+\n){2}/,""),u="Trace";s.length!==0&&(u+=`: ${e(s)}`),t.log(`${u}
${c}`)},console.warn=function(...s){t.warn(e(s))}}});var ww=re((UA,yw)=>{"use strict";yw.exports=vw()});var Rw=re((kw,tu)=>{"use strict";(function(t,e){"use strict";typeof define=="function"&&define.amd?define(e):typeof tu=="object"&&tu.exports?tu.exports=e():t.log=e()})(kw,function(){"use strict";var t=function(){},e="undefined",n=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],s={},c=null;function u(L,B){var $=L[B];if(typeof $.bind=="function")return $.bind(L);try{return Function.prototype.bind.call($,L)}catch{return function(){return Function.prototype.apply.apply($,[L,arguments])}}}function h(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function g(L){return L==="debug"&&(L="log"),typeof console===e?!1:L==="trace"&&n?h:console[L]!==void 0?u(console,L):console.log!==void 0?u(console,"log"):t}function b(){for(var L=this.getLevel(),B=0;B<i.length;B++){var $=i[B];this[$]=B<L?t:this.methodFactory($,L,this.name)}if(this.log=this.debug,typeof console===e&&L<this.levels.SILENT)return"No console available for logging"}function y(L){return function(){typeof console!==e&&(b.call(this),this[L].apply(this,arguments))}}function T(L,B,$){return g(L)||y.apply(this,arguments)}function F(L,B){var $=this,X,D,x,O="loglevel";typeof L=="string"?O+=":"+L:typeof L=="symbol"&&(O=void 0);function te(we){var Y=(i[we]||"silent").toUpperCase();if(!(typeof window===e||!O)){try{window.localStorage[O]=Y;return}catch{}try{window.document.cookie=encodeURIComponent(O)+"="+Y+";"}catch{}}}function _e(){var we;if(!(typeof window===e||!O)){try{we=window.localStorage[O]}catch{}if(typeof we===e)try{var Y=window.document.cookie,z=encodeURIComponent(O),ae=Y.indexOf(z+"=");ae!==-1&&(we=/^([^;]+)/.exec(Y.slice(ae+z.length+1))[1])}catch{}return $.levels[we]===void 0&&(we=void 0),we}}function Be(){if(!(typeof window===e||!O)){try{window.localStorage.removeItem(O)}catch{}try{window.document.cookie=encodeURIComponent(O)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function Ye(we){var Y=we;if(typeof Y=="string"&&$.levels[Y.toUpperCase()]!==void 0&&(Y=$.levels[Y.toUpperCase()]),typeof Y=="number"&&Y>=0&&Y<=$.levels.SILENT)return Y;throw new TypeError("log.setLevel() called with invalid level: "+we)}$.name=L,$.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},$.methodFactory=B||T,$.getLevel=function(){return x??D??X},$.setLevel=function(we,Y){return x=Ye(we),Y!==!1&&te(x),b.call($)},$.setDefaultLevel=function(we){D=Ye(we),_e()||$.setLevel(we,!1)},$.resetLevel=function(){x=null,Be(),b.call($)},$.enableAll=function(we){$.setLevel($.levels.TRACE,we)},$.disableAll=function(we){$.setLevel($.levels.SILENT,we)},$.rebuild=function(){if(c!==$&&(X=Ye(c.getLevel())),b.call($),c===$)for(var we in s)s[we].rebuild()},X=Ye(c?c.getLevel():"WARN");var kt=_e();kt!=null&&(x=Ye(kt)),b.call($)}c=new F,c.getLogger=function(B){if(typeof B!="symbol"&&typeof B!="string"||B==="")throw new TypeError("You must supply a name when creating a logger.");var $=s[B];return $||($=s[B]=new F(B,c.methodFactory)),$};var E=typeof window!==e?window.log:void 0;return c.noConflict=function(){return typeof window!==e&&window.log===c&&(window.log=E),c},c.getLoggers=function(){return s},c.default=c,c})});var bu=re((Fo,Rs)=>{"use strict";(function(){var t,e="4.17.21",n=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",s="Expected a function",c="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",h=500,g="__lodash_placeholder__",b=1,y=2,T=4,F=1,E=2,L=1,B=2,$=4,X=8,D=16,x=32,O=64,te=128,_e=256,Be=512,Ye=30,kt="...",we=800,Y=16,z=1,ae=2,ie=3,ke=1/0,ge=9007199254740991,pe=17976931348623157e292,wt=NaN,We=4294967295,je=We-1,pn=We>>>1,_r=[["ary",te],["bind",L],["bindKey",B],["curry",X],["curryRight",D],["flip",Be],["partial",x],["partialRight",O],["rearg",_e]],zn="[object Arguments]",sr="[object Array]",gi="[object AsyncFunction]",ar="[object Boolean]",cr="[object Date]",qi="[object DOMException]",vr="[object Error]",yr="[object Function]",wr="[object GeneratorFunction]",gt="[object Map]",ur="[object Number]",Li="[object Null]",Lt="[object Object]",pi="[object Promise]",Br="[object Proxy]",lr="[object RegExp]",Pt="[object Set]",nn="[object String]",Pr="[object Symbol]",Oi="[object Undefined]",$t="[object WeakMap]",mi="[object WeakSet]",Hn="[object ArrayBuffer]",mn="[object DataView]",xr="[object Float32Array]",bn="[object Float64Array]",S="[object Int8Array]",H="[object Int16Array]",Z="[object Int32Array]",oe="[object Uint8Array]",Ue="[object Uint8ClampedArray]",Le="[object Uint16Array]",Qe="[object Uint32Array]",et=/\b__p \+= '';/g,Re=/\b(__p \+=) '' \+/g,Je=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ae=/&(?:amp|lt|gt|quot|#39);/g,it=/[&<>"']/g,Rt=RegExp(Ae.source),Xt=RegExp(it.source),Bi=/<%-([\s\S]+?)%>/g,$s=/<%([\s\S]+?)%>/g,Wo=/<%=([\s\S]+?)%>/g,Ws=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,js=/^\w*$/,ol=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,A=/[\\^$.*+?()[\]{}|]/g,p=RegExp(A.source),C=/^\s+/,R=/\s/,v=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,f=/\{\n\/\* \[wrapped with (.+)\] \*/,N=/,? & /,G=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,me=/[()=,{}\[\]\/\s]/,lt=/\\(\\)?/g,Ke=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,rn=/\w*$/,_n=/^[-+]0x[0-9a-f]+$/i,Vn=/^0b[01]+$/i,Ie=/^\[object .+?Constructor\]$/,Ur=/^0o[0-7]+$/i,Ui=/^(?:0|[1-9]\d*)$/,zs=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Hs=/($^)/,Ex=/['\n\r\u2028\u2029\\]/g,Vs="\\ud800-\\udfff",Fx="\\u0300-\\u036f",Mx="\\ufe20-\\ufe2f",Ax="\\u20d0-\\u20ff",xg=Fx+Mx+Ax,Sg="\\u2700-\\u27bf",Cg="a-z\\xdf-\\xf6\\xf8-\\xff",Nx="\\xac\\xb1\\xd7\\xf7",qx="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Lx="\\u2000-\\u206f",Ox=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",kg="A-Z\\xc0-\\xd6\\xd8-\\xde",Rg="\\ufe0e\\ufe0f",Tg=Nx+qx+Lx+Ox,sl="['\u2019]",Bx="["+Vs+"]",Dg="["+Tg+"]",Gs="["+xg+"]",Ig="\\d+",Ux="["+Sg+"]",Eg="["+Cg+"]",Fg="[^"+Vs+Tg+Ig+Sg+Cg+kg+"]",al="\\ud83c[\\udffb-\\udfff]",$x="(?:"+Gs+"|"+al+")",Mg="[^"+Vs+"]",cl="(?:\\ud83c[\\udde6-\\uddff]){2}",ul="[\\ud800-\\udbff][\\udc00-\\udfff]",$i="["+kg+"]",Ag="\\u200d",Ng="(?:"+Eg+"|"+Fg+")",Wx="(?:"+$i+"|"+Fg+")",qg="(?:"+sl+"(?:d|ll|m|re|s|t|ve))?",Lg="(?:"+sl+"(?:D|LL|M|RE|S|T|VE))?",Og=$x+"?",Bg="["+Rg+"]?",jx="(?:"+Ag+"(?:"+[Mg,cl,ul].join("|")+")"+Bg+Og+")*",zx="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Hx="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ug=Bg+Og+jx,Vx="(?:"+[Ux,cl,ul].join("|")+")"+Ug,Gx="(?:"+[Mg+Gs+"?",Gs,cl,ul,Bx].join("|")+")",Qx=RegExp(sl,"g"),Jx=RegExp(Gs,"g"),ll=RegExp(al+"(?="+al+")|"+Gx+Ug,"g"),Xx=RegExp([$i+"?"+Eg+"+"+qg+"(?="+[Dg,$i,"$"].join("|")+")",Wx+"+"+Lg+"(?="+[Dg,$i+Ng,"$"].join("|")+")",$i+"?"+Ng+"+"+qg,$i+"+"+Lg,Hx,zx,Ig,Vx].join("|"),"g"),Yx=RegExp("["+Ag+Vs+xg+Rg+"]"),Kx=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Zx=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],eS=-1,ot={};ot[xr]=ot[bn]=ot[S]=ot[H]=ot[Z]=ot[oe]=ot[Ue]=ot[Le]=ot[Qe]=!0,ot[zn]=ot[sr]=ot[Hn]=ot[ar]=ot[mn]=ot[cr]=ot[vr]=ot[yr]=ot[gt]=ot[ur]=ot[Lt]=ot[lr]=ot[Pt]=ot[nn]=ot[$t]=!1;var tt={};tt[zn]=tt[sr]=tt[Hn]=tt[mn]=tt[ar]=tt[cr]=tt[xr]=tt[bn]=tt[S]=tt[H]=tt[Z]=tt[gt]=tt[ur]=tt[Lt]=tt[lr]=tt[Pt]=tt[nn]=tt[Pr]=tt[oe]=tt[Ue]=tt[Le]=tt[Qe]=!0,tt[vr]=tt[yr]=tt[$t]=!1;var tS={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},nS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},rS={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},iS={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},oS=parseFloat,sS=parseInt,$g=typeof global=="object"&&global&&global.Object===Object&&global,aS=typeof self=="object"&&self&&self.Object===Object&&self,At=$g||aS||Function("return this")(),dl=typeof Fo=="object"&&Fo&&!Fo.nodeType&&Fo,bi=dl&&typeof Rs=="object"&&Rs&&!Rs.nodeType&&Rs,Wg=bi&&bi.exports===dl,fl=Wg&&$g.process,Dn=function(){try{var I=bi&&bi.require&&bi.require("util").types;return I||fl&&fl.binding&&fl.binding("util")}catch{}}(),jg=Dn&&Dn.isArrayBuffer,zg=Dn&&Dn.isDate,Hg=Dn&&Dn.isMap,Vg=Dn&&Dn.isRegExp,Gg=Dn&&Dn.isSet,Qg=Dn&&Dn.isTypedArray;function vn(I,W,U){switch(U.length){case 0:return I.call(W);case 1:return I.call(W,U[0]);case 2:return I.call(W,U[0],U[1]);case 3:return I.call(W,U[0],U[1],U[2])}return I.apply(W,U)}function cS(I,W,U,se){for(var ve=-1,ze=I==null?0:I.length;++ve<ze;){var Et=I[ve];W(se,Et,U(Et),I)}return se}function In(I,W){for(var U=-1,se=I==null?0:I.length;++U<se&&W(I[U],U,I)!==!1;);return I}function uS(I,W){for(var U=I==null?0:I.length;U--&&W(I[U],U,I)!==!1;);return I}function Jg(I,W){for(var U=-1,se=I==null?0:I.length;++U<se;)if(!W(I[U],U,I))return!1;return!0}function $r(I,W){for(var U=-1,se=I==null?0:I.length,ve=0,ze=[];++U<se;){var Et=I[U];W(Et,U,I)&&(ze[ve++]=Et)}return ze}function Qs(I,W){var U=I==null?0:I.length;return!!U&&Wi(I,W,0)>-1}function hl(I,W,U){for(var se=-1,ve=I==null?0:I.length;++se<ve;)if(U(W,I[se]))return!0;return!1}function dt(I,W){for(var U=-1,se=I==null?0:I.length,ve=Array(se);++U<se;)ve[U]=W(I[U],U,I);return ve}function Wr(I,W){for(var U=-1,se=W.length,ve=I.length;++U<se;)I[ve+U]=W[U];return I}function gl(I,W,U,se){var ve=-1,ze=I==null?0:I.length;for(se&&ze&&(U=I[++ve]);++ve<ze;)U=W(U,I[ve],ve,I);return U}function lS(I,W,U,se){var ve=I==null?0:I.length;for(se&&ve&&(U=I[--ve]);ve--;)U=W(U,I[ve],ve,I);return U}function pl(I,W){for(var U=-1,se=I==null?0:I.length;++U<se;)if(W(I[U],U,I))return!0;return!1}var dS=ml("length");function fS(I){return I.split("")}function hS(I){return I.match(G)||[]}function Xg(I,W,U){var se;return U(I,function(ve,ze,Et){if(W(ve,ze,Et))return se=ze,!1}),se}function Js(I,W,U,se){for(var ve=I.length,ze=U+(se?1:-1);se?ze--:++ze<ve;)if(W(I[ze],ze,I))return ze;return-1}function Wi(I,W,U){return W===W?CS(I,W,U):Js(I,Yg,U)}function gS(I,W,U,se){for(var ve=U-1,ze=I.length;++ve<ze;)if(se(I[ve],W))return ve;return-1}function Yg(I){return I!==I}function Kg(I,W){var U=I==null?0:I.length;return U?_l(I,W)/U:wt}function ml(I){return function(W){return W==null?t:W[I]}}function bl(I){return function(W){return I==null?t:I[W]}}function Zg(I,W,U,se,ve){return ve(I,function(ze,Et,Ze){U=se?(se=!1,ze):W(U,ze,Et,Ze)}),U}function pS(I,W){var U=I.length;for(I.sort(W);U--;)I[U]=I[U].value;return I}function _l(I,W){for(var U,se=-1,ve=I.length;++se<ve;){var ze=W(I[se]);ze!==t&&(U=U===t?ze:U+ze)}return U}function vl(I,W){for(var U=-1,se=Array(I);++U<I;)se[U]=W(U);return se}function mS(I,W){return dt(W,function(U){return[U,I[U]]})}function ep(I){return I&&I.slice(0,ip(I)+1).replace(C,"")}function yn(I){return function(W){return I(W)}}function yl(I,W){return dt(W,function(U){return I[U]})}function jo(I,W){return I.has(W)}function tp(I,W){for(var U=-1,se=I.length;++U<se&&Wi(W,I[U],0)>-1;);return U}function np(I,W){for(var U=I.length;U--&&Wi(W,I[U],0)>-1;);return U}function bS(I,W){for(var U=I.length,se=0;U--;)I[U]===W&&++se;return se}var _S=bl(tS),vS=bl(nS);function yS(I){return"\\"+iS[I]}function wS(I,W){return I==null?t:I[W]}function ji(I){return Yx.test(I)}function PS(I){return Kx.test(I)}function xS(I){for(var W,U=[];!(W=I.next()).done;)U.push(W.value);return U}function wl(I){var W=-1,U=Array(I.size);return I.forEach(function(se,ve){U[++W]=[ve,se]}),U}function rp(I,W){return function(U){return I(W(U))}}function jr(I,W){for(var U=-1,se=I.length,ve=0,ze=[];++U<se;){var Et=I[U];(Et===W||Et===g)&&(I[U]=g,ze[ve++]=U)}return ze}function Xs(I){var W=-1,U=Array(I.size);return I.forEach(function(se){U[++W]=se}),U}function SS(I){var W=-1,U=Array(I.size);return I.forEach(function(se){U[++W]=[se,se]}),U}function CS(I,W,U){for(var se=U-1,ve=I.length;++se<ve;)if(I[se]===W)return se;return-1}function kS(I,W,U){for(var se=U+1;se--;)if(I[se]===W)return se;return se}function zi(I){return ji(I)?TS(I):dS(I)}function Gn(I){return ji(I)?DS(I):fS(I)}function ip(I){for(var W=I.length;W--&&R.test(I.charAt(W)););return W}var RS=bl(rS);function TS(I){for(var W=ll.lastIndex=0;ll.test(I);)++W;return W}function DS(I){return I.match(ll)||[]}function IS(I){return I.match(Xx)||[]}var ES=function I(W){W=W==null?At:zr.defaults(At.Object(),W,zr.pick(At,Zx));var U=W.Array,se=W.Date,ve=W.Error,ze=W.Function,Et=W.Math,Ze=W.Object,Pl=W.RegExp,FS=W.String,En=W.TypeError,Ys=U.prototype,MS=ze.prototype,Hi=Ze.prototype,Ks=W["__core-js_shared__"],Zs=MS.toString,Xe=Hi.hasOwnProperty,AS=0,op=function(){var r=/[^.]+$/.exec(Ks&&Ks.keys&&Ks.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),ea=Hi.toString,NS=Zs.call(Ze),qS=At._,LS=Pl("^"+Zs.call(Xe).replace(A,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ta=Wg?W.Buffer:t,Hr=W.Symbol,na=W.Uint8Array,sp=ta?ta.allocUnsafe:t,ra=rp(Ze.getPrototypeOf,Ze),ap=Ze.create,cp=Hi.propertyIsEnumerable,ia=Ys.splice,up=Hr?Hr.isConcatSpreadable:t,zo=Hr?Hr.iterator:t,_i=Hr?Hr.toStringTag:t,oa=function(){try{var r=xi(Ze,"defineProperty");return r({},"",{}),r}catch{}}(),OS=W.clearTimeout!==At.clearTimeout&&W.clearTimeout,BS=se&&se.now!==At.Date.now&&se.now,US=W.setTimeout!==At.setTimeout&&W.setTimeout,sa=Et.ceil,aa=Et.floor,xl=Ze.getOwnPropertySymbols,$S=ta?ta.isBuffer:t,lp=W.isFinite,WS=Ys.join,jS=rp(Ze.keys,Ze),Ft=Et.max,Wt=Et.min,zS=se.now,HS=W.parseInt,dp=Et.random,VS=Ys.reverse,Sl=xi(W,"DataView"),Ho=xi(W,"Map"),Cl=xi(W,"Promise"),Vi=xi(W,"Set"),Vo=xi(W,"WeakMap"),Go=xi(Ze,"create"),ca=Vo&&new Vo,Gi={},GS=Si(Sl),QS=Si(Ho),JS=Si(Cl),XS=Si(Vi),YS=Si(Vo),ua=Hr?Hr.prototype:t,Qo=ua?ua.valueOf:t,fp=ua?ua.toString:t;function m(r){if(bt(r)&&!Pe(r)&&!(r instanceof Fe)){if(r instanceof Fn)return r;if(Xe.call(r,"__wrapped__"))return hm(r)}return new Fn(r)}var Qi=function(){function r(){}return function(o){if(!pt(o))return{};if(ap)return ap(o);r.prototype=o;var a=new r;return r.prototype=t,a}}();function la(){}function Fn(r,o){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=t}m.templateSettings={escape:Bi,evaluate:$s,interpolate:Wo,variable:"",imports:{_:m}},m.prototype=la.prototype,m.prototype.constructor=m,Fn.prototype=Qi(la.prototype),Fn.prototype.constructor=Fn;function Fe(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=We,this.__views__=[]}function KS(){var r=new Fe(this.__wrapped__);return r.__actions__=on(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=on(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=on(this.__views__),r}function ZS(){if(this.__filtered__){var r=new Fe(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function eC(){var r=this.__wrapped__.value(),o=this.__dir__,a=Pe(r),l=o<0,d=a?r.length:0,_=fk(0,d,this.__views__),P=_.start,k=_.end,M=k-P,V=l?k:P-1,Q=this.__iteratees__,J=Q.length,ne=0,ce=Wt(M,this.__takeCount__);if(!a||!l&&d==M&&ce==M)return qp(r,this.__actions__);var de=[];e:for(;M--&&ne<ce;){V+=o;for(var Ce=-1,fe=r[V];++Ce<J;){var Ee=Q[Ce],Ne=Ee.iteratee,xn=Ee.type,Zt=Ne(fe);if(xn==ae)fe=Zt;else if(!Zt){if(xn==z)continue e;break e}}de[ne++]=fe}return de}Fe.prototype=Qi(la.prototype),Fe.prototype.constructor=Fe;function vi(r){var o=-1,a=r==null?0:r.length;for(this.clear();++o<a;){var l=r[o];this.set(l[0],l[1])}}function tC(){this.__data__=Go?Go(null):{},this.size=0}function nC(r){var o=this.has(r)&&delete this.__data__[r];return this.size-=o?1:0,o}function rC(r){var o=this.__data__;if(Go){var a=o[r];return a===u?t:a}return Xe.call(o,r)?o[r]:t}function iC(r){var o=this.__data__;return Go?o[r]!==t:Xe.call(o,r)}function oC(r,o){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=Go&&o===t?u:o,this}vi.prototype.clear=tC,vi.prototype.delete=nC,vi.prototype.get=rC,vi.prototype.has=iC,vi.prototype.set=oC;function Sr(r){var o=-1,a=r==null?0:r.length;for(this.clear();++o<a;){var l=r[o];this.set(l[0],l[1])}}function sC(){this.__data__=[],this.size=0}function aC(r){var o=this.__data__,a=da(o,r);if(a<0)return!1;var l=o.length-1;return a==l?o.pop():ia.call(o,a,1),--this.size,!0}function cC(r){var o=this.__data__,a=da(o,r);return a<0?t:o[a][1]}function uC(r){return da(this.__data__,r)>-1}function lC(r,o){var a=this.__data__,l=da(a,r);return l<0?(++this.size,a.push([r,o])):a[l][1]=o,this}Sr.prototype.clear=sC,Sr.prototype.delete=aC,Sr.prototype.get=cC,Sr.prototype.has=uC,Sr.prototype.set=lC;function Cr(r){var o=-1,a=r==null?0:r.length;for(this.clear();++o<a;){var l=r[o];this.set(l[0],l[1])}}function dC(){this.size=0,this.__data__={hash:new vi,map:new(Ho||Sr),string:new vi}}function fC(r){var o=xa(this,r).delete(r);return this.size-=o?1:0,o}function hC(r){return xa(this,r).get(r)}function gC(r){return xa(this,r).has(r)}function pC(r,o){var a=xa(this,r),l=a.size;return a.set(r,o),this.size+=a.size==l?0:1,this}Cr.prototype.clear=dC,Cr.prototype.delete=fC,Cr.prototype.get=hC,Cr.prototype.has=gC,Cr.prototype.set=pC;function yi(r){var o=-1,a=r==null?0:r.length;for(this.__data__=new Cr;++o<a;)this.add(r[o])}function mC(r){return this.__data__.set(r,u),this}function bC(r){return this.__data__.has(r)}yi.prototype.add=yi.prototype.push=mC,yi.prototype.has=bC;function Qn(r){var o=this.__data__=new Sr(r);this.size=o.size}function _C(){this.__data__=new Sr,this.size=0}function vC(r){var o=this.__data__,a=o.delete(r);return this.size=o.size,a}function yC(r){return this.__data__.get(r)}function wC(r){return this.__data__.has(r)}function PC(r,o){var a=this.__data__;if(a instanceof Sr){var l=a.__data__;if(!Ho||l.length<n-1)return l.push([r,o]),this.size=++a.size,this;a=this.__data__=new Cr(l)}return a.set(r,o),this.size=a.size,this}Qn.prototype.clear=_C,Qn.prototype.delete=vC,Qn.prototype.get=yC,Qn.prototype.has=wC,Qn.prototype.set=PC;function hp(r,o){var a=Pe(r),l=!a&&Ci(r),d=!a&&!l&&Xr(r),_=!a&&!l&&!d&&Ki(r),P=a||l||d||_,k=P?vl(r.length,FS):[],M=k.length;for(var V in r)(o||Xe.call(r,V))&&!(P&&(V=="length"||d&&(V=="offset"||V=="parent")||_&&(V=="buffer"||V=="byteLength"||V=="byteOffset")||Dr(V,M)))&&k.push(V);return k}function gp(r){var o=r.length;return o?r[ql(0,o-1)]:t}function xC(r,o){return Sa(on(r),wi(o,0,r.length))}function SC(r){return Sa(on(r))}function kl(r,o,a){(a!==t&&!Jn(r[o],a)||a===t&&!(o in r))&&kr(r,o,a)}function Jo(r,o,a){var l=r[o];(!(Xe.call(r,o)&&Jn(l,a))||a===t&&!(o in r))&&kr(r,o,a)}function da(r,o){for(var a=r.length;a--;)if(Jn(r[a][0],o))return a;return-1}function CC(r,o,a,l){return Vr(r,function(d,_,P){o(l,d,a(d),P)}),l}function pp(r,o){return r&&fr(o,Nt(o),r)}function kC(r,o){return r&&fr(o,an(o),r)}function kr(r,o,a){o=="__proto__"&&oa?oa(r,o,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[o]=a}function Rl(r,o){for(var a=-1,l=o.length,d=U(l),_=r==null;++a<l;)d[a]=_?t:ad(r,o[a]);return d}function wi(r,o,a){return r===r&&(a!==t&&(r=r<=a?r:a),o!==t&&(r=r>=o?r:o)),r}function Mn(r,o,a,l,d,_){var P,k=o&b,M=o&y,V=o&T;if(a&&(P=d?a(r,l,d,_):a(r)),P!==t)return P;if(!pt(r))return r;var Q=Pe(r);if(Q){if(P=gk(r),!k)return on(r,P)}else{var J=jt(r),ne=J==yr||J==wr;if(Xr(r))return Bp(r,k);if(J==Lt||J==zn||ne&&!d){if(P=M||ne?{}:im(r),!k)return M?rk(r,kC(P,r)):nk(r,pp(P,r))}else{if(!tt[J])return d?r:{};P=pk(r,J,k)}}_||(_=new Qn);var ce=_.get(r);if(ce)return ce;_.set(r,P),Mm(r)?r.forEach(function(fe){P.add(Mn(fe,o,a,fe,r,_))}):Em(r)&&r.forEach(function(fe,Ee){P.set(Ee,Mn(fe,o,a,Ee,r,_))});var de=V?M?Gl:Vl:M?an:Nt,Ce=Q?t:de(r);return In(Ce||r,function(fe,Ee){Ce&&(Ee=fe,fe=r[Ee]),Jo(P,Ee,Mn(fe,o,a,Ee,r,_))}),P}function RC(r){var o=Nt(r);return function(a){return mp(a,r,o)}}function mp(r,o,a){var l=a.length;if(r==null)return!l;for(r=Ze(r);l--;){var d=a[l],_=o[d],P=r[d];if(P===t&&!(d in r)||!_(P))return!1}return!0}function bp(r,o,a){if(typeof r!="function")throw new En(s);return ns(function(){r.apply(t,a)},o)}function Xo(r,o,a,l){var d=-1,_=Qs,P=!0,k=r.length,M=[],V=o.length;if(!k)return M;a&&(o=dt(o,yn(a))),l?(_=hl,P=!1):o.length>=n&&(_=jo,P=!1,o=new yi(o));e:for(;++d<k;){var Q=r[d],J=a==null?Q:a(Q);if(Q=l||Q!==0?Q:0,P&&J===J){for(var ne=V;ne--;)if(o[ne]===J)continue e;M.push(Q)}else _(o,J,l)||M.push(Q)}return M}var Vr=zp(dr),_p=zp(Dl,!0);function TC(r,o){var a=!0;return Vr(r,function(l,d,_){return a=!!o(l,d,_),a}),a}function fa(r,o,a){for(var l=-1,d=r.length;++l<d;){var _=r[l],P=o(_);if(P!=null&&(k===t?P===P&&!Pn(P):a(P,k)))var k=P,M=_}return M}function DC(r,o,a,l){var d=r.length;for(a=Se(a),a<0&&(a=-a>d?0:d+a),l=l===t||l>d?d:Se(l),l<0&&(l+=d),l=a>l?0:Nm(l);a<l;)r[a++]=o;return r}function vp(r,o){var a=[];return Vr(r,function(l,d,_){o(l,d,_)&&a.push(l)}),a}function Ot(r,o,a,l,d){var _=-1,P=r.length;for(a||(a=bk),d||(d=[]);++_<P;){var k=r[_];o>0&&a(k)?o>1?Ot(k,o-1,a,l,d):Wr(d,k):l||(d[d.length]=k)}return d}var Tl=Hp(),yp=Hp(!0);function dr(r,o){return r&&Tl(r,o,Nt)}function Dl(r,o){return r&&yp(r,o,Nt)}function ha(r,o){return $r(o,function(a){return Ir(r[a])})}function Pi(r,o){o=Qr(o,r);for(var a=0,l=o.length;r!=null&&a<l;)r=r[hr(o[a++])];return a&&a==l?r:t}function wp(r,o,a){var l=o(r);return Pe(r)?l:Wr(l,a(r))}function Yt(r){return r==null?r===t?Oi:Li:_i&&_i in Ze(r)?dk(r):Sk(r)}function Il(r,o){return r>o}function IC(r,o){return r!=null&&Xe.call(r,o)}function EC(r,o){return r!=null&&o in Ze(r)}function FC(r,o,a){return r>=Wt(o,a)&&r<Ft(o,a)}function El(r,o,a){for(var l=a?hl:Qs,d=r[0].length,_=r.length,P=_,k=U(_),M=1/0,V=[];P--;){var Q=r[P];P&&o&&(Q=dt(Q,yn(o))),M=Wt(Q.length,M),k[P]=!a&&(o||d>=120&&Q.length>=120)?new yi(P&&Q):t}Q=r[0];var J=-1,ne=k[0];e:for(;++J<d&&V.length<M;){var ce=Q[J],de=o?o(ce):ce;if(ce=a||ce!==0?ce:0,!(ne?jo(ne,de):l(V,de,a))){for(P=_;--P;){var Ce=k[P];if(!(Ce?jo(Ce,de):l(r[P],de,a)))continue e}ne&&ne.push(de),V.push(ce)}}return V}function MC(r,o,a,l){return dr(r,function(d,_,P){o(l,a(d),_,P)}),l}function Yo(r,o,a){o=Qr(o,r),r=cm(r,o);var l=r==null?r:r[hr(Nn(o))];return l==null?t:vn(l,r,a)}function Pp(r){return bt(r)&&Yt(r)==zn}function AC(r){return bt(r)&&Yt(r)==Hn}function NC(r){return bt(r)&&Yt(r)==cr}function Ko(r,o,a,l,d){return r===o?!0:r==null||o==null||!bt(r)&&!bt(o)?r!==r&&o!==o:qC(r,o,a,l,Ko,d)}function qC(r,o,a,l,d,_){var P=Pe(r),k=Pe(o),M=P?sr:jt(r),V=k?sr:jt(o);M=M==zn?Lt:M,V=V==zn?Lt:V;var Q=M==Lt,J=V==Lt,ne=M==V;if(ne&&Xr(r)){if(!Xr(o))return!1;P=!0,Q=!1}if(ne&&!Q)return _||(_=new Qn),P||Ki(r)?tm(r,o,a,l,d,_):uk(r,o,M,a,l,d,_);if(!(a&F)){var ce=Q&&Xe.call(r,"__wrapped__"),de=J&&Xe.call(o,"__wrapped__");if(ce||de){var Ce=ce?r.value():r,fe=de?o.value():o;return _||(_=new Qn),d(Ce,fe,a,l,_)}}return ne?(_||(_=new Qn),lk(r,o,a,l,d,_)):!1}function LC(r){return bt(r)&&jt(r)==gt}function Fl(r,o,a,l){var d=a.length,_=d,P=!l;if(r==null)return!_;for(r=Ze(r);d--;){var k=a[d];if(P&&k[2]?k[1]!==r[k[0]]:!(k[0]in r))return!1}for(;++d<_;){k=a[d];var M=k[0],V=r[M],Q=k[1];if(P&&k[2]){if(V===t&&!(M in r))return!1}else{var J=new Qn;if(l)var ne=l(V,Q,M,r,o,J);if(!(ne===t?Ko(Q,V,F|E,l,J):ne))return!1}}return!0}function xp(r){if(!pt(r)||vk(r))return!1;var o=Ir(r)?LS:Ie;return o.test(Si(r))}function OC(r){return bt(r)&&Yt(r)==lr}function BC(r){return bt(r)&&jt(r)==Pt}function UC(r){return bt(r)&&Ia(r.length)&&!!ot[Yt(r)]}function Sp(r){return typeof r=="function"?r:r==null?cn:typeof r=="object"?Pe(r)?Rp(r[0],r[1]):kp(r):Vm(r)}function Ml(r){if(!ts(r))return jS(r);var o=[];for(var a in Ze(r))Xe.call(r,a)&&a!="constructor"&&o.push(a);return o}function $C(r){if(!pt(r))return xk(r);var o=ts(r),a=[];for(var l in r)l=="constructor"&&(o||!Xe.call(r,l))||a.push(l);return a}function Al(r,o){return r<o}function Cp(r,o){var a=-1,l=sn(r)?U(r.length):[];return Vr(r,function(d,_,P){l[++a]=o(d,_,P)}),l}function kp(r){var o=Jl(r);return o.length==1&&o[0][2]?sm(o[0][0],o[0][1]):function(a){return a===r||Fl(a,r,o)}}function Rp(r,o){return Yl(r)&&om(o)?sm(hr(r),o):function(a){var l=ad(a,r);return l===t&&l===o?cd(a,r):Ko(o,l,F|E)}}function ga(r,o,a,l,d){r!==o&&Tl(o,function(_,P){if(d||(d=new Qn),pt(_))WC(r,o,P,a,ga,l,d);else{var k=l?l(Zl(r,P),_,P+"",r,o,d):t;k===t&&(k=_),kl(r,P,k)}},an)}function WC(r,o,a,l,d,_,P){var k=Zl(r,a),M=Zl(o,a),V=P.get(M);if(V){kl(r,a,V);return}var Q=_?_(k,M,a+"",r,o,P):t,J=Q===t;if(J){var ne=Pe(M),ce=!ne&&Xr(M),de=!ne&&!ce&&Ki(M);Q=M,ne||ce||de?Pe(k)?Q=k:xt(k)?Q=on(k):ce?(J=!1,Q=Bp(M,!0)):de?(J=!1,Q=Up(M,!0)):Q=[]:rs(M)||Ci(M)?(Q=k,Ci(k)?Q=qm(k):(!pt(k)||Ir(k))&&(Q=im(M))):J=!1}J&&(P.set(M,Q),d(Q,M,l,_,P),P.delete(M)),kl(r,a,Q)}function Tp(r,o){var a=r.length;if(a)return o+=o<0?a:0,Dr(o,a)?r[o]:t}function Dp(r,o,a){o.length?o=dt(o,function(_){return Pe(_)?function(P){return Pi(P,_.length===1?_[0]:_)}:_}):o=[cn];var l=-1;o=dt(o,yn(le()));var d=Cp(r,function(_,P,k){var M=dt(o,function(V){return V(_)});return{criteria:M,index:++l,value:_}});return pS(d,function(_,P){return tk(_,P,a)})}function jC(r,o){return Ip(r,o,function(a,l){return cd(r,l)})}function Ip(r,o,a){for(var l=-1,d=o.length,_={};++l<d;){var P=o[l],k=Pi(r,P);a(k,P)&&Zo(_,Qr(P,r),k)}return _}function zC(r){return function(o){return Pi(o,r)}}function Nl(r,o,a,l){var d=l?gS:Wi,_=-1,P=o.length,k=r;for(r===o&&(o=on(o)),a&&(k=dt(r,yn(a)));++_<P;)for(var M=0,V=o[_],Q=a?a(V):V;(M=d(k,Q,M,l))>-1;)k!==r&&ia.call(k,M,1),ia.call(r,M,1);return r}function Ep(r,o){for(var a=r?o.length:0,l=a-1;a--;){var d=o[a];if(a==l||d!==_){var _=d;Dr(d)?ia.call(r,d,1):Bl(r,d)}}return r}function ql(r,o){return r+aa(dp()*(o-r+1))}function HC(r,o,a,l){for(var d=-1,_=Ft(sa((o-r)/(a||1)),0),P=U(_);_--;)P[l?_:++d]=r,r+=a;return P}function Ll(r,o){var a="";if(!r||o<1||o>ge)return a;do o%2&&(a+=r),o=aa(o/2),o&&(r+=r);while(o);return a}function Te(r,o){return ed(am(r,o,cn),r+"")}function VC(r){return gp(Zi(r))}function GC(r,o){var a=Zi(r);return Sa(a,wi(o,0,a.length))}function Zo(r,o,a,l){if(!pt(r))return r;o=Qr(o,r);for(var d=-1,_=o.length,P=_-1,k=r;k!=null&&++d<_;){var M=hr(o[d]),V=a;if(M==="__proto__"||M==="constructor"||M==="prototype")return r;if(d!=P){var Q=k[M];V=l?l(Q,M,k):t,V===t&&(V=pt(Q)?Q:Dr(o[d+1])?[]:{})}Jo(k,M,V),k=k[M]}return r}var Fp=ca?function(r,o){return ca.set(r,o),r}:cn,QC=oa?function(r,o){return oa(r,"toString",{configurable:!0,enumerable:!1,value:ld(o),writable:!0})}:cn;function JC(r){return Sa(Zi(r))}function An(r,o,a){var l=-1,d=r.length;o<0&&(o=-o>d?0:d+o),a=a>d?d:a,a<0&&(a+=d),d=o>a?0:a-o>>>0,o>>>=0;for(var _=U(d);++l<d;)_[l]=r[l+o];return _}function XC(r,o){var a;return Vr(r,function(l,d,_){return a=o(l,d,_),!a}),!!a}function pa(r,o,a){var l=0,d=r==null?l:r.length;if(typeof o=="number"&&o===o&&d<=pn){for(;l<d;){var _=l+d>>>1,P=r[_];P!==null&&!Pn(P)&&(a?P<=o:P<o)?l=_+1:d=_}return d}return Ol(r,o,cn,a)}function Ol(r,o,a,l){var d=0,_=r==null?0:r.length;if(_===0)return 0;o=a(o);for(var P=o!==o,k=o===null,M=Pn(o),V=o===t;d<_;){var Q=aa((d+_)/2),J=a(r[Q]),ne=J!==t,ce=J===null,de=J===J,Ce=Pn(J);if(P)var fe=l||de;else V?fe=de&&(l||ne):k?fe=de&&ne&&(l||!ce):M?fe=de&&ne&&!ce&&(l||!Ce):ce||Ce?fe=!1:fe=l?J<=o:J<o;fe?d=Q+1:_=Q}return Wt(_,je)}function Mp(r,o){for(var a=-1,l=r.length,d=0,_=[];++a<l;){var P=r[a],k=o?o(P):P;if(!a||!Jn(k,M)){var M=k;_[d++]=P===0?0:P}}return _}function Ap(r){return typeof r=="number"?r:Pn(r)?wt:+r}function wn(r){if(typeof r=="string")return r;if(Pe(r))return dt(r,wn)+"";if(Pn(r))return fp?fp.call(r):"";var o=r+"";return o=="0"&&1/r==-ke?"-0":o}function Gr(r,o,a){var l=-1,d=Qs,_=r.length,P=!0,k=[],M=k;if(a)P=!1,d=hl;else if(_>=n){var V=o?null:ak(r);if(V)return Xs(V);P=!1,d=jo,M=new yi}else M=o?[]:k;e:for(;++l<_;){var Q=r[l],J=o?o(Q):Q;if(Q=a||Q!==0?Q:0,P&&J===J){for(var ne=M.length;ne--;)if(M[ne]===J)continue e;o&&M.push(J),k.push(Q)}else d(M,J,a)||(M!==k&&M.push(J),k.push(Q))}return k}function Bl(r,o){return o=Qr(o,r),r=cm(r,o),r==null||delete r[hr(Nn(o))]}function Np(r,o,a,l){return Zo(r,o,a(Pi(r,o)),l)}function ma(r,o,a,l){for(var d=r.length,_=l?d:-1;(l?_--:++_<d)&&o(r[_],_,r););return a?An(r,l?0:_,l?_+1:d):An(r,l?_+1:0,l?d:_)}function qp(r,o){var a=r;return a instanceof Fe&&(a=a.value()),gl(o,function(l,d){return d.func.apply(d.thisArg,Wr([l],d.args))},a)}function Ul(r,o,a){var l=r.length;if(l<2)return l?Gr(r[0]):[];for(var d=-1,_=U(l);++d<l;)for(var P=r[d],k=-1;++k<l;)k!=d&&(_[d]=Xo(_[d]||P,r[k],o,a));return Gr(Ot(_,1),o,a)}function Lp(r,o,a){for(var l=-1,d=r.length,_=o.length,P={};++l<d;){var k=l<_?o[l]:t;a(P,r[l],k)}return P}function $l(r){return xt(r)?r:[]}function Wl(r){return typeof r=="function"?r:cn}function Qr(r,o){return Pe(r)?r:Yl(r,o)?[r]:fm(Ge(r))}var YC=Te;function Jr(r,o,a){var l=r.length;return a=a===t?l:a,!o&&a>=l?r:An(r,o,a)}var Op=OS||function(r){return At.clearTimeout(r)};function Bp(r,o){if(o)return r.slice();var a=r.length,l=sp?sp(a):new r.constructor(a);return r.copy(l),l}function jl(r){var o=new r.constructor(r.byteLength);return new na(o).set(new na(r)),o}function KC(r,o){var a=o?jl(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function ZC(r){var o=new r.constructor(r.source,rn.exec(r));return o.lastIndex=r.lastIndex,o}function ek(r){return Qo?Ze(Qo.call(r)):{}}function Up(r,o){var a=o?jl(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function $p(r,o){if(r!==o){var a=r!==t,l=r===null,d=r===r,_=Pn(r),P=o!==t,k=o===null,M=o===o,V=Pn(o);if(!k&&!V&&!_&&r>o||_&&P&&M&&!k&&!V||l&&P&&M||!a&&M||!d)return 1;if(!l&&!_&&!V&&r<o||V&&a&&d&&!l&&!_||k&&a&&d||!P&&d||!M)return-1}return 0}function tk(r,o,a){for(var l=-1,d=r.criteria,_=o.criteria,P=d.length,k=a.length;++l<P;){var M=$p(d[l],_[l]);if(M){if(l>=k)return M;var V=a[l];return M*(V=="desc"?-1:1)}}return r.index-o.index}function Wp(r,o,a,l){for(var d=-1,_=r.length,P=a.length,k=-1,M=o.length,V=Ft(_-P,0),Q=U(M+V),J=!l;++k<M;)Q[k]=o[k];for(;++d<P;)(J||d<_)&&(Q[a[d]]=r[d]);for(;V--;)Q[k++]=r[d++];return Q}function jp(r,o,a,l){for(var d=-1,_=r.length,P=-1,k=a.length,M=-1,V=o.length,Q=Ft(_-k,0),J=U(Q+V),ne=!l;++d<Q;)J[d]=r[d];for(var ce=d;++M<V;)J[ce+M]=o[M];for(;++P<k;)(ne||d<_)&&(J[ce+a[P]]=r[d++]);return J}function on(r,o){var a=-1,l=r.length;for(o||(o=U(l));++a<l;)o[a]=r[a];return o}function fr(r,o,a,l){var d=!a;a||(a={});for(var _=-1,P=o.length;++_<P;){var k=o[_],M=l?l(a[k],r[k],k,a,r):t;M===t&&(M=r[k]),d?kr(a,k,M):Jo(a,k,M)}return a}function nk(r,o){return fr(r,Xl(r),o)}function rk(r,o){return fr(r,nm(r),o)}function ba(r,o){return function(a,l){var d=Pe(a)?cS:CC,_=o?o():{};return d(a,r,le(l,2),_)}}function Ji(r){return Te(function(o,a){var l=-1,d=a.length,_=d>1?a[d-1]:t,P=d>2?a[2]:t;for(_=r.length>3&&typeof _=="function"?(d--,_):t,P&&Kt(a[0],a[1],P)&&(_=d<3?t:_,d=1),o=Ze(o);++l<d;){var k=a[l];k&&r(o,k,l,_)}return o})}function zp(r,o){return function(a,l){if(a==null)return a;if(!sn(a))return r(a,l);for(var d=a.length,_=o?d:-1,P=Ze(a);(o?_--:++_<d)&&l(P[_],_,P)!==!1;);return a}}function Hp(r){return function(o,a,l){for(var d=-1,_=Ze(o),P=l(o),k=P.length;k--;){var M=P[r?k:++d];if(a(_[M],M,_)===!1)break}return o}}function ik(r,o,a){var l=o&L,d=es(r);function _(){var P=this&&this!==At&&this instanceof _?d:r;return P.apply(l?a:this,arguments)}return _}function Vp(r){return function(o){o=Ge(o);var a=ji(o)?Gn(o):t,l=a?a[0]:o.charAt(0),d=a?Jr(a,1).join(""):o.slice(1);return l[r]()+d}}function Xi(r){return function(o){return gl(zm(jm(o).replace(Qx,"")),r,"")}}function es(r){return function(){var o=arguments;switch(o.length){case 0:return new r;case 1:return new r(o[0]);case 2:return new r(o[0],o[1]);case 3:return new r(o[0],o[1],o[2]);case 4:return new r(o[0],o[1],o[2],o[3]);case 5:return new r(o[0],o[1],o[2],o[3],o[4]);case 6:return new r(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new r(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var a=Qi(r.prototype),l=r.apply(a,o);return pt(l)?l:a}}function ok(r,o,a){var l=es(r);function d(){for(var _=arguments.length,P=U(_),k=_,M=Yi(d);k--;)P[k]=arguments[k];var V=_<3&&P[0]!==M&&P[_-1]!==M?[]:jr(P,M);if(_-=V.length,_<a)return Yp(r,o,_a,d.placeholder,t,P,V,t,t,a-_);var Q=this&&this!==At&&this instanceof d?l:r;return vn(Q,this,P)}return d}function Gp(r){return function(o,a,l){var d=Ze(o);if(!sn(o)){var _=le(a,3);o=Nt(o),a=function(k){return _(d[k],k,d)}}var P=r(o,a,l);return P>-1?d[_?o[P]:P]:t}}function Qp(r){return Tr(function(o){var a=o.length,l=a,d=Fn.prototype.thru;for(r&&o.reverse();l--;){var _=o[l];if(typeof _!="function")throw new En(s);if(d&&!P&&Pa(_)=="wrapper")var P=new Fn([],!0)}for(l=P?l:a;++l<a;){_=o[l];var k=Pa(_),M=k=="wrapper"?Ql(_):t;M&&Kl(M[0])&&M[1]==(te|X|x|_e)&&!M[4].length&&M[9]==1?P=P[Pa(M[0])].apply(P,M[3]):P=_.length==1&&Kl(_)?P[k]():P.thru(_)}return function(){var V=arguments,Q=V[0];if(P&&V.length==1&&Pe(Q))return P.plant(Q).value();for(var J=0,ne=a?o[J].apply(this,V):Q;++J<a;)ne=o[J].call(this,ne);return ne}})}function _a(r,o,a,l,d,_,P,k,M,V){var Q=o&te,J=o&L,ne=o&B,ce=o&(X|D),de=o&Be,Ce=ne?t:es(r);function fe(){for(var Ee=arguments.length,Ne=U(Ee),xn=Ee;xn--;)Ne[xn]=arguments[xn];if(ce)var Zt=Yi(fe),Sn=bS(Ne,Zt);if(l&&(Ne=Wp(Ne,l,d,ce)),_&&(Ne=jp(Ne,_,P,ce)),Ee-=Sn,ce&&Ee<V){var St=jr(Ne,Zt);return Yp(r,o,_a,fe.placeholder,a,Ne,St,k,M,V-Ee)}var Xn=J?a:this,Fr=ne?Xn[r]:r;return Ee=Ne.length,k?Ne=Ck(Ne,k):de&&Ee>1&&Ne.reverse(),Q&&M<Ee&&(Ne.length=M),this&&this!==At&&this instanceof fe&&(Fr=Ce||es(Fr)),Fr.apply(Xn,Ne)}return fe}function Jp(r,o){return function(a,l){return MC(a,r,o(l),{})}}function va(r,o){return function(a,l){var d;if(a===t&&l===t)return o;if(a!==t&&(d=a),l!==t){if(d===t)return l;typeof a=="string"||typeof l=="string"?(a=wn(a),l=wn(l)):(a=Ap(a),l=Ap(l)),d=r(a,l)}return d}}function zl(r){return Tr(function(o){return o=dt(o,yn(le())),Te(function(a){var l=this;return r(o,function(d){return vn(d,l,a)})})})}function ya(r,o){o=o===t?" ":wn(o);var a=o.length;if(a<2)return a?Ll(o,r):o;var l=Ll(o,sa(r/zi(o)));return ji(o)?Jr(Gn(l),0,r).join(""):l.slice(0,r)}function sk(r,o,a,l){var d=o&L,_=es(r);function P(){for(var k=-1,M=arguments.length,V=-1,Q=l.length,J=U(Q+M),ne=this&&this!==At&&this instanceof P?_:r;++V<Q;)J[V]=l[V];for(;M--;)J[V++]=arguments[++k];return vn(ne,d?a:this,J)}return P}function Xp(r){return function(o,a,l){return l&&typeof l!="number"&&Kt(o,a,l)&&(a=l=t),o=Er(o),a===t?(a=o,o=0):a=Er(a),l=l===t?o<a?1:-1:Er(l),HC(o,a,l,r)}}function wa(r){return function(o,a){return typeof o=="string"&&typeof a=="string"||(o=qn(o),a=qn(a)),r(o,a)}}function Yp(r,o,a,l,d,_,P,k,M,V){var Q=o&X,J=Q?P:t,ne=Q?t:P,ce=Q?_:t,de=Q?t:_;o|=Q?x:O,o&=~(Q?O:x),o&$||(o&=~(L|B));var Ce=[r,o,d,ce,J,de,ne,k,M,V],fe=a.apply(t,Ce);return Kl(r)&&um(fe,Ce),fe.placeholder=l,lm(fe,r,o)}function Hl(r){var o=Et[r];return function(a,l){if(a=qn(a),l=l==null?0:Wt(Se(l),292),l&&lp(a)){var d=(Ge(a)+"e").split("e"),_=o(d[0]+"e"+(+d[1]+l));return d=(Ge(_)+"e").split("e"),+(d[0]+"e"+(+d[1]-l))}return o(a)}}var ak=Vi&&1/Xs(new Vi([,-0]))[1]==ke?function(r){return new Vi(r)}:hd;function Kp(r){return function(o){var a=jt(o);return a==gt?wl(o):a==Pt?SS(o):mS(o,r(o))}}function Rr(r,o,a,l,d,_,P,k){var M=o&B;if(!M&&typeof r!="function")throw new En(s);var V=l?l.length:0;if(V||(o&=~(x|O),l=d=t),P=P===t?P:Ft(Se(P),0),k=k===t?k:Se(k),V-=d?d.length:0,o&O){var Q=l,J=d;l=d=t}var ne=M?t:Ql(r),ce=[r,o,a,l,d,Q,J,_,P,k];if(ne&&Pk(ce,ne),r=ce[0],o=ce[1],a=ce[2],l=ce[3],d=ce[4],k=ce[9]=ce[9]===t?M?0:r.length:Ft(ce[9]-V,0),!k&&o&(X|D)&&(o&=~(X|D)),!o||o==L)var de=ik(r,o,a);else o==X||o==D?de=ok(r,o,k):(o==x||o==(L|x))&&!d.length?de=sk(r,o,a,l):de=_a.apply(t,ce);var Ce=ne?Fp:um;return lm(Ce(de,ce),r,o)}function Zp(r,o,a,l){return r===t||Jn(r,Hi[a])&&!Xe.call(l,a)?o:r}function em(r,o,a,l,d,_){return pt(r)&&pt(o)&&(_.set(o,r),ga(r,o,t,em,_),_.delete(o)),r}function ck(r){return rs(r)?t:r}function tm(r,o,a,l,d,_){var P=a&F,k=r.length,M=o.length;if(k!=M&&!(P&&M>k))return!1;var V=_.get(r),Q=_.get(o);if(V&&Q)return V==o&&Q==r;var J=-1,ne=!0,ce=a&E?new yi:t;for(_.set(r,o),_.set(o,r);++J<k;){var de=r[J],Ce=o[J];if(l)var fe=P?l(Ce,de,J,o,r,_):l(de,Ce,J,r,o,_);if(fe!==t){if(fe)continue;ne=!1;break}if(ce){if(!pl(o,function(Ee,Ne){if(!jo(ce,Ne)&&(de===Ee||d(de,Ee,a,l,_)))return ce.push(Ne)})){ne=!1;break}}else if(!(de===Ce||d(de,Ce,a,l,_))){ne=!1;break}}return _.delete(r),_.delete(o),ne}function uk(r,o,a,l,d,_,P){switch(a){case mn:if(r.byteLength!=o.byteLength||r.byteOffset!=o.byteOffset)return!1;r=r.buffer,o=o.buffer;case Hn:return!(r.byteLength!=o.byteLength||!_(new na(r),new na(o)));case ar:case cr:case ur:return Jn(+r,+o);case vr:return r.name==o.name&&r.message==o.message;case lr:case nn:return r==o+"";case gt:var k=wl;case Pt:var M=l&F;if(k||(k=Xs),r.size!=o.size&&!M)return!1;var V=P.get(r);if(V)return V==o;l|=E,P.set(r,o);var Q=tm(k(r),k(o),l,d,_,P);return P.delete(r),Q;case Pr:if(Qo)return Qo.call(r)==Qo.call(o)}return!1}function lk(r,o,a,l,d,_){var P=a&F,k=Vl(r),M=k.length,V=Vl(o),Q=V.length;if(M!=Q&&!P)return!1;for(var J=M;J--;){var ne=k[J];if(!(P?ne in o:Xe.call(o,ne)))return!1}var ce=_.get(r),de=_.get(o);if(ce&&de)return ce==o&&de==r;var Ce=!0;_.set(r,o),_.set(o,r);for(var fe=P;++J<M;){ne=k[J];var Ee=r[ne],Ne=o[ne];if(l)var xn=P?l(Ne,Ee,ne,o,r,_):l(Ee,Ne,ne,r,o,_);if(!(xn===t?Ee===Ne||d(Ee,Ne,a,l,_):xn)){Ce=!1;break}fe||(fe=ne=="constructor")}if(Ce&&!fe){var Zt=r.constructor,Sn=o.constructor;Zt!=Sn&&"constructor"in r&&"constructor"in o&&!(typeof Zt=="function"&&Zt instanceof Zt&&typeof Sn=="function"&&Sn instanceof Sn)&&(Ce=!1)}return _.delete(r),_.delete(o),Ce}function Tr(r){return ed(am(r,t,mm),r+"")}function Vl(r){return wp(r,Nt,Xl)}function Gl(r){return wp(r,an,nm)}var Ql=ca?function(r){return ca.get(r)}:hd;function Pa(r){for(var o=r.name+"",a=Gi[o],l=Xe.call(Gi,o)?a.length:0;l--;){var d=a[l],_=d.func;if(_==null||_==r)return d.name}return o}function Yi(r){var o=Xe.call(m,"placeholder")?m:r;return o.placeholder}function le(){var r=m.iteratee||dd;return r=r===dd?Sp:r,arguments.length?r(arguments[0],arguments[1]):r}function xa(r,o){var a=r.__data__;return _k(o)?a[typeof o=="string"?"string":"hash"]:a.map}function Jl(r){for(var o=Nt(r),a=o.length;a--;){var l=o[a],d=r[l];o[a]=[l,d,om(d)]}return o}function xi(r,o){var a=wS(r,o);return xp(a)?a:t}function dk(r){var o=Xe.call(r,_i),a=r[_i];try{r[_i]=t;var l=!0}catch{}var d=ea.call(r);return l&&(o?r[_i]=a:delete r[_i]),d}var Xl=xl?function(r){return r==null?[]:(r=Ze(r),$r(xl(r),function(o){return cp.call(r,o)}))}:gd,nm=xl?function(r){for(var o=[];r;)Wr(o,Xl(r)),r=ra(r);return o}:gd,jt=Yt;(Sl&&jt(new Sl(new ArrayBuffer(1)))!=mn||Ho&&jt(new Ho)!=gt||Cl&&jt(Cl.resolve())!=pi||Vi&&jt(new Vi)!=Pt||Vo&&jt(new Vo)!=$t)&&(jt=function(r){var o=Yt(r),a=o==Lt?r.constructor:t,l=a?Si(a):"";if(l)switch(l){case GS:return mn;case QS:return gt;case JS:return pi;case XS:return Pt;case YS:return $t}return o});function fk(r,o,a){for(var l=-1,d=a.length;++l<d;){var _=a[l],P=_.size;switch(_.type){case"drop":r+=P;break;case"dropRight":o-=P;break;case"take":o=Wt(o,r+P);break;case"takeRight":r=Ft(r,o-P);break}}return{start:r,end:o}}function hk(r){var o=r.match(f);return o?o[1].split(N):[]}function rm(r,o,a){o=Qr(o,r);for(var l=-1,d=o.length,_=!1;++l<d;){var P=hr(o[l]);if(!(_=r!=null&&a(r,P)))break;r=r[P]}return _||++l!=d?_:(d=r==null?0:r.length,!!d&&Ia(d)&&Dr(P,d)&&(Pe(r)||Ci(r)))}function gk(r){var o=r.length,a=new r.constructor(o);return o&&typeof r[0]=="string"&&Xe.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function im(r){return typeof r.constructor=="function"&&!ts(r)?Qi(ra(r)):{}}function pk(r,o,a){var l=r.constructor;switch(o){case Hn:return jl(r);case ar:case cr:return new l(+r);case mn:return KC(r,a);case xr:case bn:case S:case H:case Z:case oe:case Ue:case Le:case Qe:return Up(r,a);case gt:return new l;case ur:case nn:return new l(r);case lr:return ZC(r);case Pt:return new l;case Pr:return ek(r)}}function mk(r,o){var a=o.length;if(!a)return r;var l=a-1;return o[l]=(a>1?"& ":"")+o[l],o=o.join(a>2?", ":" "),r.replace(v,`{
/* [wrapped with `+o+`] */
`)}function bk(r){return Pe(r)||Ci(r)||!!(up&&r&&r[up])}function Dr(r,o){var a=typeof r;return o=o??ge,!!o&&(a=="number"||a!="symbol"&&Ui.test(r))&&r>-1&&r%1==0&&r<o}function Kt(r,o,a){if(!pt(a))return!1;var l=typeof o;return(l=="number"?sn(a)&&Dr(o,a.length):l=="string"&&o in a)?Jn(a[o],r):!1}function Yl(r,o){if(Pe(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Pn(r)?!0:js.test(r)||!Ws.test(r)||o!=null&&r in Ze(o)}function _k(r){var o=typeof r;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?r!=="__proto__":r===null}function Kl(r){var o=Pa(r),a=m[o];if(typeof a!="function"||!(o in Fe.prototype))return!1;if(r===a)return!0;var l=Ql(a);return!!l&&r===l[0]}function vk(r){return!!op&&op in r}var yk=Ks?Ir:pd;function ts(r){var o=r&&r.constructor,a=typeof o=="function"&&o.prototype||Hi;return r===a}function om(r){return r===r&&!pt(r)}function sm(r,o){return function(a){return a==null?!1:a[r]===o&&(o!==t||r in Ze(a))}}function wk(r){var o=Ta(r,function(l){return a.size===h&&a.clear(),l}),a=o.cache;return o}function Pk(r,o){var a=r[1],l=o[1],d=a|l,_=d<(L|B|te),P=l==te&&a==X||l==te&&a==_e&&r[7].length<=o[8]||l==(te|_e)&&o[7].length<=o[8]&&a==X;if(!(_||P))return r;l&L&&(r[2]=o[2],d|=a&L?0:$);var k=o[3];if(k){var M=r[3];r[3]=M?Wp(M,k,o[4]):k,r[4]=M?jr(r[3],g):o[4]}return k=o[5],k&&(M=r[5],r[5]=M?jp(M,k,o[6]):k,r[6]=M?jr(r[5],g):o[6]),k=o[7],k&&(r[7]=k),l&te&&(r[8]=r[8]==null?o[8]:Wt(r[8],o[8])),r[9]==null&&(r[9]=o[9]),r[0]=o[0],r[1]=d,r}function xk(r){var o=[];if(r!=null)for(var a in Ze(r))o.push(a);return o}function Sk(r){return ea.call(r)}function am(r,o,a){return o=Ft(o===t?r.length-1:o,0),function(){for(var l=arguments,d=-1,_=Ft(l.length-o,0),P=U(_);++d<_;)P[d]=l[o+d];d=-1;for(var k=U(o+1);++d<o;)k[d]=l[d];return k[o]=a(P),vn(r,this,k)}}function cm(r,o){return o.length<2?r:Pi(r,An(o,0,-1))}function Ck(r,o){for(var a=r.length,l=Wt(o.length,a),d=on(r);l--;){var _=o[l];r[l]=Dr(_,a)?d[_]:t}return r}function Zl(r,o){if(!(o==="constructor"&&typeof r[o]=="function")&&o!="__proto__")return r[o]}var um=dm(Fp),ns=US||function(r,o){return At.setTimeout(r,o)},ed=dm(QC);function lm(r,o,a){var l=o+"";return ed(r,mk(l,kk(hk(l),a)))}function dm(r){var o=0,a=0;return function(){var l=zS(),d=Y-(l-a);if(a=l,d>0){if(++o>=we)return arguments[0]}else o=0;return r.apply(t,arguments)}}function Sa(r,o){var a=-1,l=r.length,d=l-1;for(o=o===t?l:o;++a<o;){var _=ql(a,d),P=r[_];r[_]=r[a],r[a]=P}return r.length=o,r}var fm=wk(function(r){var o=[];return r.charCodeAt(0)===46&&o.push(""),r.replace(ol,function(a,l,d,_){o.push(d?_.replace(lt,"$1"):l||a)}),o});function hr(r){if(typeof r=="string"||Pn(r))return r;var o=r+"";return o=="0"&&1/r==-ke?"-0":o}function Si(r){if(r!=null){try{return Zs.call(r)}catch{}try{return r+""}catch{}}return""}function kk(r,o){return In(_r,function(a){var l="_."+a[0];o&a[1]&&!Qs(r,l)&&r.push(l)}),r.sort()}function hm(r){if(r instanceof Fe)return r.clone();var o=new Fn(r.__wrapped__,r.__chain__);return o.__actions__=on(r.__actions__),o.__index__=r.__index__,o.__values__=r.__values__,o}function Rk(r,o,a){(a?Kt(r,o,a):o===t)?o=1:o=Ft(Se(o),0);var l=r==null?0:r.length;if(!l||o<1)return[];for(var d=0,_=0,P=U(sa(l/o));d<l;)P[_++]=An(r,d,d+=o);return P}function Tk(r){for(var o=-1,a=r==null?0:r.length,l=0,d=[];++o<a;){var _=r[o];_&&(d[l++]=_)}return d}function Dk(){var r=arguments.length;if(!r)return[];for(var o=U(r-1),a=arguments[0],l=r;l--;)o[l-1]=arguments[l];return Wr(Pe(a)?on(a):[a],Ot(o,1))}var Ik=Te(function(r,o){return xt(r)?Xo(r,Ot(o,1,xt,!0)):[]}),Ek=Te(function(r,o){var a=Nn(o);return xt(a)&&(a=t),xt(r)?Xo(r,Ot(o,1,xt,!0),le(a,2)):[]}),Fk=Te(function(r,o){var a=Nn(o);return xt(a)&&(a=t),xt(r)?Xo(r,Ot(o,1,xt,!0),t,a):[]});function Mk(r,o,a){var l=r==null?0:r.length;return l?(o=a||o===t?1:Se(o),An(r,o<0?0:o,l)):[]}function Ak(r,o,a){var l=r==null?0:r.length;return l?(o=a||o===t?1:Se(o),o=l-o,An(r,0,o<0?0:o)):[]}function Nk(r,o){return r&&r.length?ma(r,le(o,3),!0,!0):[]}function qk(r,o){return r&&r.length?ma(r,le(o,3),!0):[]}function Lk(r,o,a,l){var d=r==null?0:r.length;return d?(a&&typeof a!="number"&&Kt(r,o,a)&&(a=0,l=d),DC(r,o,a,l)):[]}function gm(r,o,a){var l=r==null?0:r.length;if(!l)return-1;var d=a==null?0:Se(a);return d<0&&(d=Ft(l+d,0)),Js(r,le(o,3),d)}function pm(r,o,a){var l=r==null?0:r.length;if(!l)return-1;var d=l-1;return a!==t&&(d=Se(a),d=a<0?Ft(l+d,0):Wt(d,l-1)),Js(r,le(o,3),d,!0)}function mm(r){var o=r==null?0:r.length;return o?Ot(r,1):[]}function Ok(r){var o=r==null?0:r.length;return o?Ot(r,ke):[]}function Bk(r,o){var a=r==null?0:r.length;return a?(o=o===t?1:Se(o),Ot(r,o)):[]}function Uk(r){for(var o=-1,a=r==null?0:r.length,l={};++o<a;){var d=r[o];l[d[0]]=d[1]}return l}function bm(r){return r&&r.length?r[0]:t}function $k(r,o,a){var l=r==null?0:r.length;if(!l)return-1;var d=a==null?0:Se(a);return d<0&&(d=Ft(l+d,0)),Wi(r,o,d)}function Wk(r){var o=r==null?0:r.length;return o?An(r,0,-1):[]}var jk=Te(function(r){var o=dt(r,$l);return o.length&&o[0]===r[0]?El(o):[]}),zk=Te(function(r){var o=Nn(r),a=dt(r,$l);return o===Nn(a)?o=t:a.pop(),a.length&&a[0]===r[0]?El(a,le(o,2)):[]}),Hk=Te(function(r){var o=Nn(r),a=dt(r,$l);return o=typeof o=="function"?o:t,o&&a.pop(),a.length&&a[0]===r[0]?El(a,t,o):[]});function Vk(r,o){return r==null?"":WS.call(r,o)}function Nn(r){var o=r==null?0:r.length;return o?r[o-1]:t}function Gk(r,o,a){var l=r==null?0:r.length;if(!l)return-1;var d=l;return a!==t&&(d=Se(a),d=d<0?Ft(l+d,0):Wt(d,l-1)),o===o?kS(r,o,d):Js(r,Yg,d,!0)}function Qk(r,o){return r&&r.length?Tp(r,Se(o)):t}var Jk=Te(_m);function _m(r,o){return r&&r.length&&o&&o.length?Nl(r,o):r}function Xk(r,o,a){return r&&r.length&&o&&o.length?Nl(r,o,le(a,2)):r}function Yk(r,o,a){return r&&r.length&&o&&o.length?Nl(r,o,t,a):r}var Kk=Tr(function(r,o){var a=r==null?0:r.length,l=Rl(r,o);return Ep(r,dt(o,function(d){return Dr(d,a)?+d:d}).sort($p)),l});function Zk(r,o){var a=[];if(!(r&&r.length))return a;var l=-1,d=[],_=r.length;for(o=le(o,3);++l<_;){var P=r[l];o(P,l,r)&&(a.push(P),d.push(l))}return Ep(r,d),a}function td(r){return r==null?r:VS.call(r)}function eR(r,o,a){var l=r==null?0:r.length;return l?(a&&typeof a!="number"&&Kt(r,o,a)?(o=0,a=l):(o=o==null?0:Se(o),a=a===t?l:Se(a)),An(r,o,a)):[]}function tR(r,o){return pa(r,o)}function nR(r,o,a){return Ol(r,o,le(a,2))}function rR(r,o){var a=r==null?0:r.length;if(a){var l=pa(r,o);if(l<a&&Jn(r[l],o))return l}return-1}function iR(r,o){return pa(r,o,!0)}function oR(r,o,a){return Ol(r,o,le(a,2),!0)}function sR(r,o){var a=r==null?0:r.length;if(a){var l=pa(r,o,!0)-1;if(Jn(r[l],o))return l}return-1}function aR(r){return r&&r.length?Mp(r):[]}function cR(r,o){return r&&r.length?Mp(r,le(o,2)):[]}function uR(r){var o=r==null?0:r.length;return o?An(r,1,o):[]}function lR(r,o,a){return r&&r.length?(o=a||o===t?1:Se(o),An(r,0,o<0?0:o)):[]}function dR(r,o,a){var l=r==null?0:r.length;return l?(o=a||o===t?1:Se(o),o=l-o,An(r,o<0?0:o,l)):[]}function fR(r,o){return r&&r.length?ma(r,le(o,3),!1,!0):[]}function hR(r,o){return r&&r.length?ma(r,le(o,3)):[]}var gR=Te(function(r){return Gr(Ot(r,1,xt,!0))}),pR=Te(function(r){var o=Nn(r);return xt(o)&&(o=t),Gr(Ot(r,1,xt,!0),le(o,2))}),mR=Te(function(r){var o=Nn(r);return o=typeof o=="function"?o:t,Gr(Ot(r,1,xt,!0),t,o)});function bR(r){return r&&r.length?Gr(r):[]}function _R(r,o){return r&&r.length?Gr(r,le(o,2)):[]}function vR(r,o){return o=typeof o=="function"?o:t,r&&r.length?Gr(r,t,o):[]}function nd(r){if(!(r&&r.length))return[];var o=0;return r=$r(r,function(a){if(xt(a))return o=Ft(a.length,o),!0}),vl(o,function(a){return dt(r,ml(a))})}function vm(r,o){if(!(r&&r.length))return[];var a=nd(r);return o==null?a:dt(a,function(l){return vn(o,t,l)})}var yR=Te(function(r,o){return xt(r)?Xo(r,o):[]}),wR=Te(function(r){return Ul($r(r,xt))}),PR=Te(function(r){var o=Nn(r);return xt(o)&&(o=t),Ul($r(r,xt),le(o,2))}),xR=Te(function(r){var o=Nn(r);return o=typeof o=="function"?o:t,Ul($r(r,xt),t,o)}),SR=Te(nd);function CR(r,o){return Lp(r||[],o||[],Jo)}function kR(r,o){return Lp(r||[],o||[],Zo)}var RR=Te(function(r){var o=r.length,a=o>1?r[o-1]:t;return a=typeof a=="function"?(r.pop(),a):t,vm(r,a)});function ym(r){var o=m(r);return o.__chain__=!0,o}function TR(r,o){return o(r),r}function Ca(r,o){return o(r)}var DR=Tr(function(r){var o=r.length,a=o?r[0]:0,l=this.__wrapped__,d=function(_){return Rl(_,r)};return o>1||this.__actions__.length||!(l instanceof Fe)||!Dr(a)?this.thru(d):(l=l.slice(a,+a+(o?1:0)),l.__actions__.push({func:Ca,args:[d],thisArg:t}),new Fn(l,this.__chain__).thru(function(_){return o&&!_.length&&_.push(t),_}))});function IR(){return ym(this)}function ER(){return new Fn(this.value(),this.__chain__)}function FR(){this.__values__===t&&(this.__values__=Am(this.value()));var r=this.__index__>=this.__values__.length,o=r?t:this.__values__[this.__index__++];return{done:r,value:o}}function MR(){return this}function AR(r){for(var o,a=this;a instanceof la;){var l=hm(a);l.__index__=0,l.__values__=t,o?d.__wrapped__=l:o=l;var d=l;a=a.__wrapped__}return d.__wrapped__=r,o}function NR(){var r=this.__wrapped__;if(r instanceof Fe){var o=r;return this.__actions__.length&&(o=new Fe(this)),o=o.reverse(),o.__actions__.push({func:Ca,args:[td],thisArg:t}),new Fn(o,this.__chain__)}return this.thru(td)}function qR(){return qp(this.__wrapped__,this.__actions__)}var LR=ba(function(r,o,a){Xe.call(r,a)?++r[a]:kr(r,a,1)});function OR(r,o,a){var l=Pe(r)?Jg:TC;return a&&Kt(r,o,a)&&(o=t),l(r,le(o,3))}function BR(r,o){var a=Pe(r)?$r:vp;return a(r,le(o,3))}var UR=Gp(gm),$R=Gp(pm);function WR(r,o){return Ot(ka(r,o),1)}function jR(r,o){return Ot(ka(r,o),ke)}function zR(r,o,a){return a=a===t?1:Se(a),Ot(ka(r,o),a)}function wm(r,o){var a=Pe(r)?In:Vr;return a(r,le(o,3))}function Pm(r,o){var a=Pe(r)?uS:_p;return a(r,le(o,3))}var HR=ba(function(r,o,a){Xe.call(r,a)?r[a].push(o):kr(r,a,[o])});function VR(r,o,a,l){r=sn(r)?r:Zi(r),a=a&&!l?Se(a):0;var d=r.length;return a<0&&(a=Ft(d+a,0)),Ea(r)?a<=d&&r.indexOf(o,a)>-1:!!d&&Wi(r,o,a)>-1}var GR=Te(function(r,o,a){var l=-1,d=typeof o=="function",_=sn(r)?U(r.length):[];return Vr(r,function(P){_[++l]=d?vn(o,P,a):Yo(P,o,a)}),_}),QR=ba(function(r,o,a){kr(r,a,o)});function ka(r,o){var a=Pe(r)?dt:Cp;return a(r,le(o,3))}function JR(r,o,a,l){return r==null?[]:(Pe(o)||(o=o==null?[]:[o]),a=l?t:a,Pe(a)||(a=a==null?[]:[a]),Dp(r,o,a))}var XR=ba(function(r,o,a){r[a?0:1].push(o)},function(){return[[],[]]});function YR(r,o,a){var l=Pe(r)?gl:Zg,d=arguments.length<3;return l(r,le(o,4),a,d,Vr)}function KR(r,o,a){var l=Pe(r)?lS:Zg,d=arguments.length<3;return l(r,le(o,4),a,d,_p)}function ZR(r,o){var a=Pe(r)?$r:vp;return a(r,Da(le(o,3)))}function e0(r){var o=Pe(r)?gp:VC;return o(r)}function t0(r,o,a){(a?Kt(r,o,a):o===t)?o=1:o=Se(o);var l=Pe(r)?xC:GC;return l(r,o)}function n0(r){var o=Pe(r)?SC:JC;return o(r)}function r0(r){if(r==null)return 0;if(sn(r))return Ea(r)?zi(r):r.length;var o=jt(r);return o==gt||o==Pt?r.size:Ml(r).length}function i0(r,o,a){var l=Pe(r)?pl:XC;return a&&Kt(r,o,a)&&(o=t),l(r,le(o,3))}var o0=Te(function(r,o){if(r==null)return[];var a=o.length;return a>1&&Kt(r,o[0],o[1])?o=[]:a>2&&Kt(o[0],o[1],o[2])&&(o=[o[0]]),Dp(r,Ot(o,1),[])}),Ra=BS||function(){return At.Date.now()};function s0(r,o){if(typeof o!="function")throw new En(s);return r=Se(r),function(){if(--r<1)return o.apply(this,arguments)}}function xm(r,o,a){return o=a?t:o,o=r&&o==null?r.length:o,Rr(r,te,t,t,t,t,o)}function Sm(r,o){var a;if(typeof o!="function")throw new En(s);return r=Se(r),function(){return--r>0&&(a=o.apply(this,arguments)),r<=1&&(o=t),a}}var rd=Te(function(r,o,a){var l=L;if(a.length){var d=jr(a,Yi(rd));l|=x}return Rr(r,l,o,a,d)}),Cm=Te(function(r,o,a){var l=L|B;if(a.length){var d=jr(a,Yi(Cm));l|=x}return Rr(o,l,r,a,d)});function km(r,o,a){o=a?t:o;var l=Rr(r,X,t,t,t,t,t,o);return l.placeholder=km.placeholder,l}function Rm(r,o,a){o=a?t:o;var l=Rr(r,D,t,t,t,t,t,o);return l.placeholder=Rm.placeholder,l}function Tm(r,o,a){var l,d,_,P,k,M,V=0,Q=!1,J=!1,ne=!0;if(typeof r!="function")throw new En(s);o=qn(o)||0,pt(a)&&(Q=!!a.leading,J="maxWait"in a,_=J?Ft(qn(a.maxWait)||0,o):_,ne="trailing"in a?!!a.trailing:ne);function ce(St){var Xn=l,Fr=d;return l=d=t,V=St,P=r.apply(Fr,Xn),P}function de(St){return V=St,k=ns(Ee,o),Q?ce(St):P}function Ce(St){var Xn=St-M,Fr=St-V,Gm=o-Xn;return J?Wt(Gm,_-Fr):Gm}function fe(St){var Xn=St-M,Fr=St-V;return M===t||Xn>=o||Xn<0||J&&Fr>=_}function Ee(){var St=Ra();if(fe(St))return Ne(St);k=ns(Ee,Ce(St))}function Ne(St){return k=t,ne&&l?ce(St):(l=d=t,P)}function xn(){k!==t&&Op(k),V=0,l=M=d=k=t}function Zt(){return k===t?P:Ne(Ra())}function Sn(){var St=Ra(),Xn=fe(St);if(l=arguments,d=this,M=St,Xn){if(k===t)return de(M);if(J)return Op(k),k=ns(Ee,o),ce(M)}return k===t&&(k=ns(Ee,o)),P}return Sn.cancel=xn,Sn.flush=Zt,Sn}var a0=Te(function(r,o){return bp(r,1,o)}),c0=Te(function(r,o,a){return bp(r,qn(o)||0,a)});function u0(r){return Rr(r,Be)}function Ta(r,o){if(typeof r!="function"||o!=null&&typeof o!="function")throw new En(s);var a=function(){var l=arguments,d=o?o.apply(this,l):l[0],_=a.cache;if(_.has(d))return _.get(d);var P=r.apply(this,l);return a.cache=_.set(d,P)||_,P};return a.cache=new(Ta.Cache||Cr),a}Ta.Cache=Cr;function Da(r){if(typeof r!="function")throw new En(s);return function(){var o=arguments;switch(o.length){case 0:return!r.call(this);case 1:return!r.call(this,o[0]);case 2:return!r.call(this,o[0],o[1]);case 3:return!r.call(this,o[0],o[1],o[2])}return!r.apply(this,o)}}function l0(r){return Sm(2,r)}var d0=YC(function(r,o){o=o.length==1&&Pe(o[0])?dt(o[0],yn(le())):dt(Ot(o,1),yn(le()));var a=o.length;return Te(function(l){for(var d=-1,_=Wt(l.length,a);++d<_;)l[d]=o[d].call(this,l[d]);return vn(r,this,l)})}),id=Te(function(r,o){var a=jr(o,Yi(id));return Rr(r,x,t,o,a)}),Dm=Te(function(r,o){var a=jr(o,Yi(Dm));return Rr(r,O,t,o,a)}),f0=Tr(function(r,o){return Rr(r,_e,t,t,t,o)});function h0(r,o){if(typeof r!="function")throw new En(s);return o=o===t?o:Se(o),Te(r,o)}function g0(r,o){if(typeof r!="function")throw new En(s);return o=o==null?0:Ft(Se(o),0),Te(function(a){var l=a[o],d=Jr(a,0,o);return l&&Wr(d,l),vn(r,this,d)})}function p0(r,o,a){var l=!0,d=!0;if(typeof r!="function")throw new En(s);return pt(a)&&(l="leading"in a?!!a.leading:l,d="trailing"in a?!!a.trailing:d),Tm(r,o,{leading:l,maxWait:o,trailing:d})}function m0(r){return xm(r,1)}function b0(r,o){return id(Wl(o),r)}function _0(){if(!arguments.length)return[];var r=arguments[0];return Pe(r)?r:[r]}function v0(r){return Mn(r,T)}function y0(r,o){return o=typeof o=="function"?o:t,Mn(r,T,o)}function w0(r){return Mn(r,b|T)}function P0(r,o){return o=typeof o=="function"?o:t,Mn(r,b|T,o)}function x0(r,o){return o==null||mp(r,o,Nt(o))}function Jn(r,o){return r===o||r!==r&&o!==o}var S0=wa(Il),C0=wa(function(r,o){return r>=o}),Ci=Pp(function(){return arguments}())?Pp:function(r){return bt(r)&&Xe.call(r,"callee")&&!cp.call(r,"callee")},Pe=U.isArray,k0=jg?yn(jg):AC;function sn(r){return r!=null&&Ia(r.length)&&!Ir(r)}function xt(r){return bt(r)&&sn(r)}function R0(r){return r===!0||r===!1||bt(r)&&Yt(r)==ar}var Xr=$S||pd,T0=zg?yn(zg):NC;function D0(r){return bt(r)&&r.nodeType===1&&!rs(r)}function I0(r){if(r==null)return!0;if(sn(r)&&(Pe(r)||typeof r=="string"||typeof r.splice=="function"||Xr(r)||Ki(r)||Ci(r)))return!r.length;var o=jt(r);if(o==gt||o==Pt)return!r.size;if(ts(r))return!Ml(r).length;for(var a in r)if(Xe.call(r,a))return!1;return!0}function E0(r,o){return Ko(r,o)}function F0(r,o,a){a=typeof a=="function"?a:t;var l=a?a(r,o):t;return l===t?Ko(r,o,t,a):!!l}function od(r){if(!bt(r))return!1;var o=Yt(r);return o==vr||o==qi||typeof r.message=="string"&&typeof r.name=="string"&&!rs(r)}function M0(r){return typeof r=="number"&&lp(r)}function Ir(r){if(!pt(r))return!1;var o=Yt(r);return o==yr||o==wr||o==gi||o==Br}function Im(r){return typeof r=="number"&&r==Se(r)}function Ia(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=ge}function pt(r){var o=typeof r;return r!=null&&(o=="object"||o=="function")}function bt(r){return r!=null&&typeof r=="object"}var Em=Hg?yn(Hg):LC;function A0(r,o){return r===o||Fl(r,o,Jl(o))}function N0(r,o,a){return a=typeof a=="function"?a:t,Fl(r,o,Jl(o),a)}function q0(r){return Fm(r)&&r!=+r}function L0(r){if(yk(r))throw new ve(i);return xp(r)}function O0(r){return r===null}function B0(r){return r==null}function Fm(r){return typeof r=="number"||bt(r)&&Yt(r)==ur}function rs(r){if(!bt(r)||Yt(r)!=Lt)return!1;var o=ra(r);if(o===null)return!0;var a=Xe.call(o,"constructor")&&o.constructor;return typeof a=="function"&&a instanceof a&&Zs.call(a)==NS}var sd=Vg?yn(Vg):OC;function U0(r){return Im(r)&&r>=-ge&&r<=ge}var Mm=Gg?yn(Gg):BC;function Ea(r){return typeof r=="string"||!Pe(r)&&bt(r)&&Yt(r)==nn}function Pn(r){return typeof r=="symbol"||bt(r)&&Yt(r)==Pr}var Ki=Qg?yn(Qg):UC;function $0(r){return r===t}function W0(r){return bt(r)&&jt(r)==$t}function j0(r){return bt(r)&&Yt(r)==mi}var z0=wa(Al),H0=wa(function(r,o){return r<=o});function Am(r){if(!r)return[];if(sn(r))return Ea(r)?Gn(r):on(r);if(zo&&r[zo])return xS(r[zo]());var o=jt(r),a=o==gt?wl:o==Pt?Xs:Zi;return a(r)}function Er(r){if(!r)return r===0?r:0;if(r=qn(r),r===ke||r===-ke){var o=r<0?-1:1;return o*pe}return r===r?r:0}function Se(r){var o=Er(r),a=o%1;return o===o?a?o-a:o:0}function Nm(r){return r?wi(Se(r),0,We):0}function qn(r){if(typeof r=="number")return r;if(Pn(r))return wt;if(pt(r)){var o=typeof r.valueOf=="function"?r.valueOf():r;r=pt(o)?o+"":o}if(typeof r!="string")return r===0?r:+r;r=ep(r);var a=Vn.test(r);return a||Ur.test(r)?sS(r.slice(2),a?2:8):_n.test(r)?wt:+r}function qm(r){return fr(r,an(r))}function V0(r){return r?wi(Se(r),-ge,ge):r===0?r:0}function Ge(r){return r==null?"":wn(r)}var G0=Ji(function(r,o){if(ts(o)||sn(o)){fr(o,Nt(o),r);return}for(var a in o)Xe.call(o,a)&&Jo(r,a,o[a])}),Lm=Ji(function(r,o){fr(o,an(o),r)}),Fa=Ji(function(r,o,a,l){fr(o,an(o),r,l)}),Q0=Ji(function(r,o,a,l){fr(o,Nt(o),r,l)}),J0=Tr(Rl);function X0(r,o){var a=Qi(r);return o==null?a:pp(a,o)}var Y0=Te(function(r,o){r=Ze(r);var a=-1,l=o.length,d=l>2?o[2]:t;for(d&&Kt(o[0],o[1],d)&&(l=1);++a<l;)for(var _=o[a],P=an(_),k=-1,M=P.length;++k<M;){var V=P[k],Q=r[V];(Q===t||Jn(Q,Hi[V])&&!Xe.call(r,V))&&(r[V]=_[V])}return r}),K0=Te(function(r){return r.push(t,em),vn(Om,t,r)});function Z0(r,o){return Xg(r,le(o,3),dr)}function eT(r,o){return Xg(r,le(o,3),Dl)}function tT(r,o){return r==null?r:Tl(r,le(o,3),an)}function nT(r,o){return r==null?r:yp(r,le(o,3),an)}function rT(r,o){return r&&dr(r,le(o,3))}function iT(r,o){return r&&Dl(r,le(o,3))}function oT(r){return r==null?[]:ha(r,Nt(r))}function sT(r){return r==null?[]:ha(r,an(r))}function ad(r,o,a){var l=r==null?t:Pi(r,o);return l===t?a:l}function aT(r,o){return r!=null&&rm(r,o,IC)}function cd(r,o){return r!=null&&rm(r,o,EC)}var cT=Jp(function(r,o,a){o!=null&&typeof o.toString!="function"&&(o=ea.call(o)),r[o]=a},ld(cn)),uT=Jp(function(r,o,a){o!=null&&typeof o.toString!="function"&&(o=ea.call(o)),Xe.call(r,o)?r[o].push(a):r[o]=[a]},le),lT=Te(Yo);function Nt(r){return sn(r)?hp(r):Ml(r)}function an(r){return sn(r)?hp(r,!0):$C(r)}function dT(r,o){var a={};return o=le(o,3),dr(r,function(l,d,_){kr(a,o(l,d,_),l)}),a}function fT(r,o){var a={};return o=le(o,3),dr(r,function(l,d,_){kr(a,d,o(l,d,_))}),a}var hT=Ji(function(r,o,a){ga(r,o,a)}),Om=Ji(function(r,o,a,l){ga(r,o,a,l)}),gT=Tr(function(r,o){var a={};if(r==null)return a;var l=!1;o=dt(o,function(_){return _=Qr(_,r),l||(l=_.length>1),_}),fr(r,Gl(r),a),l&&(a=Mn(a,b|y|T,ck));for(var d=o.length;d--;)Bl(a,o[d]);return a});function pT(r,o){return Bm(r,Da(le(o)))}var mT=Tr(function(r,o){return r==null?{}:jC(r,o)});function Bm(r,o){if(r==null)return{};var a=dt(Gl(r),function(l){return[l]});return o=le(o),Ip(r,a,function(l,d){return o(l,d[0])})}function bT(r,o,a){o=Qr(o,r);var l=-1,d=o.length;for(d||(d=1,r=t);++l<d;){var _=r==null?t:r[hr(o[l])];_===t&&(l=d,_=a),r=Ir(_)?_.call(r):_}return r}function _T(r,o,a){return r==null?r:Zo(r,o,a)}function vT(r,o,a,l){return l=typeof l=="function"?l:t,r==null?r:Zo(r,o,a,l)}var Um=Kp(Nt),$m=Kp(an);function yT(r,o,a){var l=Pe(r),d=l||Xr(r)||Ki(r);if(o=le(o,4),a==null){var _=r&&r.constructor;d?a=l?new _:[]:pt(r)?a=Ir(_)?Qi(ra(r)):{}:a={}}return(d?In:dr)(r,function(P,k,M){return o(a,P,k,M)}),a}function wT(r,o){return r==null?!0:Bl(r,o)}function PT(r,o,a){return r==null?r:Np(r,o,Wl(a))}function xT(r,o,a,l){return l=typeof l=="function"?l:t,r==null?r:Np(r,o,Wl(a),l)}function Zi(r){return r==null?[]:yl(r,Nt(r))}function ST(r){return r==null?[]:yl(r,an(r))}function CT(r,o,a){return a===t&&(a=o,o=t),a!==t&&(a=qn(a),a=a===a?a:0),o!==t&&(o=qn(o),o=o===o?o:0),wi(qn(r),o,a)}function kT(r,o,a){return o=Er(o),a===t?(a=o,o=0):a=Er(a),r=qn(r),FC(r,o,a)}function RT(r,o,a){if(a&&typeof a!="boolean"&&Kt(r,o,a)&&(o=a=t),a===t&&(typeof o=="boolean"?(a=o,o=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&o===t?(r=0,o=1):(r=Er(r),o===t?(o=r,r=0):o=Er(o)),r>o){var l=r;r=o,o=l}if(a||r%1||o%1){var d=dp();return Wt(r+d*(o-r+oS("1e-"+((d+"").length-1))),o)}return ql(r,o)}var TT=Xi(function(r,o,a){return o=o.toLowerCase(),r+(a?Wm(o):o)});function Wm(r){return ud(Ge(r).toLowerCase())}function jm(r){return r=Ge(r),r&&r.replace(zs,_S).replace(Jx,"")}function DT(r,o,a){r=Ge(r),o=wn(o);var l=r.length;a=a===t?l:wi(Se(a),0,l);var d=a;return a-=o.length,a>=0&&r.slice(a,d)==o}function IT(r){return r=Ge(r),r&&Xt.test(r)?r.replace(it,vS):r}function ET(r){return r=Ge(r),r&&p.test(r)?r.replace(A,"\\$&"):r}var FT=Xi(function(r,o,a){return r+(a?"-":"")+o.toLowerCase()}),MT=Xi(function(r,o,a){return r+(a?" ":"")+o.toLowerCase()}),AT=Vp("toLowerCase");function NT(r,o,a){r=Ge(r),o=Se(o);var l=o?zi(r):0;if(!o||l>=o)return r;var d=(o-l)/2;return ya(aa(d),a)+r+ya(sa(d),a)}function qT(r,o,a){r=Ge(r),o=Se(o);var l=o?zi(r):0;return o&&l<o?r+ya(o-l,a):r}function LT(r,o,a){r=Ge(r),o=Se(o);var l=o?zi(r):0;return o&&l<o?ya(o-l,a)+r:r}function OT(r,o,a){return a||o==null?o=0:o&&(o=+o),HS(Ge(r).replace(C,""),o||0)}function BT(r,o,a){return(a?Kt(r,o,a):o===t)?o=1:o=Se(o),Ll(Ge(r),o)}function UT(){var r=arguments,o=Ge(r[0]);return r.length<3?o:o.replace(r[1],r[2])}var $T=Xi(function(r,o,a){return r+(a?"_":"")+o.toLowerCase()});function WT(r,o,a){return a&&typeof a!="number"&&Kt(r,o,a)&&(o=a=t),a=a===t?We:a>>>0,a?(r=Ge(r),r&&(typeof o=="string"||o!=null&&!sd(o))&&(o=wn(o),!o&&ji(r))?Jr(Gn(r),0,a):r.split(o,a)):[]}var jT=Xi(function(r,o,a){return r+(a?" ":"")+ud(o)});function zT(r,o,a){return r=Ge(r),a=a==null?0:wi(Se(a),0,r.length),o=wn(o),r.slice(a,a+o.length)==o}function HT(r,o,a){var l=m.templateSettings;a&&Kt(r,o,a)&&(o=t),r=Ge(r),o=Fa({},o,l,Zp);var d=Fa({},o.imports,l.imports,Zp),_=Nt(d),P=yl(d,_),k,M,V=0,Q=o.interpolate||Hs,J="__p += '",ne=Pl((o.escape||Hs).source+"|"+Q.source+"|"+(Q===Wo?Ke:Hs).source+"|"+(o.evaluate||Hs).source+"|$","g"),ce="//# sourceURL="+(Xe.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++eS+"]")+`
`;r.replace(ne,function(fe,Ee,Ne,xn,Zt,Sn){return Ne||(Ne=xn),J+=r.slice(V,Sn).replace(Ex,yS),Ee&&(k=!0,J+=`' +
__e(`+Ee+`) +
'`),Zt&&(M=!0,J+=`';
`+Zt+`;
__p += '`),Ne&&(J+=`' +
((__t = (`+Ne+`)) == null ? '' : __t) +
'`),V=Sn+fe.length,fe}),J+=`';
`;var de=Xe.call(o,"variable")&&o.variable;if(!de)J=`with (obj) {
`+J+`
}
`;else if(me.test(de))throw new ve(c);J=(M?J.replace(et,""):J).replace(Re,"$1").replace(Je,"$1;"),J="function("+(de||"obj")+`) {
`+(de?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(k?", __e = _.escape":"")+(M?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+J+`return __p
}`;var Ce=Hm(function(){return ze(_,ce+"return "+J).apply(t,P)});if(Ce.source=J,od(Ce))throw Ce;return Ce}function VT(r){return Ge(r).toLowerCase()}function GT(r){return Ge(r).toUpperCase()}function QT(r,o,a){if(r=Ge(r),r&&(a||o===t))return ep(r);if(!r||!(o=wn(o)))return r;var l=Gn(r),d=Gn(o),_=tp(l,d),P=np(l,d)+1;return Jr(l,_,P).join("")}function JT(r,o,a){if(r=Ge(r),r&&(a||o===t))return r.slice(0,ip(r)+1);if(!r||!(o=wn(o)))return r;var l=Gn(r),d=np(l,Gn(o))+1;return Jr(l,0,d).join("")}function XT(r,o,a){if(r=Ge(r),r&&(a||o===t))return r.replace(C,"");if(!r||!(o=wn(o)))return r;var l=Gn(r),d=tp(l,Gn(o));return Jr(l,d).join("")}function YT(r,o){var a=Ye,l=kt;if(pt(o)){var d="separator"in o?o.separator:d;a="length"in o?Se(o.length):a,l="omission"in o?wn(o.omission):l}r=Ge(r);var _=r.length;if(ji(r)){var P=Gn(r);_=P.length}if(a>=_)return r;var k=a-zi(l);if(k<1)return l;var M=P?Jr(P,0,k).join(""):r.slice(0,k);if(d===t)return M+l;if(P&&(k+=M.length-k),sd(d)){if(r.slice(k).search(d)){var V,Q=M;for(d.global||(d=Pl(d.source,Ge(rn.exec(d))+"g")),d.lastIndex=0;V=d.exec(Q);)var J=V.index;M=M.slice(0,J===t?k:J)}}else if(r.indexOf(wn(d),k)!=k){var ne=M.lastIndexOf(d);ne>-1&&(M=M.slice(0,ne))}return M+l}function KT(r){return r=Ge(r),r&&Rt.test(r)?r.replace(Ae,RS):r}var ZT=Xi(function(r,o,a){return r+(a?" ":"")+o.toUpperCase()}),ud=Vp("toUpperCase");function zm(r,o,a){return r=Ge(r),o=a?t:o,o===t?PS(r)?IS(r):hS(r):r.match(o)||[]}var Hm=Te(function(r,o){try{return vn(r,t,o)}catch(a){return od(a)?a:new ve(a)}}),eD=Tr(function(r,o){return In(o,function(a){a=hr(a),kr(r,a,rd(r[a],r))}),r});function tD(r){var o=r==null?0:r.length,a=le();return r=o?dt(r,function(l){if(typeof l[1]!="function")throw new En(s);return[a(l[0]),l[1]]}):[],Te(function(l){for(var d=-1;++d<o;){var _=r[d];if(vn(_[0],this,l))return vn(_[1],this,l)}})}function nD(r){return RC(Mn(r,b))}function ld(r){return function(){return r}}function rD(r,o){return r==null||r!==r?o:r}var iD=Qp(),oD=Qp(!0);function cn(r){return r}function dd(r){return Sp(typeof r=="function"?r:Mn(r,b))}function sD(r){return kp(Mn(r,b))}function aD(r,o){return Rp(r,Mn(o,b))}var cD=Te(function(r,o){return function(a){return Yo(a,r,o)}}),uD=Te(function(r,o){return function(a){return Yo(r,a,o)}});function fd(r,o,a){var l=Nt(o),d=ha(o,l);a==null&&!(pt(o)&&(d.length||!l.length))&&(a=o,o=r,r=this,d=ha(o,Nt(o)));var _=!(pt(a)&&"chain"in a)||!!a.chain,P=Ir(r);return In(d,function(k){var M=o[k];r[k]=M,P&&(r.prototype[k]=function(){var V=this.__chain__;if(_||V){var Q=r(this.__wrapped__),J=Q.__actions__=on(this.__actions__);return J.push({func:M,args:arguments,thisArg:r}),Q.__chain__=V,Q}return M.apply(r,Wr([this.value()],arguments))})}),r}function lD(){return At._===this&&(At._=qS),this}function hd(){}function dD(r){return r=Se(r),Te(function(o){return Tp(o,r)})}var fD=zl(dt),hD=zl(Jg),gD=zl(pl);function Vm(r){return Yl(r)?ml(hr(r)):zC(r)}function pD(r){return function(o){return r==null?t:Pi(r,o)}}var mD=Xp(),bD=Xp(!0);function gd(){return[]}function pd(){return!1}function _D(){return{}}function vD(){return""}function yD(){return!0}function wD(r,o){if(r=Se(r),r<1||r>ge)return[];var a=We,l=Wt(r,We);o=le(o),r-=We;for(var d=vl(l,o);++a<r;)o(a);return d}function PD(r){return Pe(r)?dt(r,hr):Pn(r)?[r]:on(fm(Ge(r)))}function xD(r){var o=++AS;return Ge(r)+o}var SD=va(function(r,o){return r+o},0),CD=Hl("ceil"),kD=va(function(r,o){return r/o},1),RD=Hl("floor");function TD(r){return r&&r.length?fa(r,cn,Il):t}function DD(r,o){return r&&r.length?fa(r,le(o,2),Il):t}function ID(r){return Kg(r,cn)}function ED(r,o){return Kg(r,le(o,2))}function FD(r){return r&&r.length?fa(r,cn,Al):t}function MD(r,o){return r&&r.length?fa(r,le(o,2),Al):t}var AD=va(function(r,o){return r*o},1),ND=Hl("round"),qD=va(function(r,o){return r-o},0);function LD(r){return r&&r.length?_l(r,cn):0}function OD(r,o){return r&&r.length?_l(r,le(o,2)):0}return m.after=s0,m.ary=xm,m.assign=G0,m.assignIn=Lm,m.assignInWith=Fa,m.assignWith=Q0,m.at=J0,m.before=Sm,m.bind=rd,m.bindAll=eD,m.bindKey=Cm,m.castArray=_0,m.chain=ym,m.chunk=Rk,m.compact=Tk,m.concat=Dk,m.cond=tD,m.conforms=nD,m.constant=ld,m.countBy=LR,m.create=X0,m.curry=km,m.curryRight=Rm,m.debounce=Tm,m.defaults=Y0,m.defaultsDeep=K0,m.defer=a0,m.delay=c0,m.difference=Ik,m.differenceBy=Ek,m.differenceWith=Fk,m.drop=Mk,m.dropRight=Ak,m.dropRightWhile=Nk,m.dropWhile=qk,m.fill=Lk,m.filter=BR,m.flatMap=WR,m.flatMapDeep=jR,m.flatMapDepth=zR,m.flatten=mm,m.flattenDeep=Ok,m.flattenDepth=Bk,m.flip=u0,m.flow=iD,m.flowRight=oD,m.fromPairs=Uk,m.functions=oT,m.functionsIn=sT,m.groupBy=HR,m.initial=Wk,m.intersection=jk,m.intersectionBy=zk,m.intersectionWith=Hk,m.invert=cT,m.invertBy=uT,m.invokeMap=GR,m.iteratee=dd,m.keyBy=QR,m.keys=Nt,m.keysIn=an,m.map=ka,m.mapKeys=dT,m.mapValues=fT,m.matches=sD,m.matchesProperty=aD,m.memoize=Ta,m.merge=hT,m.mergeWith=Om,m.method=cD,m.methodOf=uD,m.mixin=fd,m.negate=Da,m.nthArg=dD,m.omit=gT,m.omitBy=pT,m.once=l0,m.orderBy=JR,m.over=fD,m.overArgs=d0,m.overEvery=hD,m.overSome=gD,m.partial=id,m.partialRight=Dm,m.partition=XR,m.pick=mT,m.pickBy=Bm,m.property=Vm,m.propertyOf=pD,m.pull=Jk,m.pullAll=_m,m.pullAllBy=Xk,m.pullAllWith=Yk,m.pullAt=Kk,m.range=mD,m.rangeRight=bD,m.rearg=f0,m.reject=ZR,m.remove=Zk,m.rest=h0,m.reverse=td,m.sampleSize=t0,m.set=_T,m.setWith=vT,m.shuffle=n0,m.slice=eR,m.sortBy=o0,m.sortedUniq=aR,m.sortedUniqBy=cR,m.split=WT,m.spread=g0,m.tail=uR,m.take=lR,m.takeRight=dR,m.takeRightWhile=fR,m.takeWhile=hR,m.tap=TR,m.throttle=p0,m.thru=Ca,m.toArray=Am,m.toPairs=Um,m.toPairsIn=$m,m.toPath=PD,m.toPlainObject=qm,m.transform=yT,m.unary=m0,m.union=gR,m.unionBy=pR,m.unionWith=mR,m.uniq=bR,m.uniqBy=_R,m.uniqWith=vR,m.unset=wT,m.unzip=nd,m.unzipWith=vm,m.update=PT,m.updateWith=xT,m.values=Zi,m.valuesIn=ST,m.without=yR,m.words=zm,m.wrap=b0,m.xor=wR,m.xorBy=PR,m.xorWith=xR,m.zip=SR,m.zipObject=CR,m.zipObjectDeep=kR,m.zipWith=RR,m.entries=Um,m.entriesIn=$m,m.extend=Lm,m.extendWith=Fa,fd(m,m),m.add=SD,m.attempt=Hm,m.camelCase=TT,m.capitalize=Wm,m.ceil=CD,m.clamp=CT,m.clone=v0,m.cloneDeep=w0,m.cloneDeepWith=P0,m.cloneWith=y0,m.conformsTo=x0,m.deburr=jm,m.defaultTo=rD,m.divide=kD,m.endsWith=DT,m.eq=Jn,m.escape=IT,m.escapeRegExp=ET,m.every=OR,m.find=UR,m.findIndex=gm,m.findKey=Z0,m.findLast=$R,m.findLastIndex=pm,m.findLastKey=eT,m.floor=RD,m.forEach=wm,m.forEachRight=Pm,m.forIn=tT,m.forInRight=nT,m.forOwn=rT,m.forOwnRight=iT,m.get=ad,m.gt=S0,m.gte=C0,m.has=aT,m.hasIn=cd,m.head=bm,m.identity=cn,m.includes=VR,m.indexOf=$k,m.inRange=kT,m.invoke=lT,m.isArguments=Ci,m.isArray=Pe,m.isArrayBuffer=k0,m.isArrayLike=sn,m.isArrayLikeObject=xt,m.isBoolean=R0,m.isBuffer=Xr,m.isDate=T0,m.isElement=D0,m.isEmpty=I0,m.isEqual=E0,m.isEqualWith=F0,m.isError=od,m.isFinite=M0,m.isFunction=Ir,m.isInteger=Im,m.isLength=Ia,m.isMap=Em,m.isMatch=A0,m.isMatchWith=N0,m.isNaN=q0,m.isNative=L0,m.isNil=B0,m.isNull=O0,m.isNumber=Fm,m.isObject=pt,m.isObjectLike=bt,m.isPlainObject=rs,m.isRegExp=sd,m.isSafeInteger=U0,m.isSet=Mm,m.isString=Ea,m.isSymbol=Pn,m.isTypedArray=Ki,m.isUndefined=$0,m.isWeakMap=W0,m.isWeakSet=j0,m.join=Vk,m.kebabCase=FT,m.last=Nn,m.lastIndexOf=Gk,m.lowerCase=MT,m.lowerFirst=AT,m.lt=z0,m.lte=H0,m.max=TD,m.maxBy=DD,m.mean=ID,m.meanBy=ED,m.min=FD,m.minBy=MD,m.stubArray=gd,m.stubFalse=pd,m.stubObject=_D,m.stubString=vD,m.stubTrue=yD,m.multiply=AD,m.nth=Qk,m.noConflict=lD,m.noop=hd,m.now=Ra,m.pad=NT,m.padEnd=qT,m.padStart=LT,m.parseInt=OT,m.random=RT,m.reduce=YR,m.reduceRight=KR,m.repeat=BT,m.replace=UT,m.result=bT,m.round=ND,m.runInContext=I,m.sample=e0,m.size=r0,m.snakeCase=$T,m.some=i0,m.sortedIndex=tR,m.sortedIndexBy=nR,m.sortedIndexOf=rR,m.sortedLastIndex=iR,m.sortedLastIndexBy=oR,m.sortedLastIndexOf=sR,m.startCase=jT,m.startsWith=zT,m.subtract=qD,m.sum=LD,m.sumBy=OD,m.template=HT,m.times=wD,m.toFinite=Er,m.toInteger=Se,m.toLength=Nm,m.toLower=VT,m.toNumber=qn,m.toSafeInteger=V0,m.toString=Ge,m.toUpper=GT,m.trim=QT,m.trimEnd=JT,m.trimStart=XT,m.truncate=YT,m.unescape=KT,m.uniqueId=xD,m.upperCase=ZT,m.upperFirst=ud,m.each=wm,m.eachRight=Pm,m.first=bm,fd(m,function(){var r={};return dr(m,function(o,a){Xe.call(m.prototype,a)||(r[a]=o)}),r}(),{chain:!1}),m.VERSION=e,In(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){m[r].placeholder=m}),In(["drop","take"],function(r,o){Fe.prototype[r]=function(a){a=a===t?1:Ft(Se(a),0);var l=this.__filtered__&&!o?new Fe(this):this.clone();return l.__filtered__?l.__takeCount__=Wt(a,l.__takeCount__):l.__views__.push({size:Wt(a,We),type:r+(l.__dir__<0?"Right":"")}),l},Fe.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),In(["filter","map","takeWhile"],function(r,o){var a=o+1,l=a==z||a==ie;Fe.prototype[r]=function(d){var _=this.clone();return _.__iteratees__.push({iteratee:le(d,3),type:a}),_.__filtered__=_.__filtered__||l,_}}),In(["head","last"],function(r,o){var a="take"+(o?"Right":"");Fe.prototype[r]=function(){return this[a](1).value()[0]}}),In(["initial","tail"],function(r,o){var a="drop"+(o?"":"Right");Fe.prototype[r]=function(){return this.__filtered__?new Fe(this):this[a](1)}}),Fe.prototype.compact=function(){return this.filter(cn)},Fe.prototype.find=function(r){return this.filter(r).head()},Fe.prototype.findLast=function(r){return this.reverse().find(r)},Fe.prototype.invokeMap=Te(function(r,o){return typeof r=="function"?new Fe(this):this.map(function(a){return Yo(a,r,o)})}),Fe.prototype.reject=function(r){return this.filter(Da(le(r)))},Fe.prototype.slice=function(r,o){r=Se(r);var a=this;return a.__filtered__&&(r>0||o<0)?new Fe(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),o!==t&&(o=Se(o),a=o<0?a.dropRight(-o):a.take(o-r)),a)},Fe.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Fe.prototype.toArray=function(){return this.take(We)},dr(Fe.prototype,function(r,o){var a=/^(?:filter|find|map|reject)|While$/.test(o),l=/^(?:head|last)$/.test(o),d=m[l?"take"+(o=="last"?"Right":""):o],_=l||/^find/.test(o);d&&(m.prototype[o]=function(){var P=this.__wrapped__,k=l?[1]:arguments,M=P instanceof Fe,V=k[0],Q=M||Pe(P),J=function(Ee){var Ne=d.apply(m,Wr([Ee],k));return l&&ne?Ne[0]:Ne};Q&&a&&typeof V=="function"&&V.length!=1&&(M=Q=!1);var ne=this.__chain__,ce=!!this.__actions__.length,de=_&&!ne,Ce=M&&!ce;if(!_&&Q){P=Ce?P:new Fe(this);var fe=r.apply(P,k);return fe.__actions__.push({func:Ca,args:[J],thisArg:t}),new Fn(fe,ne)}return de&&Ce?r.apply(this,k):(fe=this.thru(J),de?l?fe.value()[0]:fe.value():fe)})}),In(["pop","push","shift","sort","splice","unshift"],function(r){var o=Ys[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",l=/^(?:pop|shift)$/.test(r);m.prototype[r]=function(){var d=arguments;if(l&&!this.__chain__){var _=this.value();return o.apply(Pe(_)?_:[],d)}return this[a](function(P){return o.apply(Pe(P)?P:[],d)})}}),dr(Fe.prototype,function(r,o){var a=m[o];if(a){var l=a.name+"";Xe.call(Gi,l)||(Gi[l]=[]),Gi[l].push({name:o,func:a})}}),Gi[_a(t,B).name]=[{name:"wrapper",func:t}],Fe.prototype.clone=KS,Fe.prototype.reverse=ZS,Fe.prototype.value=eC,m.prototype.at=DR,m.prototype.chain=IR,m.prototype.commit=ER,m.prototype.next=FR,m.prototype.plant=AR,m.prototype.reverse=NR,m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=qR,m.prototype.first=m.prototype.head,zo&&(m.prototype[zo]=MR),m},zr=ES();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(At._=zr,define(function(){return zr})):bi?((bi.exports=zr)._=zr,dl._=zr):At._=zr}).call(Fo)});var nx=re((h1,tx)=>{"use strict";function GP(t){return Array.isArray(t)?t:[t]}var YP="",QP=" ",zh="\\",DF=/^\s+$/,IF=/(?:[^\\]|^)\\$/,EF=/^\\!/,FF=/^\\#/,MF=/\r?\n/g,AF=/^\.*\/|^\.+$/,Hh="/",KP="node-ignore";typeof Symbol<"u"&&(KP=Symbol.for("node-ignore"));var JP=KP,NF=(t,e,n)=>Object.defineProperty(t,e,{value:n}),qF=/([0-z])-([0-z])/g,ZP=()=>!1,LF=t=>t.replace(qF,(e,n,i)=>n.charCodeAt(0)<=i.charCodeAt(0)?e:YP),OF=t=>{let{length:e}=t;return t.slice(0,e-e%2)},BF=[[/\\?\s+$/,t=>t.indexOf("\\")===0?QP:YP],[/\\\s/g,()=>QP],[/[\\$.|*+(){^]/g,t=>`\\${t}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(t,e,n)=>e+6<n.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(t,e,n)=>{let i=n.replace(/\\\*/g,"[^\\/]*");return e+i}],[/\\\\\\(?=[$.|*+(){^])/g,()=>zh],[/\\\\/g,()=>zh],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(t,e,n,i,s)=>e===zh?`\\[${n}${OF(i)}${s}`:s==="]"&&i.length%2===0?`[${LF(n)}${i}]`:"[]"],[/(?:[^*])$/,t=>/\/$/.test(t)?`${t}$`:`${t}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(t,e)=>`${e?`${e}[^/]+`:"[^/]*"}(?=$|\\/$)`]],XP=Object.create(null),UF=(t,e)=>{let n=XP[t];return n||(n=BF.reduce((i,s)=>i.replace(s[0],s[1].bind(t)),t),XP[t]=n),e?new RegExp(n,"i"):new RegExp(n)},Qh=t=>typeof t=="string",$F=t=>t&&Qh(t)&&!DF.test(t)&&!IF.test(t)&&t.indexOf("#")!==0,WF=t=>t.split(MF),Vh=class{constructor(e,n,i,s){this.origin=e,this.pattern=n,this.negative=i,this.regex=s}},jF=(t,e)=>{let n=t,i=!1;t.indexOf("!")===0&&(i=!0,t=t.substr(1)),t=t.replace(EF,"!").replace(FF,"#");let s=UF(t,e);return new Vh(n,t,i,s)},zF=(t,e)=>{throw new e(t)},qr=(t,e,n)=>Qh(t)?t?qr.isNotRelative(t)?n(`path should be a \`path.relative()\`d string, but got "${e}"`,RangeError):!0:n("path must not be empty",TypeError):n(`path must be a string, but got \`${e}\``,TypeError),ex=t=>AF.test(t);qr.isNotRelative=ex;qr.convert=t=>t;var Gh=class{constructor({ignorecase:e=!0,ignoreCase:n=e,allowRelativePaths:i=!1}={}){NF(this,JP,!0),this._rules=[],this._ignoreCase=n,this._allowRelativePaths=i,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(e){if(e&&e[JP]){this._rules=this._rules.concat(e._rules),this._added=!0;return}if($F(e)){let n=jF(e,this._ignoreCase);this._added=!0,this._rules.push(n)}}add(e){return this._added=!1,GP(Qh(e)?WF(e):e).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(e){return this.add(e)}_testOne(e,n){let i=!1,s=!1;return this._rules.forEach(c=>{let{negative:u}=c;if(s===u&&i!==s||u&&!i&&!s&&!n)return;c.regex.test(e)&&(i=!u,s=u)}),{ignored:i,unignored:s}}_test(e,n,i,s){let c=e&&qr.convert(e);return qr(c,e,this._allowRelativePaths?ZP:zF),this._t(c,n,i,s)}_t(e,n,i,s){if(e in n)return n[e];if(s||(s=e.split(Hh)),s.pop(),!s.length)return n[e]=this._testOne(e,i);let c=this._t(s.join(Hh)+Hh,n,i,s);if(c.ignored)return n[e]=c;let u=this._testOne(e,i);return n[e]={ignored:u.ignored,unignored:c.unignored||u.unignored}}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return GP(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}},Eu=t=>new Gh(t),HF=t=>qr(t&&qr.convert(t),t,ZP);Eu.isPathValid=HF;Eu.default=Eu;tx.exports=Eu;if(typeof process<"u"&&(process.env&&process.env.IGNORE_TEST_WIN32||process.platform==="win32")){let t=n=>/^\\\\\?\\/.test(n)||/["<>|\u0000-\u001F]+/u.test(n)?n:n.replace(/\\/g,"/");qr.convert=t;let e=/^[a-z]:\//i;qr.isNotRelative=n=>e.test(n)||ex(n)}});var aM={};zD(aM,{API_ENDPOINT:()=>yg});module.exports=HD(aM);var il=Tt(require("fs")),Rx=Tt(require("os")),Us=Tt(require("path"));var Aa=class t{constructor(e,n,i,s){this._uri=e,this._languageId=n,this._version=i,this._content=s,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let n=this.offsetAt(e.start),i=this.offsetAt(e.end);return this._content.substring(n,i)}return this._content}update(e,n){for(let i of e)if(t.isIncremental(i)){let s=Ym(i.range),c=this.offsetAt(s.start),u=this.offsetAt(s.end);this._content=this._content.substring(0,c)+i.text+this._content.substring(u,this._content.length);let h=Math.max(s.start.line,0),g=Math.max(s.end.line,0),b=this._lineOffsets,y=Jm(i.text,!1,c);if(g-h===y.length)for(let F=0,E=y.length;F<E;F++)b[F+h+1]=y[F];else y.length<1e4?b.splice(h+1,g-h,...y):this._lineOffsets=b=b.slice(0,h+1).concat(y,b.slice(g+1));let T=i.text.length-(u-c);if(T!==0)for(let F=h+1+y.length,E=b.length;F<E;F++)b[F]=b[F]+T}else if(t.isFull(i))this._content=i.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=n}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Jm(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let n=this.getLineOffsets(),i=0,s=n.length;if(s===0)return{line:0,character:e};for(;i<s;){let u=Math.floor((i+s)/2);n[u]>e?s=u:i=u+1}let c=i-1;return e=this.ensureBeforeEOL(e,n[c]),{line:c,character:e-n[c]}}offsetAt(e){let n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;let i=n[e.line];if(e.character<=0)return i;let s=e.line+1<n.length?n[e.line+1]:this._content.length,c=Math.min(i+e.character,s);return this.ensureBeforeEOL(c,i)}ensureBeforeEOL(e,n){for(;e>n&&Xm(this._content.charCodeAt(e-1));)e--;return e}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){let n=e;return n!=null&&typeof n.text=="string"&&n.range!==void 0&&(n.rangeLength===void 0||typeof n.rangeLength=="number")}static isFull(e){let n=e;return n!=null&&typeof n.text=="string"&&n.range===void 0&&n.rangeLength===void 0}},Na;(function(t){function e(s,c,u,h){return new Aa(s,c,u,h)}t.create=e;function n(s,c,u){if(s instanceof Aa)return s.update(c,u),s;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=n;function i(s,c){let u=s.getText(),h=md(c.map(VD),(y,T)=>{let F=y.range.start.line-T.range.start.line;return F===0?y.range.start.character-T.range.start.character:F}),g=0,b=[];for(let y of h){let T=s.offsetAt(y.range.start);if(T<g)throw new Error("Overlapping edit");T>g&&b.push(u.substring(g,T)),y.newText.length&&b.push(y.newText),g=s.offsetAt(y.range.end)}return b.push(u.substr(g)),b.join("")}t.applyEdits=i})(Na||(Na={}));function md(t,e){if(t.length<=1)return t;let n=t.length/2|0,i=t.slice(0,n),s=t.slice(n);md(i,e),md(s,e);let c=0,u=0,h=0;for(;c<i.length&&u<s.length;)e(i[c],s[u])<=0?t[h++]=i[c++]:t[h++]=s[u++];for(;c<i.length;)t[h++]=i[c++];for(;u<s.length;)t[h++]=s[u++];return t}function Jm(t,e,n=0){let i=e?[n]:[];for(let s=0;s<t.length;s++){let c=t.charCodeAt(s);Xm(c)&&(c===13&&s+1<t.length&&t.charCodeAt(s+1)===10&&s++,i.push(n+s+1))}return i}function Xm(t){return t===13||t===10}function Ym(t){let e=t.start,n=t.end;return e.line>n.line||e.line===n.line&&e.character>n.character?{start:n,end:e}:t}function VD(t){let e=Ym(t.range);return e!==t.range?{newText:t.newText,range:e}:t}var Me=Tt(ww());var Pw=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function cF(t){return typeof t=="string"&&Pw.test(t)}var mh=cF;var Ut=[];for(let t=0;t<256;++t)Ut.push((t+256).toString(16).slice(1));function xw(t,e=0){return(Ut[t[e+0]]+Ut[t[e+1]]+Ut[t[e+2]]+Ut[t[e+3]]+"-"+Ut[t[e+4]]+Ut[t[e+5]]+"-"+Ut[t[e+6]]+Ut[t[e+7]]+"-"+Ut[t[e+8]]+Ut[t[e+9]]+"-"+Ut[t[e+10]]+Ut[t[e+11]]+Ut[t[e+12]]+Ut[t[e+13]]+Ut[t[e+14]]+Ut[t[e+15]]).toLowerCase()}var Sw=require("crypto"),Zc=new Uint8Array(256),Kc=Zc.length;function bh(){return Kc>Zc.length-16&&((0,Sw.randomFillSync)(Zc),Kc=0),Zc.slice(Kc,Kc+=16)}var Cw=require("crypto"),_h={randomUUID:Cw.randomUUID};function uF(t,e,n){if(_h.randomUUID&&!e&&!t)return _h.randomUUID();t=t||{};let i=t.random||(t.rng||bh)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=i[s];return e}return xw(i)}var vs=uF;var xo=class extends Error{constructor(n){super(`Configured model "${n}" is not available`);this.modelName=n}};var So=class extends Error{constructor(){super("No models available")}},Co=class extends Error{constructor(e="Skipping inline completion."){super(e)}},Mt=class t extends Error{constructor(n,i){super(i);this.status=n}static transientIssue(n){return new t(3,n)}static fromResponse(n){return new t(lF(n.status),`HTTP error: ${n.status} ${n.statusText}`)}static isAPIErrorWithStatus(n,i){return n instanceof t?n.status===i:!1}static isRetriableAPIError(n){return n instanceof t?dF.has(n.status):!1}};function lF(t){switch(t){case 200:return 0;case 400:return 5;case 401:return 7;case 403:return 8;case 404:return 4;case 413:return 10;case 429:return 6;case 499:return 1;case 504:return 9}return t>=500&&t<600?3:2}var dF=new Set([3,1]);function fF(t){return t.cause instanceof String?String(t.cause):t.cause instanceof Object?JSON.stringify(t.cause):""}function De(t,e=!1){if(t instanceof Error){if(e){let n=fF(t);if(n!=="")return`${t.message} (due to ${n})`}return t.message}return String(t)}var vh={gitDiff:!1,gitDiffPollingFrequencyMSec:0,additionalChatModels:"",smallSyncThreshold:15,bigSyncThreshold:1e3,enableWorkspaceManagerUi:!1,enableInstructions:!1,enableSmartPaste:!1,enableSmartPasteMinVersion:"",enableViewTextDocument:!1,bypassLanguageFilter:!1,enableHindsight:!1,maxUploadSizeBytes:131072,vscodeNextEditMinVersion:"",vscodeFlywheelMinVersion:"",vscodeExternalSourcesInChatMinVersion:"",vscodeShareMinVersion:"",maxTrackableFileCount:25e4,maxTrackableFileCountWithoutPermission:15e4,minUploadedPercentageWithoutPermission:90,vscodeSourcesMinVersion:"",vscodeChatHintDecorationMinVersion:"",nextEditDebounceMs:400,enableCompletionFileEditEvents:!1,vscodeEnableCpuProfile:!1,verifyFolderIsSourceRepo:!1,refuseToSyncHomeDirectories:!1,enableFileLimitsForSyncingPermission:!1,enableChatMermaidDiagrams:!1,enableSummaryTitles:!1,vscodeNewThreadsMenuMinVersion:"",vscodeEditableHistoryMinVersion:""},eu=class{_flags;constructor(e){this._flags=e?.initialFlags??vh}get currentFlags(){return this._flags}update(e){this._flags=e}};var ru=Tt(require("fs")),iu=Tt(Rw()),Dw=Tt(require("os")),ys=Tt(require("path")),hF=process.env.TEST_TMPDIR?ys.default.join(process.env.TEST_TMPDIR,"state"):process.env.XDG_STATE_HOME||ys.default.join(Dw.default.homedir(),".local","state"),Tw=ys.default.join(hF,"augment","augment-server.log"),nu;function gF(){if(nu)return nu;let t=ys.default.dirname(Tw);return ru.default.existsSync(t)||ru.default.mkdirSync(t,{recursive:!0}),iu.default.setLevel("info"),iu.default.methodFactory=function(e){return function(n){let i=new Date().toISOString();ru.default.appendFileSync(Tw,`${i} [${e.toUpperCase()}] ${n}
`)}},nu=iu.default.getLogger("server"),nu}function Oe(t){let e=gF();return{...e,verbose:(n,...i)=>e.debug(n,...i)}}function ws(t,e,n){if(!Array.isArray(n))throw new Error(`Value of ${t}.${e} is not Array`)}function ui(t,e,n){let i=typeof n;if(i!=="number")throw new Error(`Value of ${t}.${e} has unexpected type. Expected number, received ${i}`);return n}function gn(t,e,n){let i=typeof n;if(i!=="string")throw new Error(`Value of ${t}.${e} has unexpected type. Expected string, received ${i}`);return n}function ko(t,e,n){ws(t,e,n);let i=[];for(let s of n)i.push(gn(t,e,s));return i}function yh(t,e,n,i=!1){if(n===null)return i;let s=typeof n;if(s!=="boolean")throw new Error(`Value of ${t}.${e} has unexpected type. Expected boolean, received ${s}`);return n}function ou(t,e=""){let n=[];if(typeof t!="object"||t===null)return Iw(t);for(let[i,s]of Object.entries(t))if(Array.isArray(s)){n.push(`${e}${i}: (array) ${s.length} (array length) ${JSON.stringify(s).length} (char length)`);let c=20;s.slice(0,c).forEach((u,h)=>{n.push(`${e}  [${h}]: ${ou(u,e+"  ")}`)}),s.length>c&&n.push(`${e}  ${s.length-c} more items...`)}else typeof s=="object"&&s!==null?(n.push(`${e}${i}: (object) ${Object.keys(s).length} (object size) ${JSON.stringify(s).length} (char length)`),n.push(ou(s,e+"  "))):n.push(`${e}${i}: ${Iw(s)}`);return n.join(`
`)}function Iw(t){return typeof t=="string"?`${t.length} (string length)`:typeof t=="boolean"||t===null||typeof t=="number"?"1":"N/A"}var BP=require("events");var Ew;(function(t){function e(n){return typeof n=="string"}t.is=e})(Ew||(Ew={}));var wh;(function(t){function e(n){return typeof n=="string"}t.is=e})(wh||(wh={}));var Fw;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function e(n){return typeof n=="number"&&t.MIN_VALUE<=n&&n<=t.MAX_VALUE}t.is=e})(Fw||(Fw={}));var su;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function e(n){return typeof n=="number"&&t.MIN_VALUE<=n&&n<=t.MAX_VALUE}t.is=e})(su||(su={}));var er;(function(t){function e(i,s){return i===Number.MAX_VALUE&&(i=su.MAX_VALUE),s===Number.MAX_VALUE&&(s=su.MAX_VALUE),{line:i,character:s}}t.create=e;function n(i){let s=i;return q.objectLiteral(s)&&q.uinteger(s.line)&&q.uinteger(s.character)}t.is=n})(er||(er={}));var at;(function(t){function e(i,s,c,u){if(q.uinteger(i)&&q.uinteger(s)&&q.uinteger(c)&&q.uinteger(u))return{start:er.create(i,s),end:er.create(c,u)};if(er.is(i)&&er.is(s))return{start:i,end:s};throw new Error(`Range#create called with invalid arguments[${i}, ${s}, ${c}, ${u}]`)}t.create=e;function n(i){let s=i;return q.objectLiteral(s)&&er.is(s.start)&&er.is(s.end)}t.is=n})(at||(at={}));var au;(function(t){function e(i,s){return{uri:i,range:s}}t.create=e;function n(i){let s=i;return q.objectLiteral(s)&&at.is(s.range)&&(q.string(s.uri)||q.undefined(s.uri))}t.is=n})(au||(au={}));var Mw;(function(t){function e(i,s,c,u){return{targetUri:i,targetRange:s,targetSelectionRange:c,originSelectionRange:u}}t.create=e;function n(i){let s=i;return q.objectLiteral(s)&&at.is(s.targetRange)&&q.string(s.targetUri)&&at.is(s.targetSelectionRange)&&(at.is(s.originSelectionRange)||q.undefined(s.originSelectionRange))}t.is=n})(Mw||(Mw={}));var Ph;(function(t){function e(i,s,c,u){return{red:i,green:s,blue:c,alpha:u}}t.create=e;function n(i){let s=i;return q.objectLiteral(s)&&q.numberRange(s.red,0,1)&&q.numberRange(s.green,0,1)&&q.numberRange(s.blue,0,1)&&q.numberRange(s.alpha,0,1)}t.is=n})(Ph||(Ph={}));var Aw;(function(t){function e(i,s){return{range:i,color:s}}t.create=e;function n(i){let s=i;return q.objectLiteral(s)&&at.is(s.range)&&Ph.is(s.color)}t.is=n})(Aw||(Aw={}));var Nw;(function(t){function e(i,s,c){return{label:i,textEdit:s,additionalTextEdits:c}}t.create=e;function n(i){let s=i;return q.objectLiteral(s)&&q.string(s.label)&&(q.undefined(s.textEdit)||To.is(s))&&(q.undefined(s.additionalTextEdits)||q.typedArray(s.additionalTextEdits,To.is))}t.is=n})(Nw||(Nw={}));var qw;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(qw||(qw={}));var Lw;(function(t){function e(i,s,c,u,h,g){let b={startLine:i,endLine:s};return q.defined(c)&&(b.startCharacter=c),q.defined(u)&&(b.endCharacter=u),q.defined(h)&&(b.kind=h),q.defined(g)&&(b.collapsedText=g),b}t.create=e;function n(i){let s=i;return q.objectLiteral(s)&&q.uinteger(s.startLine)&&q.uinteger(s.startLine)&&(q.undefined(s.startCharacter)||q.uinteger(s.startCharacter))&&(q.undefined(s.endCharacter)||q.uinteger(s.endCharacter))&&(q.undefined(s.kind)||q.string(s.kind))}t.is=n})(Lw||(Lw={}));var xh;(function(t){function e(i,s){return{location:i,message:s}}t.create=e;function n(i){let s=i;return q.defined(s)&&au.is(s.location)&&q.string(s.message)}t.is=n})(xh||(xh={}));var Ow;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(Ow||(Ow={}));var Bw;(function(t){t.Unnecessary=1,t.Deprecated=2})(Bw||(Bw={}));var Uw;(function(t){function e(n){let i=n;return q.objectLiteral(i)&&q.string(i.href)}t.is=e})(Uw||(Uw={}));var cu;(function(t){function e(i,s,c,u,h,g){let b={range:i,message:s};return q.defined(c)&&(b.severity=c),q.defined(u)&&(b.code=u),q.defined(h)&&(b.source=h),q.defined(g)&&(b.relatedInformation=g),b}t.create=e;function n(i){var s;let c=i;return q.defined(c)&&at.is(c.range)&&q.string(c.message)&&(q.number(c.severity)||q.undefined(c.severity))&&(q.integer(c.code)||q.string(c.code)||q.undefined(c.code))&&(q.undefined(c.codeDescription)||q.string((s=c.codeDescription)===null||s===void 0?void 0:s.href))&&(q.string(c.source)||q.undefined(c.source))&&(q.undefined(c.relatedInformation)||q.typedArray(c.relatedInformation,xh.is))}t.is=n})(cu||(cu={}));var Ro;(function(t){function e(i,s,...c){let u={title:i,command:s};return q.defined(c)&&c.length>0&&(u.arguments=c),u}t.create=e;function n(i){let s=i;return q.defined(s)&&q.string(s.title)&&q.string(s.command)}t.is=n})(Ro||(Ro={}));var To;(function(t){function e(c,u){return{range:c,newText:u}}t.replace=e;function n(c,u){return{range:{start:c,end:c},newText:u}}t.insert=n;function i(c){return{range:c,newText:""}}t.del=i;function s(c){let u=c;return q.objectLiteral(u)&&q.string(u.newText)&&at.is(u.range)}t.is=s})(To||(To={}));var Sh;(function(t){function e(i,s,c){let u={label:i};return s!==void 0&&(u.needsConfirmation=s),c!==void 0&&(u.description=c),u}t.create=e;function n(i){let s=i;return q.objectLiteral(s)&&q.string(s.label)&&(q.boolean(s.needsConfirmation)||s.needsConfirmation===void 0)&&(q.string(s.description)||s.description===void 0)}t.is=n})(Sh||(Sh={}));var Do;(function(t){function e(n){let i=n;return q.string(i)}t.is=e})(Do||(Do={}));var $w;(function(t){function e(c,u,h){return{range:c,newText:u,annotationId:h}}t.replace=e;function n(c,u,h){return{range:{start:c,end:c},newText:u,annotationId:h}}t.insert=n;function i(c,u){return{range:c,newText:"",annotationId:u}}t.del=i;function s(c){let u=c;return To.is(u)&&(Sh.is(u.annotationId)||Do.is(u.annotationId))}t.is=s})($w||($w={}));var Ch;(function(t){function e(i,s){return{textDocument:i,edits:s}}t.create=e;function n(i){let s=i;return q.defined(s)&&Ih.is(s.textDocument)&&Array.isArray(s.edits)}t.is=n})(Ch||(Ch={}));var kh;(function(t){function e(i,s,c){let u={kind:"create",uri:i};return s!==void 0&&(s.overwrite!==void 0||s.ignoreIfExists!==void 0)&&(u.options=s),c!==void 0&&(u.annotationId=c),u}t.create=e;function n(i){let s=i;return s&&s.kind==="create"&&q.string(s.uri)&&(s.options===void 0||(s.options.overwrite===void 0||q.boolean(s.options.overwrite))&&(s.options.ignoreIfExists===void 0||q.boolean(s.options.ignoreIfExists)))&&(s.annotationId===void 0||Do.is(s.annotationId))}t.is=n})(kh||(kh={}));var Rh;(function(t){function e(i,s,c,u){let h={kind:"rename",oldUri:i,newUri:s};return c!==void 0&&(c.overwrite!==void 0||c.ignoreIfExists!==void 0)&&(h.options=c),u!==void 0&&(h.annotationId=u),h}t.create=e;function n(i){let s=i;return s&&s.kind==="rename"&&q.string(s.oldUri)&&q.string(s.newUri)&&(s.options===void 0||(s.options.overwrite===void 0||q.boolean(s.options.overwrite))&&(s.options.ignoreIfExists===void 0||q.boolean(s.options.ignoreIfExists)))&&(s.annotationId===void 0||Do.is(s.annotationId))}t.is=n})(Rh||(Rh={}));var Th;(function(t){function e(i,s,c){let u={kind:"delete",uri:i};return s!==void 0&&(s.recursive!==void 0||s.ignoreIfNotExists!==void 0)&&(u.options=s),c!==void 0&&(u.annotationId=c),u}t.create=e;function n(i){let s=i;return s&&s.kind==="delete"&&q.string(s.uri)&&(s.options===void 0||(s.options.recursive===void 0||q.boolean(s.options.recursive))&&(s.options.ignoreIfNotExists===void 0||q.boolean(s.options.ignoreIfNotExists)))&&(s.annotationId===void 0||Do.is(s.annotationId))}t.is=n})(Th||(Th={}));var Dh;(function(t){function e(n){let i=n;return i&&(i.changes!==void 0||i.documentChanges!==void 0)&&(i.documentChanges===void 0||i.documentChanges.every(s=>q.string(s.kind)?kh.is(s)||Rh.is(s)||Th.is(s):Ch.is(s)))}t.is=e})(Dh||(Dh={}));var Ww;(function(t){function e(i){return{uri:i}}t.create=e;function n(i){let s=i;return q.defined(s)&&q.string(s.uri)}t.is=n})(Ww||(Ww={}));var jw;(function(t){function e(i,s){return{uri:i,version:s}}t.create=e;function n(i){let s=i;return q.defined(s)&&q.string(s.uri)&&q.integer(s.version)}t.is=n})(jw||(jw={}));var Ih;(function(t){function e(i,s){return{uri:i,version:s}}t.create=e;function n(i){let s=i;return q.defined(s)&&q.string(s.uri)&&(s.version===null||q.integer(s.version))}t.is=n})(Ih||(Ih={}));var zw;(function(t){function e(i,s,c,u){return{uri:i,languageId:s,version:c,text:u}}t.create=e;function n(i){let s=i;return q.defined(s)&&q.string(s.uri)&&q.string(s.languageId)&&q.integer(s.version)&&q.string(s.text)}t.is=n})(zw||(zw={}));var Eh;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function e(n){let i=n;return i===t.PlainText||i===t.Markdown}t.is=e})(Eh||(Eh={}));var Ps;(function(t){function e(n){let i=n;return q.objectLiteral(n)&&Eh.is(i.kind)&&q.string(i.value)}t.is=e})(Ps||(Ps={}));var Hw;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(Hw||(Hw={}));var Vw;(function(t){t.PlainText=1,t.Snippet=2})(Vw||(Vw={}));var Gw;(function(t){t.Deprecated=1})(Gw||(Gw={}));var Qw;(function(t){function e(i,s,c){return{newText:i,insert:s,replace:c}}t.create=e;function n(i){let s=i;return s&&q.string(s.newText)&&at.is(s.insert)&&at.is(s.replace)}t.is=n})(Qw||(Qw={}));var Jw;(function(t){t.asIs=1,t.adjustIndentation=2})(Jw||(Jw={}));var Xw;(function(t){function e(n){let i=n;return i&&(q.string(i.detail)||i.detail===void 0)&&(q.string(i.description)||i.description===void 0)}t.is=e})(Xw||(Xw={}));var Yw;(function(t){function e(n){return{label:n}}t.create=e})(Yw||(Yw={}));var Kw;(function(t){function e(n,i){return{items:n||[],isIncomplete:!!i}}t.create=e})(Kw||(Kw={}));var uu;(function(t){function e(i){return i.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}t.fromPlainText=e;function n(i){let s=i;return q.string(s)||q.objectLiteral(s)&&q.string(s.language)&&q.string(s.value)}t.is=n})(uu||(uu={}));var Zw;(function(t){function e(n){let i=n;return!!i&&q.objectLiteral(i)&&(Ps.is(i.contents)||uu.is(i.contents)||q.typedArray(i.contents,uu.is))&&(n.range===void 0||at.is(n.range))}t.is=e})(Zw||(Zw={}));var eP;(function(t){function e(n,i){return i?{label:n,documentation:i}:{label:n}}t.create=e})(eP||(eP={}));var tP;(function(t){function e(n,i,...s){let c={label:n};return q.defined(i)&&(c.documentation=i),q.defined(s)?c.parameters=s:c.parameters=[],c}t.create=e})(tP||(tP={}));var nP;(function(t){t.Text=1,t.Read=2,t.Write=3})(nP||(nP={}));var rP;(function(t){function e(n,i){let s={range:n};return q.number(i)&&(s.kind=i),s}t.create=e})(rP||(rP={}));var iP;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(iP||(iP={}));var oP;(function(t){t.Deprecated=1})(oP||(oP={}));var sP;(function(t){function e(n,i,s,c,u){let h={name:n,kind:i,location:{uri:c,range:s}};return u&&(h.containerName=u),h}t.create=e})(sP||(sP={}));var aP;(function(t){function e(n,i,s,c){return c!==void 0?{name:n,kind:i,location:{uri:s,range:c}}:{name:n,kind:i,location:{uri:s}}}t.create=e})(aP||(aP={}));var cP;(function(t){function e(i,s,c,u,h,g){let b={name:i,detail:s,kind:c,range:u,selectionRange:h};return g!==void 0&&(b.children=g),b}t.create=e;function n(i){let s=i;return s&&q.string(s.name)&&q.number(s.kind)&&at.is(s.range)&&at.is(s.selectionRange)&&(s.detail===void 0||q.string(s.detail))&&(s.deprecated===void 0||q.boolean(s.deprecated))&&(s.children===void 0||Array.isArray(s.children))&&(s.tags===void 0||Array.isArray(s.tags))}t.is=n})(cP||(cP={}));var uP;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(uP||(uP={}));var lu;(function(t){t.Invoked=1,t.Automatic=2})(lu||(lu={}));var lP;(function(t){function e(i,s,c){let u={diagnostics:i};return s!=null&&(u.only=s),c!=null&&(u.triggerKind=c),u}t.create=e;function n(i){let s=i;return q.defined(s)&&q.typedArray(s.diagnostics,cu.is)&&(s.only===void 0||q.typedArray(s.only,q.string))&&(s.triggerKind===void 0||s.triggerKind===lu.Invoked||s.triggerKind===lu.Automatic)}t.is=n})(lP||(lP={}));var dP;(function(t){function e(i,s,c){let u={title:i},h=!0;return typeof s=="string"?(h=!1,u.kind=s):Ro.is(s)?u.command=s:u.edit=s,h&&c!==void 0&&(u.kind=c),u}t.create=e;function n(i){let s=i;return s&&q.string(s.title)&&(s.diagnostics===void 0||q.typedArray(s.diagnostics,cu.is))&&(s.kind===void 0||q.string(s.kind))&&(s.edit!==void 0||s.command!==void 0)&&(s.command===void 0||Ro.is(s.command))&&(s.isPreferred===void 0||q.boolean(s.isPreferred))&&(s.edit===void 0||Dh.is(s.edit))}t.is=n})(dP||(dP={}));var fP;(function(t){function e(i,s){let c={range:i};return q.defined(s)&&(c.data=s),c}t.create=e;function n(i){let s=i;return q.defined(s)&&at.is(s.range)&&(q.undefined(s.command)||Ro.is(s.command))}t.is=n})(fP||(fP={}));var hP;(function(t){function e(i,s){return{tabSize:i,insertSpaces:s}}t.create=e;function n(i){let s=i;return q.defined(s)&&q.uinteger(s.tabSize)&&q.boolean(s.insertSpaces)}t.is=n})(hP||(hP={}));var gP;(function(t){function e(i,s,c){return{range:i,target:s,data:c}}t.create=e;function n(i){let s=i;return q.defined(s)&&at.is(s.range)&&(q.undefined(s.target)||q.string(s.target))}t.is=n})(gP||(gP={}));var pP;(function(t){function e(i,s){return{range:i,parent:s}}t.create=e;function n(i){let s=i;return q.objectLiteral(s)&&at.is(s.range)&&(s.parent===void 0||t.is(s.parent))}t.is=n})(pP||(pP={}));var mP;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property="property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="keyword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(mP||(mP={}));var bP;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation="documentation",t.defaultLibrary="defaultLibrary"})(bP||(bP={}));var _P;(function(t){function e(n){let i=n;return q.objectLiteral(i)&&(i.resultId===void 0||typeof i.resultId=="string")&&Array.isArray(i.data)&&(i.data.length===0||typeof i.data[0]=="number")}t.is=e})(_P||(_P={}));var vP;(function(t){function e(i,s){return{range:i,text:s}}t.create=e;function n(i){let s=i;return s!=null&&at.is(s.range)&&q.string(s.text)}t.is=n})(vP||(vP={}));var yP;(function(t){function e(i,s,c){return{range:i,variableName:s,caseSensitiveLookup:c}}t.create=e;function n(i){let s=i;return s!=null&&at.is(s.range)&&q.boolean(s.caseSensitiveLookup)&&(q.string(s.variableName)||s.variableName===void 0)}t.is=n})(yP||(yP={}));var wP;(function(t){function e(i,s){return{range:i,expression:s}}t.create=e;function n(i){let s=i;return s!=null&&at.is(s.range)&&(q.string(s.expression)||s.expression===void 0)}t.is=n})(wP||(wP={}));var PP;(function(t){function e(i,s){return{frameId:i,stoppedLocation:s}}t.create=e;function n(i){let s=i;return q.defined(s)&&at.is(i.stoppedLocation)}t.is=n})(PP||(PP={}));var Fh;(function(t){t.Type=1,t.Parameter=2;function e(n){return n===1||n===2}t.is=e})(Fh||(Fh={}));var Mh;(function(t){function e(i){return{value:i}}t.create=e;function n(i){let s=i;return q.objectLiteral(s)&&(s.tooltip===void 0||q.string(s.tooltip)||Ps.is(s.tooltip))&&(s.location===void 0||au.is(s.location))&&(s.command===void 0||Ro.is(s.command))}t.is=n})(Mh||(Mh={}));var xP;(function(t){function e(i,s,c){let u={position:i,label:s};return c!==void 0&&(u.kind=c),u}t.create=e;function n(i){let s=i;return q.objectLiteral(s)&&er.is(s.position)&&(q.string(s.label)||q.typedArray(s.label,Mh.is))&&(s.kind===void 0||Fh.is(s.kind))&&s.textEdits===void 0||q.typedArray(s.textEdits,To.is)&&(s.tooltip===void 0||q.string(s.tooltip)||Ps.is(s.tooltip))&&(s.paddingLeft===void 0||q.boolean(s.paddingLeft))&&(s.paddingRight===void 0||q.boolean(s.paddingRight))}t.is=n})(xP||(xP={}));var SP;(function(t){function e(n){return{kind:"snippet",value:n}}t.createSnippet=e})(SP||(SP={}));var CP;(function(t){function e(n,i,s,c){return{insertText:n,filterText:i,range:s,command:c}}t.create=e})(CP||(CP={}));var kP;(function(t){function e(n){return{items:n}}t.create=e})(kP||(kP={}));var RP;(function(t){t.Invoked=0,t.Automatic=1})(RP||(RP={}));var TP;(function(t){function e(n,i){return{range:n,text:i}}t.create=e})(TP||(TP={}));var DP;(function(t){function e(n,i){return{triggerKind:n,selectedCompletionInfo:i}}t.create=e})(DP||(DP={}));var IP;(function(t){function e(n){let i=n;return q.objectLiteral(i)&&wh.is(i.uri)&&q.string(i.name)}t.is=e})(IP||(IP={}));var EP;(function(t){function e(c,u,h,g){return new Ah(c,u,h,g)}t.create=e;function n(c){let u=c;return!!(q.defined(u)&&q.string(u.uri)&&(q.undefined(u.languageId)||q.string(u.languageId))&&q.uinteger(u.lineCount)&&q.func(u.getText)&&q.func(u.positionAt)&&q.func(u.offsetAt))}t.is=n;function i(c,u){let h=c.getText(),g=s(u,(y,T)=>{let F=y.range.start.line-T.range.start.line;return F===0?y.range.start.character-T.range.start.character:F}),b=h.length;for(let y=g.length-1;y>=0;y--){let T=g[y],F=c.offsetAt(T.range.start),E=c.offsetAt(T.range.end);if(E<=b)h=h.substring(0,F)+T.newText+h.substring(E,h.length);else throw new Error("Overlapping edit");b=F}return h}t.applyEdits=i;function s(c,u){if(c.length<=1)return c;let h=c.length/2|0,g=c.slice(0,h),b=c.slice(h);s(g,u),s(b,u);let y=0,T=0,F=0;for(;y<g.length&&T<b.length;)u(g[y],b[T])<=0?c[F++]=g[y++]:c[F++]=b[T++];for(;y<g.length;)c[F++]=g[y++];for(;T<b.length;)c[F++]=b[T++];return c}})(EP||(EP={}));var Ah=class{constructor(e,n,i,s){this._uri=e,this._languageId=n,this._version=i,this._content=s,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let n=this.offsetAt(e.start),i=this.offsetAt(e.end);return this._content.substring(n,i)}return this._content}update(e,n){this._content=e.text,this._version=n,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let e=[],n=this._content,i=!0;for(let s=0;s<n.length;s++){i&&(e.push(s),i=!1);let c=n.charAt(s);i=c==="\r"||c===`
`,c==="\r"&&s+1<n.length&&n.charAt(s+1)===`
`&&s++}i&&n.length>0&&e.push(n.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let n=this.getLineOffsets(),i=0,s=n.length;if(s===0)return er.create(0,e);for(;i<s;){let u=Math.floor((i+s)/2);n[u]>e?s=u:i=u+1}let c=i-1;return er.create(c,e-n[c])}offsetAt(e){let n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;let i=n[e.line],s=e.line+1<n.length?n[e.line+1]:this._content.length;return Math.max(Math.min(i+e.character,s),i)}get lineCount(){return this.getLineOffsets().length}},q;(function(t){let e=Object.prototype.toString;function n(E){return typeof E<"u"}t.defined=n;function i(E){return typeof E>"u"}t.undefined=i;function s(E){return E===!0||E===!1}t.boolean=s;function c(E){return e.call(E)==="[object String]"}t.string=c;function u(E){return e.call(E)==="[object Number]"}t.number=u;function h(E,L,B){return e.call(E)==="[object Number]"&&L<=E&&E<=B}t.numberRange=h;function g(E){return e.call(E)==="[object Number]"&&-2147483648<=E&&E<=2147483647}t.integer=g;function b(E){return e.call(E)==="[object Number]"&&0<=E&&E<=2147483647}t.uinteger=b;function y(E){return e.call(E)==="[object Function]"}t.func=y;function T(E){return E!==null&&typeof E=="object"}t.objectLiteral=T;function F(E,L){return Array.isArray(E)&&E.every(L)}t.typedArray=F})(q||(q={}));var FP;(()=>{"use strict";var t={470:s=>{function c(g){if(typeof g!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(g))}function u(g,b){for(var y,T="",F=0,E=-1,L=0,B=0;B<=g.length;++B){if(B<g.length)y=g.charCodeAt(B);else{if(y===47)break;y=47}if(y===47){if(!(E===B-1||L===1))if(E!==B-1&&L===2){if(T.length<2||F!==2||T.charCodeAt(T.length-1)!==46||T.charCodeAt(T.length-2)!==46){if(T.length>2){var $=T.lastIndexOf("/");if($!==T.length-1){$===-1?(T="",F=0):F=(T=T.slice(0,$)).length-1-T.lastIndexOf("/"),E=B,L=0;continue}}else if(T.length===2||T.length===1){T="",F=0,E=B,L=0;continue}}b&&(T.length>0?T+="/..":T="..",F=2)}else T.length>0?T+="/"+g.slice(E+1,B):T=g.slice(E+1,B),F=B-E-1;E=B,L=0}else y===46&&L!==-1?++L:L=-1}return T}var h={resolve:function(){for(var g,b="",y=!1,T=arguments.length-1;T>=-1&&!y;T--){var F;T>=0?F=arguments[T]:(g===void 0&&(g=process.cwd()),F=g),c(F),F.length!==0&&(b=F+"/"+b,y=F.charCodeAt(0)===47)}return b=u(b,!y),y?b.length>0?"/"+b:"/":b.length>0?b:"."},normalize:function(g){if(c(g),g.length===0)return".";var b=g.charCodeAt(0)===47,y=g.charCodeAt(g.length-1)===47;return(g=u(g,!b)).length!==0||b||(g="."),g.length>0&&y&&(g+="/"),b?"/"+g:g},isAbsolute:function(g){return c(g),g.length>0&&g.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var g,b=0;b<arguments.length;++b){var y=arguments[b];c(y),y.length>0&&(g===void 0?g=y:g+="/"+y)}return g===void 0?".":h.normalize(g)},relative:function(g,b){if(c(g),c(b),g===b||(g=h.resolve(g))===(b=h.resolve(b)))return"";for(var y=1;y<g.length&&g.charCodeAt(y)===47;++y);for(var T=g.length,F=T-y,E=1;E<b.length&&b.charCodeAt(E)===47;++E);for(var L=b.length-E,B=F<L?F:L,$=-1,X=0;X<=B;++X){if(X===B){if(L>B){if(b.charCodeAt(E+X)===47)return b.slice(E+X+1);if(X===0)return b.slice(E+X)}else F>B&&(g.charCodeAt(y+X)===47?$=X:X===0&&($=0));break}var D=g.charCodeAt(y+X);if(D!==b.charCodeAt(E+X))break;D===47&&($=X)}var x="";for(X=y+$+1;X<=T;++X)X!==T&&g.charCodeAt(X)!==47||(x.length===0?x+="..":x+="/..");return x.length>0?x+b.slice(E+$):(E+=$,b.charCodeAt(E)===47&&++E,b.slice(E))},_makeLong:function(g){return g},dirname:function(g){if(c(g),g.length===0)return".";for(var b=g.charCodeAt(0),y=b===47,T=-1,F=!0,E=g.length-1;E>=1;--E)if((b=g.charCodeAt(E))===47){if(!F){T=E;break}}else F=!1;return T===-1?y?"/":".":y&&T===1?"//":g.slice(0,T)},basename:function(g,b){if(b!==void 0&&typeof b!="string")throw new TypeError('"ext" argument must be a string');c(g);var y,T=0,F=-1,E=!0;if(b!==void 0&&b.length>0&&b.length<=g.length){if(b.length===g.length&&b===g)return"";var L=b.length-1,B=-1;for(y=g.length-1;y>=0;--y){var $=g.charCodeAt(y);if($===47){if(!E){T=y+1;break}}else B===-1&&(E=!1,B=y+1),L>=0&&($===b.charCodeAt(L)?--L==-1&&(F=y):(L=-1,F=B))}return T===F?F=B:F===-1&&(F=g.length),g.slice(T,F)}for(y=g.length-1;y>=0;--y)if(g.charCodeAt(y)===47){if(!E){T=y+1;break}}else F===-1&&(E=!1,F=y+1);return F===-1?"":g.slice(T,F)},extname:function(g){c(g);for(var b=-1,y=0,T=-1,F=!0,E=0,L=g.length-1;L>=0;--L){var B=g.charCodeAt(L);if(B!==47)T===-1&&(F=!1,T=L+1),B===46?b===-1?b=L:E!==1&&(E=1):b!==-1&&(E=-1);else if(!F){y=L+1;break}}return b===-1||T===-1||E===0||E===1&&b===T-1&&b===y+1?"":g.slice(b,T)},format:function(g){if(g===null||typeof g!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof g);return function(b,y){var T=y.dir||y.root,F=y.base||(y.name||"")+(y.ext||"");return T?T===y.root?T+F:T+"/"+F:F}(0,g)},parse:function(g){c(g);var b={root:"",dir:"",base:"",ext:"",name:""};if(g.length===0)return b;var y,T=g.charCodeAt(0),F=T===47;F?(b.root="/",y=1):y=0;for(var E=-1,L=0,B=-1,$=!0,X=g.length-1,D=0;X>=y;--X)if((T=g.charCodeAt(X))!==47)B===-1&&($=!1,B=X+1),T===46?E===-1?E=X:D!==1&&(D=1):E!==-1&&(D=-1);else if(!$){L=X+1;break}return E===-1||B===-1||D===0||D===1&&E===B-1&&E===L+1?B!==-1&&(b.base=b.name=L===0&&F?g.slice(1,B):g.slice(L,B)):(L===0&&F?(b.name=g.slice(1,E),b.base=g.slice(1,B)):(b.name=g.slice(L,E),b.base=g.slice(L,B)),b.ext=g.slice(E,B)),L>0?b.dir=g.slice(0,L-1):F&&(b.dir="/"),b},sep:"/",delimiter:":",win32:null,posix:null};h.posix=h,s.exports=h}},e={};function n(s){var c=e[s];if(c!==void 0)return c.exports;var u=e[s]={exports:{}};return t[s](u,u.exports,n),u.exports}n.d=(s,c)=>{for(var u in c)n.o(c,u)&&!n.o(s,u)&&Object.defineProperty(s,u,{enumerable:!0,get:c[u]})},n.o=(s,c)=>Object.prototype.hasOwnProperty.call(s,c),n.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})};var i={};(()=>{let s;n.r(i),n.d(i,{URI:()=>F,Utils:()=>we}),typeof process=="object"?s=process.platform==="win32":typeof navigator=="object"&&(s=navigator.userAgent.indexOf("Windows")>=0);let c=/^\w[\w\d+.-]*$/,u=/^\//,h=/^\/\//;function g(Y,z){if(!Y.scheme&&z)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${Y.authority}", path: "${Y.path}", query: "${Y.query}", fragment: "${Y.fragment}"}`);if(Y.scheme&&!c.test(Y.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(Y.path){if(Y.authority){if(!u.test(Y.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(h.test(Y.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}let b="",y="/",T=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class F{static isUri(z){return z instanceof F||!!z&&typeof z.authority=="string"&&typeof z.fragment=="string"&&typeof z.path=="string"&&typeof z.query=="string"&&typeof z.scheme=="string"&&typeof z.fsPath=="string"&&typeof z.with=="function"&&typeof z.toString=="function"}scheme;authority;path;query;fragment;constructor(z,ae,ie,ke,ge,pe=!1){typeof z=="object"?(this.scheme=z.scheme||b,this.authority=z.authority||b,this.path=z.path||b,this.query=z.query||b,this.fragment=z.fragment||b):(this.scheme=function(wt,We){return wt||We?wt:"file"}(z,pe),this.authority=ae||b,this.path=function(wt,We){switch(wt){case"https":case"http":case"file":We?We[0]!==y&&(We=y+We):We=y}return We}(this.scheme,ie||b),this.query=ke||b,this.fragment=ge||b,g(this,pe))}get fsPath(){return D(this,!1)}with(z){if(!z)return this;let{scheme:ae,authority:ie,path:ke,query:ge,fragment:pe}=z;return ae===void 0?ae=this.scheme:ae===null&&(ae=b),ie===void 0?ie=this.authority:ie===null&&(ie=b),ke===void 0?ke=this.path:ke===null&&(ke=b),ge===void 0?ge=this.query:ge===null&&(ge=b),pe===void 0?pe=this.fragment:pe===null&&(pe=b),ae===this.scheme&&ie===this.authority&&ke===this.path&&ge===this.query&&pe===this.fragment?this:new L(ae,ie,ke,ge,pe)}static parse(z,ae=!1){let ie=T.exec(z);return ie?new L(ie[2]||b,_e(ie[4]||b),_e(ie[5]||b),_e(ie[7]||b),_e(ie[9]||b),ae):new L(b,b,b,b,b)}static file(z){let ae=b;if(s&&(z=z.replace(/\\/g,y)),z[0]===y&&z[1]===y){let ie=z.indexOf(y,2);ie===-1?(ae=z.substring(2),z=y):(ae=z.substring(2,ie),z=z.substring(ie)||y)}return new L("file",ae,z,b,b)}static from(z){let ae=new L(z.scheme,z.authority,z.path,z.query,z.fragment);return g(ae,!0),ae}toString(z=!1){return x(this,z)}toJSON(){return this}static revive(z){if(z){if(z instanceof F)return z;{let ae=new L(z);return ae._formatted=z.external,ae._fsPath=z._sep===E?z.fsPath:null,ae}}return z}}let E=s?1:void 0;class L extends F{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=D(this,!1)),this._fsPath}toString(z=!1){return z?x(this,!0):(this._formatted||(this._formatted=x(this,!1)),this._formatted)}toJSON(){let z={$mid:1};return this._fsPath&&(z.fsPath=this._fsPath,z._sep=E),this._formatted&&(z.external=this._formatted),this.path&&(z.path=this.path),this.scheme&&(z.scheme=this.scheme),this.authority&&(z.authority=this.authority),this.query&&(z.query=this.query),this.fragment&&(z.fragment=this.fragment),z}}let B={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function $(Y,z,ae){let ie,ke=-1;for(let ge=0;ge<Y.length;ge++){let pe=Y.charCodeAt(ge);if(pe>=97&&pe<=122||pe>=65&&pe<=90||pe>=48&&pe<=57||pe===45||pe===46||pe===95||pe===126||z&&pe===47||ae&&pe===91||ae&&pe===93||ae&&pe===58)ke!==-1&&(ie+=encodeURIComponent(Y.substring(ke,ge)),ke=-1),ie!==void 0&&(ie+=Y.charAt(ge));else{ie===void 0&&(ie=Y.substr(0,ge));let wt=B[pe];wt!==void 0?(ke!==-1&&(ie+=encodeURIComponent(Y.substring(ke,ge)),ke=-1),ie+=wt):ke===-1&&(ke=ge)}}return ke!==-1&&(ie+=encodeURIComponent(Y.substring(ke))),ie!==void 0?ie:Y}function X(Y){let z;for(let ae=0;ae<Y.length;ae++){let ie=Y.charCodeAt(ae);ie===35||ie===63?(z===void 0&&(z=Y.substr(0,ae)),z+=B[ie]):z!==void 0&&(z+=Y[ae])}return z!==void 0?z:Y}function D(Y,z){let ae;return ae=Y.authority&&Y.path.length>1&&Y.scheme==="file"?`//${Y.authority}${Y.path}`:Y.path.charCodeAt(0)===47&&(Y.path.charCodeAt(1)>=65&&Y.path.charCodeAt(1)<=90||Y.path.charCodeAt(1)>=97&&Y.path.charCodeAt(1)<=122)&&Y.path.charCodeAt(2)===58?z?Y.path.substr(1):Y.path[1].toLowerCase()+Y.path.substr(2):Y.path,s&&(ae=ae.replace(/\//g,"\\")),ae}function x(Y,z){let ae=z?X:$,ie="",{scheme:ke,authority:ge,path:pe,query:wt,fragment:We}=Y;if(ke&&(ie+=ke,ie+=":"),(ge||ke==="file")&&(ie+=y,ie+=y),ge){let je=ge.indexOf("@");if(je!==-1){let pn=ge.substr(0,je);ge=ge.substr(je+1),je=pn.lastIndexOf(":"),je===-1?ie+=ae(pn,!1,!1):(ie+=ae(pn.substr(0,je),!1,!1),ie+=":",ie+=ae(pn.substr(je+1),!1,!0)),ie+="@"}ge=ge.toLowerCase(),je=ge.lastIndexOf(":"),je===-1?ie+=ae(ge,!1,!0):(ie+=ae(ge.substr(0,je),!1,!0),ie+=ge.substr(je))}if(pe){if(pe.length>=3&&pe.charCodeAt(0)===47&&pe.charCodeAt(2)===58){let je=pe.charCodeAt(1);je>=65&&je<=90&&(pe=`/${String.fromCharCode(je+32)}:${pe.substr(3)}`)}else if(pe.length>=2&&pe.charCodeAt(1)===58){let je=pe.charCodeAt(0);je>=65&&je<=90&&(pe=`${String.fromCharCode(je+32)}:${pe.substr(2)}`)}ie+=ae(pe,!0,!1)}return wt&&(ie+="?",ie+=ae(wt,!1,!1)),We&&(ie+="#",ie+=z?We:$(We,!1,!1)),ie}function O(Y){try{return decodeURIComponent(Y)}catch{return Y.length>3?Y.substr(0,3)+O(Y.substr(3)):Y}}let te=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function _e(Y){return Y.match(te)?Y.replace(te,z=>O(z)):Y}var Be=n(470);let Ye=Be.posix||Be,kt="/";var we;(function(Y){Y.joinPath=function(z,...ae){return z.with({path:Ye.join(z.path,...ae)})},Y.resolvePath=function(z,...ae){let ie=z.path,ke=!1;ie[0]!==kt&&(ie=kt+ie,ke=!0);let ge=Ye.resolve(ie,...ae);return ke&&ge[0]===kt&&!z.authority&&(ge=ge.substring(1)),z.with({path:ge})},Y.dirname=function(z){if(z.path.length===0||z.path===kt)return z;let ae=Ye.dirname(z.path);return ae.length===1&&ae.charCodeAt(0)===46&&(ae=""),z.with({path:ae})},Y.basename=function(z){return Ye.basename(z.path)},Y.extname=function(z){return Ye.extname(z.path)}})(we||(we={}))})(),FP=i})();var{URI:ht,Utils:vt}=FP;var Rn=Tt(require("fs"));var Ai=Tt(require("fs")),en=Tt(require("fs/promises"));function pF(t){return t.isFile()?"File":t.isDirectory()?"Directory":"Other"}function mF(t){return t.isFile()?"File":t.isDirectory()?"Directory":"Other"}function MP(t){return{size:t.size,type:mF(t),mtime:Math.floor(t.mtimeMs)}}async function AP(t){let e=await en.lstat(t);return MP(e)}function NP(t){try{return xs(t).type==="File"}catch{return!1}}async function qP(t){try{return(await en.stat(t)).isDirectory()}catch{return!1}}function xs(t){let e=Ai.lstatSync(t);return MP(e)}function Ss(t){let e=[],n=Ai.readdirSync(t,{withFileTypes:!0});for(let i of n)e.push([i.name,pF(i)]);return e}async function Cs(t){await en.mkdir(t,{recursive:!0})}async function Nh(t,e){await en.rename(t,e)}async function LP(t){return await en.readFile(t)}async function Io(t){return await en.readFile(t,{encoding:"utf8"})}async function du(t,e){return await en.writeFile(t,e,{encoding:"utf8"})}function OP(t){return Ai.readFileSync(t,{encoding:"utf8"})}var qh=class{secretsPath;constructor(e){Rn.existsSync(e.fsPath)||Rn.mkdirSync(e.fsPath,{recursive:!0}),this.secretsPath=vt.joinPath(e,"secrets.json").fsPath,Rn.existsSync(this.secretsPath)||Rn.writeFileSync(this.secretsPath,"{}",{mode:384})}async readSecrets(){try{let e=await Rn.promises.readFile(this.secretsPath,{encoding:"utf8"});return JSON.parse(e)}catch{return{}}}async writeSecrets(e){await Rn.promises.writeFile(this.secretsPath,JSON.stringify(e,null,2),{mode:384,encoding:"utf8"})}async get(e){return(await this.readSecrets())[e]}async store(e,n){let i=await this.readSecrets();i[e]=n,await this.writeSecrets(i)}async delete(e){let n=await this.readSecrets();e in n&&(delete n[e],await this.writeSecrets(n))}},fu=class{inMemoryState=new Map;statePath;constructor(e){Rn.mkdirSync(e.fsPath,{recursive:!0,mode:493}),this.statePath=vt.joinPath(e,"state.json").fsPath;try{let n=OP(this.statePath),i=JSON.parse(n);this.inMemoryState=new Map(i)}catch{return}}get(e){return this.inMemoryState.get(e)}async update(e,n){this.inMemoryState.set(e,n);let i=JSON.stringify(Array.from(this.inMemoryState.entries()));await Rn.promises.writeFile(this.statePath,i,{encoding:"utf8",mode:420})}},Eo=class{globalState;workspaceState;storagePath;storageUri;globalStoragePath;globalStorageUri;secrets;constructor(e){Rn.mkdirSync(e.fsPath,{recursive:!0,mode:493}),this.storageUri=vt.joinPath(e,"workspaceStorage"),this.storagePath=this.storageUri.fsPath,this.globalStorageUri=vt.joinPath(e,"globalStorage"),this.globalStoragePath=this.globalStorageUri.fsPath,this.secrets=new qh(e),this.globalState=new fu(this.globalStorageUri),this.workspaceState=new fu(this.storageUri)}};var hu=class{constructor(e){this.document=e}get uri(){return ht.parse(this.document.uri)}get languageId(){return this.document.languageId}get version(){return this.document.version}positionAt(e){return this.document.positionAt(e)}offsetAt(e){return this.document.offsetAt(e)}getText(e){return this.document.getText(e)}},Nr=class{dispose;constructor(e){this.dispose=()=>e()}},Ve=class{nodeEventEmitter;constructor(){this.nodeEventEmitter=new BP.EventEmitter,this.event=(e,n,i)=>{let s=n?e.bind(n):e;this.nodeEventEmitter.on("event",s);let c=new Nr(()=>{this.nodeEventEmitter.off("event",s)});return Array.isArray(i)&&i.push(c),c}}event;fire(e){this.nodeEventEmitter.emit("event",e)}dispose(){this.nodeEventEmitter.removeAllListeners("event")}};var Ni=class{token;tokenEvent;constructor(){this.tokenEvent=new Ve,this.token={isCancellationRequested:!1,onCancellationRequested:this.tokenEvent.event}}cancel(){this.token.isCancellationRequested=!0,this.tokenEvent.fire()}dispose(){this.tokenEvent.dispose()}},bF=new Ve,Lh={onDidChangeConfiguration:bF.event,getConfiguration:t=>t==="augment"?{}:{}};var _F={initialMS:100,mult:2,maxMS:3e4};function ks(t){let e;return new Promise(n=>{e=t(i=>{e.dispose(),n(i)})})}function vF(t){return t===0?Promise.resolve():new Promise(e=>{setTimeout(e,t)})}async function br(t,e,n=_F){let i=0,s=n.maxTotalMs!==void 0?Date.now():void 0,c=n.canRetry?n.canRetry:u=>Mt.isRetriableAPIError(u);for(let u=0;;u++)try{let h=await t();return u>0&&e.info(`Operation succeeded after ${u} transient failures`),h}catch(h){if(!c(h))throw h;let g=u+1;if(n.maxTries!==void 0&&g>=n.maxTries||(i===0?i=n.initialMS:i=Math.min(i*n.mult,n.maxMS),e.info(`Operation failed with error ${h}, retrying in ${i} ms; retries = ${u}`),n.maxTotalMs!==void 0&&s!==void 0&&Date.now()-s+i>n.maxTotalMs))throw h;await vF(i)}}async function Oh(t,e){let n=new Promise((i,s)=>{setTimeout(()=>{s(new Error("Execution aborted due to timeout."))},e)});return await Promise.race([t,n])}function gu(t){return{checkpoint_id:t.checkpointId,added_blobs:t.addedBlobs.sort(),deleted_blobs:t.deletedBlobs.sort()}}var Bh=class extends Error{constructor(e,n){super(`Conversion failure: ${e}. Response = ${n}`)}},pu=class t{constructor(e,n,i,s,c){this.config=e;this._auth=n;this.sessionId=i;this._userAgent=s;this._fetchFunction=c}static defaultRequestTimeoutMs=3e4;_sequenceId=new Uh;_logger=Oe("AugmentExtension");getSessionId(){return this.sessionId}createRequestId(){return vs()}async callApi(e,n,i,s,c,u,h,g){let b=n.apiToken,y=!1;if(this._auth.useOAuth){let O=await this._auth.getSession();O&&(b=O.accessToken,y=!0,u||(u=O.tenantURL))}else u||(u=n.completionURL);if(!u)throw new Error("Please configure Augment API URL");let T;try{T=new URL(i,u)}catch(O){throw this._logger.error("Augment API URL is invalid:",O),new mu}if(!T.protocol.startsWith("http"))throw new Error("Augment API URL must start with 'http://' or 'https://'");let F=JSON.stringify(s,(O,te)=>te===void 0?null:te),E=h??t.defaultRequestTimeoutMs,L=AbortSignal.timeout(E),B="POST",$,X,D;try{let O={"Content-Type":"application/json","User-Agent":this._userAgent,"x-request-id":`${e}`,"x-request-session-id":`${this.sessionId}`,"x-api-version":"2"};b&&(O.Authorization=`Bearer ${b}`),X=Date.now(),$=await Oh(this._fetchFunction(T.toString(),{method:B,headers:O,body:F,signal:L}),E),D=Date.now()}catch(O){throw O instanceof Error?(this._logger.error(`API request ${e} to ${T.toString()} failed: ${De(O,!0)}`),Mt.transientIssue(O.message)):(this._logger.debug(`API request ${e} to ${T.toString()} failed`),O)}if(g&&(g.rpcStart=X,g.rpcEnd=D),!$.ok)throw $.status===499?Mt.fromResponse($):($.status===401&&y&&this._auth.removeSession(),$.status===400&&n.enableDebugFeatures&&this._logger.error(`API request ${e} to ${T.toString()} failed: ${await $.text()}`),this._logger.error(`API request ${e} to ${T.toString()} response ${$.status}: ${$.statusText}`),Mt.fromResponse($).status===10&&this._logger.debug("object size is big"),Mt.fromResponse($));let x;try{if($.headers.get("content-length")==="0")return;x=await $.json()}catch(O){throw this._logger.error(`API request ${e} to ${T.toString()} failed to convert response to json: ${O.message}`),O}try{return c?c(x):x}catch(O){throw new Bh(De(O),JSON.stringify(x))}}async callApiStream(e,n,i,s,c=b=>b,u,h,g){let b=n.apiToken;if(this._auth.useOAuth){let x=await this._auth.getSession();x&&(b=x.accessToken,u||(u=x.tenantURL))}else u||(u=n.completionURL);if(!u)throw new Error("Please configure Augment API URL");let y;try{y=new URL(i,u)}catch(x){throw this._logger.error("Augment API URL is invalid:",x),new mu}if(!y.protocol.startsWith("http"))throw new Error("Augment API URL must start with 'http://' or 'https://'");let T=JSON.stringify(s,(x,O)=>O===void 0?null:O),F=h??t.defaultRequestTimeoutMs,E=AbortSignal.timeout(F),L="POST",B;try{let x={"Content-Type":"application/json","User-Agent":this._userAgent,"x-request-id":`${e}`,"x-request-session-id":`${g??this.sessionId}`};b&&(x.Authorization=`Bearer ${b}`),B=await Oh(this._fetchFunction(y.toString(),{method:L,headers:x,body:T,signal:E}),F)}catch(x){throw x instanceof Error?(this._logger.error(`API request ${e} to ${y.toString()} failed: ${De(x,!0)}`),x.stack&&this._logger.error(x.stack),Mt.transientIssue(x.message)):x}if(!B.ok)throw B.status===499?Mt.fromResponse(B):(B.status===401&&this._auth.removeSession(),B.status===400&&n.enableDebugFeatures&&this._logger.error(`API request ${e} to ${y.toString()} failed: ${await B.text()}`),this._logger.error(`API request ${e} to ${y.toString()} response ${B.status}: ${B.statusText}`),Mt.fromResponse(B).status===10&&this._logger.debug(`object size is ${s?ou(s):0} `),Mt.fromResponse(B));let $=B.body.getReader(),X=this._logger;async function*D(x){let O=new TextDecoder,te="";for(;;){let{value:_e,done:Be}=await x.read(new Uint8Array);if(Be)return;for(te+=O.decode(_e,{stream:!0});te.includes(`
`);){let Ye=te.indexOf(`
`),kt=te.substring(0,Ye);te=te.substring(Ye+1);try{let we=JSON.parse(kt);yield c(we)}catch(we){X.error(`JSON parse failed for ${kt}: ${De(we)}`)}}}}return D($)}_toCompletionItem(e){if(typeof e.text!="string")throw new Error(`Completion item text is not a string: ${JSON.stringify(e)}`);if(e.skipped_suffix!==void 0&&typeof e.skipped_suffix!="string")throw new Error(`Completion item skipped suffix is not a string: ${JSON.stringify(e)}`);if(e.suffix_replacement_text!==void 0&&typeof e.suffix_replacement_text!="string")throw new Error(`Completion item suffix replacement text is not a string: ${JSON.stringify(e)}`);return{text:e.text,suffixReplacementText:e.suffix_replacement_text??"",skippedSuffix:e.skipped_suffix??"",filterScore:e.filter_score??void 0}}_extractCompletions(e){return Array.isArray(e.completion_items)?e.completion_items.map(n=>this._toCompletionItem(n)):Array.isArray(e.completions)?ko("BackCompletionResult","completions",e.completions).map(i=>({text:i,suffixReplacementText:"",skippedSuffix:""})):[{text:gn("BackCompletionResult","text",e.text),suffixReplacementText:"",skippedSuffix:""}]}toCompleteResult(e){let n=this._extractCompletions(e),i=ko("BackCompletionResult","unknown_blob_names/unknown_memory_names",e.unknown_blob_names??e.unknown_memory_names),s=e.checkpoint_not_found===void 0?!1:yh("BackCompletionResult","checkpoint_not_found",e.checkpoint_not_found,!1);return{completionItems:n,unknownBlobNames:i,checkpointNotFound:s,suggestedPrefixCharCount:e.suggested_prefix_char_count,suggestedSuffixCharCount:e.suggested_suffix_char_count,completionTimeoutMs:e.completion_timeout_ms}}toCheckpointBlobsResult(e){return{newCheckpointId:gn("BackCheckpointBlobsResult","new_checkpoint_id",e.new_checkpoint_id)}}async complete(e,n,i,s,c,u,h,g,b,y,T,F,E){let L=this.config,B={recent_changes:b},$={model:L.modelName,prompt:n,suffix:i,path:s,blob_name:c,prefix_begin:u?.prefixBegin,cursor_position:u?.cursorPosition,suffix_end:u?.suffixEnd,lang:h,blobs:gu(g),recency_info:B,probe_only:F,sequence_id:this._sequenceId.next(),filter_threshold:L.completions.filterThreshold,edit_events:this.toFileDiffsPayload(y??[])};return await this.callApi(e,L,"completion",$,X=>this.toCompleteResult(X),void 0,T,E)}async checkpointBlobs(e){let n=this.createRequestId(),i=this.config,s={blobs:gu(e)},c=await this.callApi(n,i,"checkpoint-blobs",s,u=>this.toCheckpointBlobsResult(u));for(let u of this.getUniqueExtraURLs())(await this.callApi(n,i,"checkpoint-blobs",s,g=>this.toCheckpointBlobsResult(g),u)).newCheckpointId!==c.newCheckpointId&&this._logger.error(`Checkpoint blobs API returned different checkpoint IDs for ${u}`);return c}toVCSChangePayload(e){return{working_directory_changes:e.workingDirectory.map(n=>({before_path:n.beforePath,after_path:n.afterPath,change_type:n.changeType,head_blob_name:n.headBlobName,indexed_blob_name:n.indexedBlobName,current_blob_name:n.currentBlobName}))}}toFileDiffsPayload(e){return[]}getUniqueExtraURLs(){return new Set}toMemorizeResult(e){return{blobName:e.blob_name!==void 0?gn("BackMemorizeResult","blob_name",e.blob_name):gn("BackMemorizeResult","mem_object_name",e.mem_object_name)}}async memorize(e,n,i,s,c){let u=this.createRequestId(),h=this.config,g=await this.callApi(u,h,"memorize",{model:h.modelName,path:e,t:n,blob_name:i,metadata:s,timeout_ms:c},b=>this.toMemorizeResult(b));for(let b of this.getUniqueExtraURLs())await this.callApi(u,h,"memorize",{model:h.modelName,path:e,t:n,blob_name:i,metadata:s},y=>this.toMemorizeResult(y),b);return g}toBatchUploadResult(e){return{blobNames:e.blob_names}}async batchUpload(e){let n=this.createRequestId(),i=this.config;try{let s=await this.callApi(n,i,"batch-upload",{blobs:e.map(c=>({blob_name:c.blobName,path:c.pathName,content:c.text}))},this.toBatchUploadResult.bind(this));for(let c of this.getUniqueExtraURLs())await this.callApi(n,i,"batch-upload",{blobs:e.map(u=>({blob_name:u.blobName,path:u.pathName,content:u.text}))},this.toBatchUploadResult.bind(this),c);return s}catch(s){if(!Mt.isAPIErrorWithStatus(s,4))throw s;let c=[];for(let u of e){let h=await this.memorize(u.pathName,u.text,u.blobName,u.metadata);c.push(h.blobName)}return{blobNames:c}}}toFindMissingResult(e){return{unknownBlobNames:ko("BackFindMissingResult","unknown_memory_names",e.unknown_memory_names),nonindexedBlobNames:ko("BackFindMissingResult","nonindexed_blob_names",e.nonindexed_blob_names)}}async findMissing(e){let n=this.config,i=this.createRequestId(),s=n.modelName,c=[...e].sort(),u=await this.callApi(i,n,"find-missing",{model:s,mem_object_names:c},h=>this.toFindMissingResult(h));for(let h of this.getUniqueExtraURLs()){let g=await this.callApi(i,n,"find-missing",{model:s,mem_object_names:c},b=>this.toFindMissingResult(b),h);u.unknownBlobNames=u.unknownBlobNames.concat(g.unknownBlobNames),u.nonindexedBlobNames=u.nonindexedBlobNames.concat(g.nonindexedBlobNames)}return u}async resolveCompletions(e){let n=this.createRequestId(),i=this.config;return await this.callApi(n,i,"resolve-completions",{client_name:"vscode-extension",resolutions:e})}toChatResult(e){let n=gn("BackChatResult","text",e.text),i=e.unknown_blob_names===void 0?[]:ko("BackChatResult","unknown_blob_names",e.unknown_blob_names),s=e.checkpoint_not_found===void 0?!1:yh("BackChatResult","checkpoint_not_found",e.checkpoint_not_found,!1),c=e.workspace_file_chunks===void 0?[]:e.workspace_file_chunks.map(h=>({charStart:ui("BackWorkspaceFileChunk","char_start",h.char_start),charEnd:ui("BackWorkspaceFileChunk","char_end",h.char_end),blobName:gn("BackWorkspaceFileChunk","blob_name",h.blob_name)})),u=e.nodes===void 0?[]:e.nodes.map(h=>({id:ui("BackChatResultNode","id",h.id),type:ui("BackChatResultNode","type",h.type),content:gn("BackChatResultNode","content",h.content)}));return{text:n,unknownBlobNames:i,checkpointNotFound:s,workspaceFileChunks:c,nodes:u}}async chat(e,n,i,s,c,u,h,g,b,y,T,F,E,L){let B=this.config,$={model:h??B.chat.model,path:E,prefix:T,selected_code:y,suffix:F,message:n,chat_history:i,lang:L,blobs:gu(s),user_guided_blobs:c,external_source_ids:u,context_code_exchange_request_id:b,vcs_change:{working_directory_changes:[]},recency_info_recent_changes:g,feature_detection_flags:{support_raw_output:!0}};return await this.callApi(e,B,"chat",$,X=>this.toChatResult(X),B.chat.url,12e4)}async chatStream(e,n,i,s,c,u,h,g,b,y,T,F,E,L,B,$,X,D){let x=this.config,O={model:h??x.chat.model,path:E,prefix:T,selected_code:y,suffix:F,message:n,chat_history:i,lang:L,blobs:gu(s),user_guided_blobs:c,context_code_exchange_request_id:b,vcs_change:{working_directory_changes:[]},recency_info_recent_changes:g,external_source_ids:u,disable_auto_external_sources:$,user_guidelines:X,workspace_guidelines:D,feature_detection_flags:{support_raw_output:!0}};return await br(()=>this.callApiStream(e,x,"chat-stream",O,this.toChatResult.bind(this),x.chat.url,12e4,B),this._logger,{initialMS:250,mult:2,maxMS:5e3,maxTries:5,maxTotalMs:5e3})}toModel(e){let n=e.completion_timeout_ms!==void 0?ui("BackModelInfo","completion_timeout_ms",e.completion_timeout_ms):void 0;return{name:gn("BackModelInfo","name",e.name),suggestedPrefixCharCount:ui("BackModelInfo","suggested_prefix_char_count",e.suggested_prefix_char_count),suggestedSuffixCharCount:ui("BackModelInfo","suggested_suffix_char_count",e.suggested_suffix_char_count),completionTimeoutMs:n}}toLanguage(e){let n=gn("BackLanguageInfo","name",e.name),i=gn("BackLanguageInfo","vscodeName",e.vscode_name);ws("BackLanguageInfo","extensions",e.extensions);let s=[];for(let c of e.extensions)s.push(gn("BackLanguageInfo","extensions",c));return{name:n,vscodeName:i,extensions:s}}toGetModelsResult(e){let n=gn("BackGetModelsResult","default_model",e.default_model);ws("BackGetModelsResult","models",e.models);let i=[];for(let u of e.models)i.push(this.toModel(u));let s=vh;if(e.feature_flags!==void 0){let u=e.feature_flags.git_diff_polling_freq_msec;u!==void 0&&u>0&&(s.gitDiff=!0,s.gitDiffPollingFrequencyMSec=u),e.feature_flags.small_sync_threshold!==void 0&&(s.smallSyncThreshold=e.feature_flags.small_sync_threshold),e.feature_flags.big_sync_threshold!==void 0&&(s.bigSyncThreshold=e.feature_flags.big_sync_threshold),e.feature_flags.enable_workspace_manager_ui_launch!==void 0&&(s.enableWorkspaceManagerUi=e.feature_flags.enable_workspace_manager_ui_launch),e.feature_flags.enable_instructions!==void 0&&(s.enableInstructions=e.feature_flags.enable_instructions),e.feature_flags.enable_smart_paste!==void 0&&(s.enableSmartPaste=e.feature_flags.enable_smart_paste),e.feature_flags.enable_smart_paste_min_version!==void 0&&(s.enableSmartPasteMinVersion=e.feature_flags.enable_smart_paste_min_version),e.feature_flags.enable_view_text_document!==void 0&&(s.enableViewTextDocument=e.feature_flags.enable_view_text_document),e.feature_flags.bypass_language_filter!==void 0&&(s.bypassLanguageFilter=e.feature_flags.bypass_language_filter),e.feature_flags.additional_chat_models!==void 0&&(s.additionalChatModels=e.feature_flags.additional_chat_models),e.feature_flags.enable_hindsight!==void 0&&(s.enableHindsight=e.feature_flags.enable_hindsight),e.feature_flags.max_upload_size_bytes!==void 0&&(s.maxUploadSizeBytes=e.feature_flags.max_upload_size_bytes),e.feature_flags.vscode_next_edit_min_version!==void 0&&(s.vscodeNextEditMinVersion=e.feature_flags.vscode_next_edit_min_version),e.feature_flags.vscode_flywheel_min_version!==void 0&&(s.vscodeFlywheelMinVersion=e.feature_flags.vscode_flywheel_min_version),e.feature_flags.vscode_external_sources_in_chat_min_version!==void 0&&(s.vscodeExternalSourcesInChatMinVersion=e.feature_flags.vscode_external_sources_in_chat_min_version),e.feature_flags.vscode_share_min_version!==void 0&&(s.vscodeShareMinVersion=e.feature_flags.vscode_share_min_version),e.feature_flags.max_trackable_file_count!==void 0&&(s.maxTrackableFileCount=e.feature_flags.max_trackable_file_count),e.feature_flags.max_trackable_file_count_without_permission!==void 0&&(s.maxTrackableFileCountWithoutPermission=e.feature_flags.max_trackable_file_count_without_permission),e.feature_flags.min_uploaded_percentage_without_permission!==void 0&&(s.minUploadedPercentageWithoutPermission=e.feature_flags.min_uploaded_percentage_without_permission),e.feature_flags.vscode_sources_min_version!==void 0&&(s.vscodeSourcesMinVersion=e.feature_flags.vscode_sources_min_version),e.feature_flags.vscode_chat_hint_decoration_min_version!==void 0&&(s.vscodeChatHintDecorationMinVersion=e.feature_flags.vscode_chat_hint_decoration_min_version),e.feature_flags.next_edit_debounce_ms!==void 0&&(s.nextEditDebounceMs=e.feature_flags.next_edit_debounce_ms),e.feature_flags.enable_completion_file_edit_events!==void 0&&(s.enableCompletionFileEditEvents=e.feature_flags.enable_completion_file_edit_events),e.feature_flags.vscode_enable_cpu_profile!==void 0&&(s.vscodeEnableCpuProfile=e.feature_flags.vscode_enable_cpu_profile),e.feature_flags.verify_folder_is_source_repo!==void 0&&(s.verifyFolderIsSourceRepo=e.feature_flags.verify_folder_is_source_repo),e.feature_flags.refuse_to_sync_home_directories!==void 0&&(s.refuseToSyncHomeDirectories=e.feature_flags.refuse_to_sync_home_directories),e.feature_flags.enable_file_limits_for_syncing_permission!==void 0&&(s.enableFileLimitsForSyncingPermission=e.feature_flags.enable_file_limits_for_syncing_permission),e.feature_flags.enable_chat_mermaid_diagrams!==void 0&&(s.enableChatMermaidDiagrams=e.feature_flags.enable_chat_mermaid_diagrams),e.feature_flags.enable_summary_titles!==void 0&&(s.enableSummaryTitles=e.feature_flags.enable_summary_titles),e.feature_flags.vscode_new_threads_menu_min_version!==void 0&&(s.vscodeNewThreadsMenuMinVersion=e.feature_flags.vscode_new_threads_menu_min_version),e.feature_flags.vscode_editable_history_min_version!==void 0&&(s.vscodeEditableHistoryMinVersion=e.feature_flags.vscode_editable_history_min_version)}let c=[];if(e.languages!==void 0){ws("BackGetModelsResult","languages",e.languages),c=[];for(let u of e.languages)c.push(this.toLanguage(u))}return{defaultModel:n,models:i,languages:c,featureFlags:s}}async getModelConfig(){let e=this.config,n=this.createRequestId();return await this.callApi(n,e,"get-models",{},s=>this.toGetModelsResult(s))}async getAccessToken(e,n,i,s){let c=this.config,u=this.createRequestId(),h={grant_type:"authorization_code",client_id:c.oauth.clientID,code_verifier:i,redirect_uri:e,code:s};return await this.callApi(u,c,"token",h,g=>g.access_token,n)}async clientMetrics(e){let n=this.config,i=this.createRequestId();await this.callApi(i,n,"client-metrics",{metrics:e},void 0,void 0,t.defaultRequestTimeoutMs)}},mu=class extends Error{constructor(){super("The completion URL setting is invalid")}},Uh=class{_sequenceId=0;next(){return this._sequenceId++}};var Ts=Tt(bu()),_u=class{constructor(e,n){this.name=e;this._logger=n}_isSet=!1;_value;get value(){return this._value}update(e){return this._isSet&&(0,Ts.isEqual)(e,this._value)?!1:(this._isSet?this._logger.info(`${this.name} changed:
${this.diff(this.value,e).map(n=>`  - ${n}`).join(`
`)}`):this._logger.info(`${this.name} changed from <unset> to ${this._formatValue(e)}`),this._value=(0,Ts.cloneDeep)(e),this._isSet=!0,!0)}diff(e,n,i=[]){if((0,Ts.isEqual)(n,e))return[];if(!this.isObject(n)||!this.isObject(e))return[`${this._formatValue(e)} to ${this._formatValue(n)}`];let s=new Set([...Object.keys(e||{}),...Object.keys(n||{})]),c=[];for(let u of s){let h=n?n[u]:void 0,g=e?e[u]:void 0;!this.isObject(h)||!this.isObject(g)?h!==g&&c.push(`${i.concat(u).join(" > ")}: ${this._formatValue(g)} to ${this._formatValue(h)}`):c.push(...this.diff(g,h,i.concat(u)))}return c}isObject(e){return typeof e=="object"&&e!==null}toString(){return this._isSet?this._formatValue(this.value):"<unset>"}_formatValue(e){return e===void 0?"undefined":JSON.stringify(e)}};var tr=class{_disposables=[];add(e){if(e===void 0)throw new Error("Attempt to add undefined disposable to DisposableCollection");return this._disposables.push(e),e}addAll(...e){e.forEach(n=>this.add(n))}adopt(e){this._disposables.push(...e._disposables),e._disposables.length=0}dispose(){for(let e of this._disposables)e.dispose();this._disposables.length=0}},yt=class{_disposables=new tr;_priorityDisposables=new tr;constructor(e=new tr,n=new tr){this._disposables.adopt(e),this._priorityDisposables.adopt(n)}addDisposable(e,n=!1){return n?this._priorityDisposables.add(e):this._disposables.add(e)}addDisposables(...e){this._disposables.addAll(...e)}dispose(){this._priorityDisposables.dispose(),this._disposables.dispose()}};var yF={Augment:null},vu=class t extends yt{_config;_configChanged=new Ve;_configMonitor;_logger=Oe("AugmentConfigListener");constructor(){super(),this._configMonitor=new _u("Config",this._logger),this._refreshConfig(),this.addDisposable(Lh.onDidChangeConfiguration(()=>this._refreshConfig()))}get config(){return this._config}get onDidChange(){return this._configChanged.event}_refreshConfig(){let e=this._config;this._config=t.normalizeConfig(this._getUserConfig()),this._configMonitor.update(this._config)&&this._configChanged.fire({previousConfig:e,newConfig:this._config})}static normalizeConfig(e){return{apiToken:e.advanced.apiToken,completionURL:e.advanced.completionURL,modelName:e.advanced.model,conflictingCodingAssistantCheck:e.conflictingCodingAssistantCheck,codeInstruction:{model:e.advanced.codeInstruction.model||void 0},chat:{url:e.advanced.chat.url||void 0,model:e.advanced.chat.model||void 0,stream:e.advanced.chat.stream??void 0,enableEditableHistory:e.advanced.chat.enableEditableHistory??!1,useRichTextHistory:e.advanced.chat.useRichTextHistory??!0,smartPasteUsePrecomputation:e.advanced.chat.smartPasteUsePrecomputation??!0,experimentalFullFilePaste:e.advanced.chat.experimentalFullFilePaste??!1,modelDisplayNameToId:e.advanced.chat.modelDisplayNameToId||yF,userGuidelines:e.chat.userGuidelines||""},autofix:{enabled:e.advanced.autofix.enabled,locationUrl:e.advanced.autofix.locationUrl||void 0,autofixUrl:e.advanced.autofix.autofixUrl||void 0},oauth:{clientID:e.advanced.oauth.clientID||"augment-vscode-extension",url:e.advanced.oauth.url||"https://auth.augmentcode.com"},enableUpload:e.advanced.enableWorkspaceUpload,enableShortcutsAboveSelectedText:e.enableShortcutsAboveSelectedText,shortcutsDisplayDelayMS:e.shortcutsDisplayDelayMS,enableEmptyFileHint:e.enableEmptyFileHint,enableBackgroundSuggestions:e.enableBackgroundSuggestions,enableGlobalBackgroundSuggestions:e.enableGlobalBackgroundSuggestions,showAllBackgroundSuggestionLineHighlights:e.showAllBackgroundSuggestionLineHighlights,enableDataCollection:e.advanced.enableDataCollection,enableDebugFeatures:e.advanced.enableDebugFeatures,enableReviewerWorkflows:e.advanced.enableReviewerWorkflows,completions:{enableAutomaticCompletions:e.completions.enableAutomaticCompletions,disableCompletionsByLanguage:new Set(e.completions.disableCompletionsByLanguage),enableQuickSuggestions:e.completions.enableQuickSuggestions,timeoutMs:e.advanced.completions.timeoutMs,maxWaitMs:e.advanced.completions.maxWaitMs,addIntelliSenseSuggestions:e.advanced.completions.addIntelliSenseSuggestions,filterThreshold:e.advanced.completions.filterThreshold},openFileManagerV2:{enabled:e.advanced.openFileManagerV2.enabled},nextEdit:{enabled:e.advanced.nextEdit.enabled,backgroundEnabled:e.advanced.nextEdit.backgroundEnabled,url:e.advanced.nextEdit.url,locationUrl:e.advanced.nextEdit.locationUrl||e.advanced.nextEdit.url,generationUrl:e.advanced.nextEdit.generationUrl||e.advanced.nextEdit.url,showInstructionTextbox:e.advanced.nextEdit.showInstructionTextbox,model:e.advanced.nextEdit.model,useDebounceMs:e.advanced.nextEdit.useDebounceMs,useCursorDecorations:e.advanced.nextEdit.useCursorDecorations,useSmallHover:e.advanced.nextEdit.useSmallHover,noDiffMode:e.advanced.nextEdit.noDiffMode,animateNoDiffMode:e.advanced.nextEdit.animateNoDiffMode,allowDuringDebugging:e.advanced.nextEdit.allowDuringDebugging,useMockResults:e.advanced.nextEdit.useMockResults,noDiffModeUseCodeLens:e.advanced.nextEdit.noDiffModeUseCodeLens,showDiffByDefault:e.advanced.nextEdit.showDiffByDefault},recencySignalManager:e.advanced.recencySignalManager,preferenceCollection:{enable:e.advanced.preferenceCollection.enable,enableRetrievalDataCollection:e.advanced.preferenceCollection.enableRetrievalDataCollection,enableRandomizedMode:e.advanced.preferenceCollection.enableRandomizedMode},vcs:{watcherEnabled:e.advanced.vcs.watcherEnabled},smartPaste:{url:e.advanced.smartPaste?.url,model:e.advanced.smartPaste?.model},instructions:{model:e.advanced.instructions?.model}}}_getUserConfig(){let e=Lh.getConfiguration("augment");return t.normalizeUserConfig(e)}static normalizeUserConfig(e){return{completions:{enableAutomaticCompletions:ct(e.enableAutomaticCompletions??e.completions?.enableAutomaticCompletions,!0),disableCompletionsByLanguage:e.disableCompletionsByLanguage||e.completions?.disableCompletionsByLanguage||[],enableQuickSuggestions:ct(e.completions?.enableQuickSuggestions,!0)},chat:{userGuidelines:e.chat?.userGuidelines||""},enableShortcutsAboveSelectedText:ct(e.enableShortcutsAboveSelectedText,!1),shortcutsDisplayDelayMS:wF(e.shortcutsDisplayDelayMS,2e3),enableEmptyFileHint:ct(e.enableEmptyFileHint,!0),enableBackgroundSuggestions:ct(e.enableBackgroundSuggestions,!0),enableGlobalBackgroundSuggestions:ct(e.enableGlobalBackgroundSuggestions,!1),showAllBackgroundSuggestionLineHighlights:ct(!e.advanced?.nextEdit?.noDiffMode,!e.advanced?.nextEdit?.noDiffMode),conflictingCodingAssistantCheck:ct(e.conflictingCodingAssistantCheck,!0),advanced:{apiToken:(e.advanced?.apiToken||e.apiToken||"").trim().toUpperCase(),completionURL:(e.advanced?.completionURL||e.completionURL||"").trim(),enableWorkspaceUpload:ct(e.advanced?.enableWorkspaceUpload,!0),model:e.advanced?.model||"",enableDebugFeatures:ct(e.advanced?.enableDebugFeatures,!1),enableReviewerWorkflows:ct(e.advanced?.enableReviewerWorkflows,!1),enableDataCollection:ct(e.advanced?.enableDataCollection,!1),codeInstruction:{model:e.advanced?.codeInstruction?.model||void 0},chat:{url:e.advanced?.chat?.url||void 0,model:e.advanced?.chat?.model||void 0,stream:e.advanced?.chat?.stream??void 0,enableEditableHistory:e.advanced?.chat?.enableEditableHistory,useRichTextHistory:e.advanced?.chat?.useRichTextHistory,smartPasteUsePrecomputation:e.advanced?.chat?.smartPasteUsePrecomputation,modelDisplayNameToId:e.advanced?.chat?.modelDisplayNameToId,experimentalFullFilePaste:e.advanced?.chat?.experimentalFullFilePaste},autofix:{enabled:ct(e.advanced?.autofix?.enabled,!1),locationUrl:e.advanced?.autofix?.locationUrl||void 0,autofixUrl:e.advanced?.autofix?.autofixUrl||void 0},oauth:{clientID:e.advanced?.oauth?.clientID,url:e.advanced?.oauth?.url},completions:{timeoutMs:e.advanced?.completions?.timeoutMs??800,maxWaitMs:e.advanced?.completions?.maxWaitMs??1600,addIntelliSenseSuggestions:e.advanced?.completions?.addIntelliSenseSuggestions??!0,filterThreshold:e.advanced?.completions?.filter_threshold??void 0},openFileManagerV2:{enabled:ct(e.advanced?.openFileManager?.useV2,!1)},nextEdit:{enabled:e.advanced?.nextEdit?.enabled,backgroundEnabled:ct(e.advanced?.nextEdit?.backgroundEnabled,!0),url:e.advanced?.nextEdit?.url,locationUrl:e.advanced?.nextEdit?.locationUrl,generationUrl:e.advanced?.nextEdit?.generationUrl,showInstructionTextbox:ct(e.advanced?.nextEdit?.showInstructionTextbox,!1),model:e.advanced?.nextEdit?.model,useDebounceMs:e.advanced?.nextEdit?.useDebounceMs,useCursorDecorations:ct(e.advanced?.nextEdit?.useCursorDecorations,!1),useSmallHover:ct(e.advanced?.nextEdit?.useSmallHover,!0),noDiffMode:e.advanced?.nextEdit?.noDiffMode,animateNoDiffMode:e.advanced?.nextEdit?.animateNoDiffMode,showDiffByDefault:e.advanced?.nextEdit?.showDiffByDefault,allowDuringDebugging:ct(e.advanced?.nextEdit?.allowDuringDebugging,!1),useMockResults:ct(e.advanced?.nextEdit?.useMockResults,!1),noDiffModeUseCodeLens:ct(e.advanced?.nextEdit?.noDiffModeUseCodeLens,!1)},recencySignalManager:{collectTabSwitchEvents:e.advanced?.recencySignalManager?.collectTabSwitchEvents??!1},preferenceCollection:{enable:ct(e.advanced?.preferenceCollection?.enable,!1),enableRetrievalDataCollection:ct(e.advanced?.preferenceCollection?.enableRetrievalDataCollection,!1),enableRandomizedMode:ct(e.advanced?.preferenceCollection?.enableRandomizedMode,!0)},vcs:{watcherEnabled:ct(e.advanced?.vcs?.watcherEnabled,!1)},smartPaste:{url:e.advanced?.smartPaste?.url,model:e.advanced?.smartPaste?.model},instructions:{model:e.advanced?.instructions?.model}}}}};function ct(t,e){return t==null?e:typeof t=="string"?t.toLowerCase()!=="false":!!t}function wF(t,e){return t==null?e:typeof t=="string"?parseInt(t):t}var $P=Tt(bu()),yu="augment.sessions",UP=["email"],wu=class{constructor(e,n){this._context=e;this._config=n}_isLoggedIn;get useOAuth(){let e=this._config;return!!e.oauth&&!!e.oauth.url&&!!e.oauth.clientID&&!e.apiToken&&!e.completionURL}async initState(){this._isLoggedIn=!!await this.getSession()}get isLoggedIn(){return this._isLoggedIn}async saveSession(e,n){await this._context.secrets.store(yu,JSON.stringify({accessToken:e,tenantURL:n,scopes:UP})),this._isLoggedIn=!0}async getSession(){let e=await this._context.secrets.get(yu);if(e){let n=JSON.parse(e);if((0,$P.isEqual)(n.scopes,UP))return n}return null}async removeSession(){await this._context.secrets.get(yu)&&(await this._context.secrets.delete(yu),this._isLoggedIn=!1)}};var Mo=require("crypto"),$h=require("url");var PF=["email"],Pu="augment.oauth-state",xF=".augmentcode.com",SF=10,xu=class{constructor(e,n,i,s){this._context=e;this._config=n;this._apiServer=i;this._authSession=s;this.authRedirectURI=ht.from({scheme:"vscode",authority:"augment.vscode-augment",path:"/auth/result"})}_logger=Oe("OAuthFlow");authRedirectURI;async startFlow(){return this._logger.info("Creating new session..."),(await this.login()).toString(!0)}async createOAuthState(){this._logger.info("Creating OAuth state");let e=WP((0,Mo.randomBytes)(32)),n=WP(CF(Buffer.from(e))),i=(0,Mo.randomUUID)(),s={codeVerifier:e,codeChallenge:n,state:i,creationTime:new Date().getTime()};return await this._context.secrets.store(Pu,JSON.stringify(s)),this._logger.info("Created OAuth state"),s}async getOAuthState(){this._logger.info("Getting OAuth state");let e=await this._context.secrets.get(Pu);if(e){let n=JSON.parse(e);if(new Date().getTime()-n.creationTime<SF*60*1e3)return n}return null}async removeOAuthState(){this._logger.info("Removing OAuth state"),await this._context.secrets.get(Pu)&&await this._context.secrets.delete(Pu)}async login(){try{let e=await this.createOAuthState();return this.generateAuthorizeURL(e)}catch(e){throw await this.removeOAuthState(),e}}generateAuthorizeURL(e){let n=PF.join(" "),i=new URLSearchParams({response_type:"code",code_challenge:e.codeChallenge,code_challenge_method:"S256",client_id:this._config.oauth.clientID||"",redirect_uri:"",state:e.state,scope:n,prompt:"login"}),s=new $h.URL(`/authorize?${i.toString()}`,this._config.oauth.url);return ht.parse(s.toString())}async processAuthRedirect(e){let n=new URLSearchParams(e.query),i=n.get("state");if(!i)throw new Error("No state");let s=await this.getOAuthState();if(!s)throw new Error("No OAuth state found");if(await this.removeOAuthState(),s.state!==i)throw new Error("Unknown state");let c=n.get("error");if(c){let g=[`(${c})`],b=n.get("error_description");throw b&&g.push(b),new Error(`OAuth request failed: ${g.join(" ")}`)}let u=n.get("code");if(!u)throw new Error("No code");let h=n.get("tenant_url");if(h){if(!new $h.URL(h).hostname.endsWith(xF))throw new Error("OAuth request failed: invalid OAuth tenant URL")}else throw new Error("No tenant URL");try{this._logger.info("Calling get access token to retrieved access token");let g=await this._apiServer.getAccessToken("",h,s.codeVerifier,u);await this._authSession.saveSession(g,h),this._logger.info("Successfully retrieved access token")}catch(g){throw this._logger.error(`Failed to get and save access token: ${De(g)}`),new Error(`If you have a firewall, please add "${h}" to your allowlist.`)}}async handleAuthURI(e){try{await this.processAuthRedirect(e)}catch(n){this._logger.warn("Failed to process auth request:",n)}}async handleAuthJson(e){let n=JSON.parse(e);if(!await this.getOAuthState())throw new Error("No OAuth state found");let s=this.authRedirectURI.with({query:`code=${n.code}&state=${n.state}&tenant_url=${n.tenant_url}`});return await this.processAuthRedirect(s),"success"}};function WP(t){return t.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function CF(t){return(0,Mo.createHash)("sha256").update(t).digest()}var wx=require("console"),Px=require("crypto");var Su=class t{constructor(e,n,i,s,c=t.chunkSize){this._apiServer=e;this._completionTimeoutMs=n,this._completionParams={prefixSize:i,suffixSize:s,chunkSize:c}}static chunkSize=1024;_completionTimeoutMs;_completionParams;createRequestId(){return this._apiServer.createRequestId()}get completionParams(){return this._completionParams}async complete(e,n,i,s,c,u,h,g,b,y,T,F,E){let L=await this._apiServer.complete(e,n,i,s,c,u,h,g,b,y,T,F,E);return L.completionTimeoutMs!==void 0&&(this._completionTimeoutMs=L.completionTimeoutMs),L.suggestedPrefixCharCount!==void 0&&(this._completionParams.prefixSize=L.suggestedPrefixCharCount),L.suggestedSuffixCharCount!==void 0&&(this._completionParams.suffixSize=L.suggestedSuffixCharCount),L.suggestedPrefixCharCount!==void 0&&(this._completionParams.chunkSize=t.chunkSize),L}};function kF(t,e,n,i,s,c,u){return{blob_name:t,path:e,char_start:n,char_end:i,replacement_text:s,present_in_blob:c,expected_blob_name:u}}function jP(t){return t.map(e=>kF(e.blobName,e.pathName,e.origStart,e.origStart+e.origLength,e.text,e.uploaded,e.expectedBlobName))}var Cu=class{constructor(e,n,i,s){this.completionText=e;this.suffixReplacementText=n;this.skippedSuffix=i;this.range=s}toString(){return`text: ${this.completionText}
    suffixReplacementText: ${this.suffixReplacementText}
    skippedSuffix: ${this.skippedSuffix}
    start: ${this.range.startOffset}
    end: ${this.range.endOffset}`}};var ku=class{constructor(e,n){this._extension=e;this._configListener=n}_logger=Oe("CompletionsModel");_completionSerial=0;async generateCompletion(e,n,i){let s=this._extension.workspaceManager;if(s===void 0)return;let c=s.completionServer,u=c.createRequestId(),h=s.safeResolvePathName(e.uri);if(h===void 0)return;let[g,b]=[h.rootPath,h.relPath],y=e.offsetAt(n),[T,F,E,L,B]=this._extractPrefixAndSuffix(e,y);y+=B;let $={prefixBegin:E,cursorPosition:y,suffixEnd:L},D=(await this._requestCompletion(s,c,u,e,T,F,$,h,i)).completionItems;if(D.length===0)return{completions:[],document:e,requestId:u,repoRoot:g,pathName:b,prefix:T,suffix:F,occuredAt:new Date,isReused:!1};D.length>1&&this._logger.warn("Multiple completions not supported, ignoring all but the first");let x=[],te=D[0];return te.skippedSuffix.includes(`
`)&&(this._logger.debug("Skipped suffix spans multiple lines, dropping it"),te.skippedSuffix="",te.suffixReplacementText=""),x.push(new Cu(te.text,te.suffixReplacementText,te.skippedSuffix,{startOffset:e.offsetAt(n),endOffset:e.offsetAt(n)})),this._logger.debug(`Returning ${x.length} completion(s)`),{occuredAt:new Date,completions:x,document:e,requestId:u,repoRoot:g,pathName:b,prefix:T,suffix:F,isReused:!1}}async _requestCompletion(e,n,i,s,c,u,h,g,b){let y=s.languageId;if(this._configListener.config.completions.disableCompletionsByLanguage.has(y))throw new Co(`Language ${y} is disabled.`);let F=this._completionSerial++;this._logger.debug(`Requesting new completion - #${F} submitted; requestId: ${i}`);let E=e.translateRange(g,h.prefixBegin,h.suffixEnd),L=E===void 0?h:{prefixBegin:E.beginOffset,cursorPosition:h.cursorPosition,suffixEnd:E.endOffset},B=e.getContext(),$=B.blobs,X=[],D=void 0;try{let x=await n.complete(i,c,u,g.relPath,E?.blobName,L,y,$,X,D,void 0,void 0,b);return x.unknownBlobNames.length>0&&e.handleUnknownBlobs(B,x.unknownBlobNames),x.checkpointNotFound&&e.handleUnknownCheckpoint(i,$.checkpointId),TF(x.completionItems,u,this._logger),this._extension.updateModelInfo(x),x.completionItems=x.completionItems.filter(O=>(O.text+O.suffixReplacementText).length>0),x}catch(x){if(Mt.isAPIErrorWithStatus(x,1))throw this._logger.debug(`Completion #${F} cancelled in back end; requestId ${i}`),new Co("Cancelled in back end");if(Mt.isRetriableAPIError(x))throw this._logger.debug(`Completion #${F} retriable error on back end; requestId ${i}`),new Co("Retriable error on back end");let O=De(x);throw this._logger.warn(`Completion #${F} failed: ${O}; requestId ${i}`),x}}_extractPrefixAndSuffix(e,n){let i=this._extension.modelInfo,s=i.suggestedPrefixCharCount,c=i.suggestedSuffixCharCount,[u,h]=[void 0,0];u!==void 0&&(n+=h);let g=Math.max(0,n-s),b=n+c;if(u!==void 0)throw new Error("Notebook support not implemented");let y=e.positionAt(g),T=e.positionAt(n),F=e.positionAt(n),E=e.positionAt(b),L=at.create(y,T),B=at.create(F,E),$=e.getText(L),X=e.getText(B);return[$,X,g,n+X.length,0]}_getRecentChanges(e){let n=e.recentChunks,i=e.lastChatResponse;if(i!==void 0){let s={seq:i.seq,uploaded:!1,repoRoot:"",pathName:"",blobName:"",text:i.text,origStart:0,origLength:0,expectedBlobName:""},c=n.findIndex(u=>u.seq<s.seq);c<0&&(c=n.length),n=n.slice(0,c).concat([s]).concat(n.slice(c))}return jP(n)}};function TF(t,e,n){for(let i of t)e.startsWith(i.skippedSuffix)||(n.warn(`Skipped suffix does not match the actual suffix. Skipped suffix: ${i.skippedSuffix}. First ${i.skippedSuffix.length} characters of suffix: ${e.substring(0,i.skippedSuffix.length)}`),i.suffixReplacementText="",i.skippedSuffix="")}function Wh(t){let e=Math.floor(t/1e3),n=t%1e3*1e6;return[e,n]}var Ru=class{constructor(e){this._maxItems=e;this._items=new Array(e),this._emptySlots=e}_insertCount=0;_emptySlots;_items;get empty(){return this.length===0}get length(){return this._maxItems-this._emptySlots}addItem(e){this._items[this._insertCount%this._maxItems]=e,this._emptySlots=Math.max(this._emptySlots-1,0),this._insertCount++}shiftLeft(e){this._emptySlots=Math.min(this._emptySlots+e,this._maxItems)}shiftRight(e){this._insertCount-=Math.min(e,this.length),this._emptySlots=Math.min(this._emptySlots+e,this._maxItems)}at(e){if(e<0)return e<-this.length?void 0:this._items[(this._insertCount+e)%this._maxItems];if(!(e>=this.length))return this._items[(this._insertCount+this._emptySlots+e)%this._maxItems]}_normalizeSliceIdx(e){return e>=0?Math.min(e,this.length):Math.max(this.length+e,0)}_translateIdx(e){return(this._insertCount+this._emptySlots+e)%this._maxItems}slice(e,n){let i=this._normalizeSliceIdx(e??0),s=this._normalizeSliceIdx(n??this.length);if(i>s)return[];let c=s-i,u=this._translateIdx(i);return u+c<=this._maxItems?this._items.slice(u,u+c):this._items.slice(u).concat(this._items.slice(0,(u+c)%this._maxItems))}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.at(e)}clear(){this._emptySlots=this._maxItems}};var Tu=class{constructor(e,n,i,s){this._uploadMsec=i;this._uploadBatchSize=s;this._store=new Ru(n),this._logger=Oe(e)}_logger;_store;_uploadIntervalId=void 0;_currentUploadPromise;report(e){this._store.addItem(e)}get uploadEnabled(){return this._uploadIntervalId!==void 0}enableUpload(){this.uploadEnabled||(this._uploadIntervalId=setInterval(()=>{this._currentUploadPromise===void 0&&(async()=>{try{this._currentUploadPromise=this._doUpload(),await this._currentUploadPromise}finally{this._currentUploadPromise=void 0}})()},this._uploadMsec))}async _doUpload(){if(this._store.length===0)return;let e=this._store.slice();this._store.clear();for(let n=0;n<e.length;n+=this._uploadBatchSize){let i=e.slice(n,n+this._uploadBatchSize);await br(async()=>{if(this.uploadEnabled)try{return this._logger.debug(`Uploading ${i.length} metric(s)`),await this.performUpload(i)}catch(s){throw this._logger.error(`Error uploading metrics: ${s} ${s instanceof Error?s.stack:""}`),s}},this._logger)}}disableUpload(){clearInterval(this._uploadIntervalId),this._uploadIntervalId=void 0}dispose(){this.disableUpload()}};var Du=class t extends Tu{constructor(n,i,s,c){super("CompletionAcceptanceReporter",i??t.defaultMaxRecords,s??t.defaultUploadMsec,c??t.defaultBatchSize);this._apiServer=n}static defaultMaxRecords=1e4;static defaultBatchSize=1e3;static defaultUploadMsec=1e4;reportResolution(n,i,s,c){let[u,h]=Wh(i),[g,b]=Wh(s);this.report({request_id:n,emit_time_sec:u,emit_time_nsec:h,resolve_time_sec:g,resolve_time_nsec:b,accepted_idx:c??-1})}performUpload(n){return this._apiServer.resolveCompletions(n)}};var Iu=class t{constructor(e){this._extensionContext=e}static storageSubDir="augment-global-state";update(e,n){return this._extensionContext.globalState.update(e,n)}get(e){return this._extensionContext.globalState.get(e)}async save(e,n,i){await this._ensureStorageUriExists(i);let s=this._getFileUri(e,i);return await du(s.fsPath,JSON.stringify(n))}async load(e,n){await this._ensureStorageUriExists(n);let i=this._getFileUri(e,n);try{let s=await Io(i.fsPath);return JSON.parse(s)}catch{return}}async _ensureStorageUriExists(e){let n=this._getStorageUri(e);await qP(n.fsPath)||await Cs(n.fsPath)}_getStorageUri(e){return e?.uniquePerWorkspace&&this._extensionContext.storageUri?vt.joinPath(this._extensionContext.storageUri,t.storageSubDir):vt.joinPath(this._extensionContext.globalStorageUri,t.storageSubDir)}_getFileUri(e,n){return vt.joinPath(this._getStorageUri(n),`${e}.json`)}};var vx=Tt(bu());var jh=class{async read(e){try{return await LP(e)}catch{return}}stat(e){try{return xs(e)}catch{return}}};function zP(){return new jh}var HP=Tt(require("crypto"));function VP(t){let e=HP.createHash("sha256");return e.update(t),e.digest("hex")}var Zh=Tt(nx());var Ds=class{accepted=!0},di=class{accepted=!1};var rt=Tt(require("node:path"));var Is=rt.posix.sep,VF=new RegExp("/\\/g");function rx(t){return rt.isAbsolute(t)}function GF(t){return rt.sep==="\\"?t.replace(VF,Is):t}function ix(t){return GF(t)}function ox(t){return t.with({path:rt.dirname(t.fsPath)})}function Fu(t){let e=rt.dirname(t);return e==="."?"":QF(e)}function QF(t){return t.endsWith(Is)?t:t+Is}function Ao(t){for(;;){if(t===rt.sep||t===Is||!t.endsWith(Is)&&!t.endsWith(rt.sep))return t;t=t.slice(0,-1)}}function Es(t,e){let n=typeof t=="string"?t:t.fsPath,i=typeof e=="string"?e:e.fsPath;return rt.relative(n,i)}function Lr(t,e){let n=Es(t,e);return n==="."?"":n.length>0&&!n.endsWith(rt.sep)?n+rt.sep:n}function ut(t,e,n=!1){let i=rt.join(t,e);return n&&!i.endsWith(rt.sep)&&(i+=rt.sep),i}function Fs(t,e){let n=Es(t,e);if(!(n===".."||n.startsWith(".."+rt.sep)||n.startsWith(".."+rt.posix.sep)))return n}function nr(t,e){return Fs(t,e)!==void 0}function Mu(t,e){let n=Es(t,e);return n===""||n==="."||n==="."+rt.sep||n==="."+rt.posix.sep}async function Au(t,e,n){let i=typeof t=="string"?ht.file(t):t;for(;;){try{let c=vt.joinPath(i,e),u=await AP(c.fsPath);if(n===void 0||u.type===n)return i}catch{}let s=rt.dirname(i.fsPath);if(rt.relative(s,i.fsPath).length===0)return;i=i.with({path:s})}}function JF(t){return!1}function Jt(t){return Ao(t.fsPath)}function sx(t){return t.fsPath}function No(t){if(t.scheme==="file"||t.scheme==="untitled"||JF(t))return Jt(t)}var fi=class extends Ds{explicit=!1;format(){return"Tracked"}},Jh=class extends Ds{constructor(n){super();this.ignoreSourceName=n}explicit=!0;format(){return`Tracked (${this.ignoreSourceName})`}},Xh=class extends di{constructor(n){super();this.ignoreSourceName=n}explicit=!0;format(){return`Not tracked (${this.ignoreSourceName})`}},Nu=class{constructor(e,n,i,s){this.dirName=e;this.ignoreSource=n;this.rules=i;this.next=s}},Yh=class t{constructor(e,n,i){this._rootUri=e;this._ignoreSource=n;this._top=i}static async buildNew(e,n,i){let s=new Array;if(Lr(i,n)!==""){let u=n;for(;;){u=ox(u);let h=Lr(i,u),g=await e.getRules(u);if(g&&s.push([h,e,g]),h==="")break}}let c;for(let u=s.length-1;u>=0;u--){let[h,g,b]=s[u];c=new Nu(h,g,b,c)}return new t(i,e,c)}async buildAtop(e,n){let i=await this._ignoreSource.getRules(e,n);if(i===void 0)return this;let s=Lr(this._rootUri,e),c=new Nu(s,this._ignoreSource,i,this._top);return new t(this._rootUri,this._ignoreSource,c)}getPathInfo(e){for(let n=this._top;n!==void 0;n=n.next){if(!nr(n.dirName,e))throw new Error(`candidatePath "${e}" is not below ignore file's parent "${n.dirName}"`);let i=e.slice(n.dirName.length),s=n.rules.test(i);if(s.ignored)return new Xh(n.ignoreSource.getName(vt.joinPath(this._rootUri,n.dirName)));if(s.unignored)return new Jh(n.ignoreSource.getName(vt.joinPath(this._rootUri,n.dirName)))}return new fi}},Kh=class t{constructor(e,n){this._ignoreSources=e;this._ignoreStacks=n}static async buildNew(e,n,i){let s=new Array;for(let c of e){let u=await Yh.buildNew(c,n,i);s.push(u)}return new t(e,s)}async buildAtop(e,n){let i=new Array,s=0;for(let c=0;c<this._ignoreStacks.length;c++){let u=this._ignoreStacks[c],h=await u.buildAtop(e,n);h!==u&&s++,i.push(h)}return s===0?this:new t(this._ignoreSources,i)}getPathInfo(e){for(let n=this._ignoreStacks.length-1;n>=0;n--){let s=this._ignoreStacks[n].getPathInfo(e);if(s.explicit)return s}return new fi}};async function XF(t,e){let n=vt.joinPath(t,e);try{let i=await Io(n.fsPath),s=(0,Zh.default)({ignorecase:!1});return s.add(i),s}catch{}}var qo=class{constructor(e=[]){this._ignoreSources=e}async build(e,n){return await Kh.buildNew(this._ignoreSources,e,n)}},Ms=class{constructor(e){this.filename=e}getName(e){return sx(vt.joinPath(e,this.filename))}async getRules(e,n){if(!(n!==void 0&&!(n.find(([s,c])=>c==="File"&&this.filename===s)!==void 0)))return XF(e,this.filename)}},qu=class{constructor(e){this._sourceFolderRootPath=e}getName(){return"default Augment rules"}getRules(e){return new Promise(n=>{if(Jt(e)!==this._sourceFolderRootPath)n(void 0);else{let i=(0,Zh.default)({ignorecase:!1});i.add([".git","*.pem","*.key","*.pfx","*.p12","*.jks","*.keystore","*.pkcs12","*.crt","*.cer","id_rsa","id_ed25519","id_ecdsa","id_dsa",".augment-guidelines"]),n(i)}})}};var Lu=class{constructor(e){this.name=e}start=Date.now();increments=[];charge(e){this.increments.push({name:e,end:Date.now()})}*[Symbol.iterator](){let e=this.start;for(let{name:n,end:i}of this.increments)yield[n,i-e],e=i;yield["total",e-this.start]}format(){return(this.name?`${this.name}:
`:"")+Array.from(this).map(([n,i])=>`  - ${n}: ${i} ms`).join(`
`)}},Ou=class{_value=0;_add(e=1){this._value+=e}_invalidate(){this._value=Number.NaN}get value(){return this._value}},eg=class extends Ou{increment(e=1){this._add(e)}},tg=class extends Ou{_start=void 0;start(){this._start=Date.now()}stop(){this._start===void 0?this._invalidate():this._add(Date.now()-this._start)}},Lo=class{constructor(e){this.name=e}counters=new Map;timings=new Map;counterMetric(e){let n=this.counters.get(e);return n===void 0&&(n=new eg,this.counters.set(e,n)),n}timingMetric(e){let n=this.timings.get(e);return n===void 0&&(n=new tg,this.timings.set(e,n)),n}format(){let e=this.name?`${this.name}:`:"",n=Array.from(this.counters.entries()).map(([c,u])=>`  - ${c}: ${u.value}`).join(`
`),i="  - timing stats:",s=Array.from(this.timings.entries()).map(([c,u])=>`    - ${c}: ${u.value} ms`).join(`
`);return e+`
`+n+`
`+i+`
`+s}};var ax=Tt(require("os"));function cx(t){let e=ax.default.homedir();return Mu(t,e)}var As=Tt(require("node:path"));async function Uu(t,e,n,i){let s=await n.build(t,e),c=new Map;c.set("",s),c.set(".",s);let u=200,h=Date.now(),g=[];g.push([t,s]);let b;for(;(b=g.pop())!==void 0;){Date.now()-h>=u&&(await new Promise($=>setTimeout($,0)),h=Date.now());let[T,F]=b,E=Lr(e,T),L=Ss(T.fsPath),B=await F.buildAtop(T,L);B!==F&&c.set(E,B);for(let[$,X]of L){if(Date.now()-h>=u&&(await new Promise(_e=>setTimeout(_e,0)),h=Date.now()),$==="."||$===".."||X!=="Directory")continue;let x=vt.joinPath(T,$),O=ut(E,$,!0);B.getPathInfo(O).accepted&&g.push([x,B])}}return new rg(c,i)}var Oo=class{constructor(e,n,i,s){this._name=e;this._startUri=n;this._rootUri=i;this._pathFilter=s;if(!As.isAbsolute(n.fsPath))throw new Error(`PathIterator[${this._name}]: startUri ${this._name} must contain an absolute pathname`);if(!As.isAbsolute(i.fsPath))throw new Error(`PathIterator[${this._name}]: rootUri ${i.toString()} must contain an absolute pathname`);if(!nr(Jt(i),Jt(n)))throw new Error(`PathIterator[${this._name}]: startUri ${Jt(this._startUri)} must be inside rootUri ${Jt(this._rootUri)}`);this._logger.verbose(`Created PathIterator for startUri ${this._startUri.fsPath}, rootUri ${this._rootUri.fsPath}`)}stats=new Lo("Path metrics");_logger=Oe("PathIterator");_dirsEmitted=this.stats.counterMetric("directories emitted");_filesEmitted=this.stats.counterMetric("files emitted");_otherEmitted=this.stats.counterMetric("other paths emitted");_totalEmitted=this.stats.counterMetric("total paths emitted");_readDirMs=this.stats.timingMetric("readDir");_filterMs=this.stats.timingMetric("filter");_yieldMs=this.stats.timingMetric("yield");_totalMs=this.stats.timingMetric("total");async*[Symbol.asyncIterator](){this._totalMs.start();let e=200,n=Date.now(),i=new Array;i.push(this._startUri);let s;for(;(s=i.pop())!==void 0;){Date.now()-n>=e&&(await new Promise(b=>setTimeout(b,0)),n=Date.now());let u=Lr(this._rootUri,s),h=this._pathFilter.makeLocalPathFilter(u);this._readDirMs.start();let g=Ss(s.fsPath);this._readDirMs.stop();for(let[b,y]of g){if(Date.now()-n>=e&&(await new Promise($=>setTimeout($,0)),n=Date.now()),b==="."||b==="..")continue;this._filterMs.start();let F=vt.joinPath(s,b),E=ut(u,b,y==="Directory"),L=h.getPathInfo(E,y);this._filterMs.stop();let B=E;y==="File"?this._filesEmitted.increment():y==="Directory"?(B=Ao(E),this._dirsEmitted.increment()):this._otherEmitted.increment(),this._totalEmitted.increment(),this._yieldMs.start(),yield[F,B,y,L],this._yieldMs.stop(),y==="Directory"&&L.accepted&&i.push(F)}}this._totalMs.stop()}},ng=class extends di{constructor(n){super();this.extension=n}format(){return`Unsupported file extension (${this.extension})`}},Bu=class{_fileExtensions;constructor(e){if(e){this._fileExtensions=new Set;for(let n of e)this._fileExtensions.add(n.toLowerCase())}else this._fileExtensions=void 0}acceptsPath(e,n="File"){return this.getPathInfo(e,n).accepted}getPathInfo(e,n="File"){if(n==="File"){let s=As.extname(e);if(this._fileExtensions!==void 0&&!this._fileExtensions.has(s.toLowerCase()))return new ng(s)}else n==="Directory"&&!e.endsWith("/")&&(e+="/");let i=this._getIgnoreStack(Fu(e));return i===void 0?new fi:i.getPathInfo(e)}},rg=class extends Bu{constructor(n,i){super(i);this._ignorePathMap=n}makeLocalPathFilter(n){let i=this._getIgnoreStack(n);return new ig(i,this._fileExtensions)}_getIgnoreStack(n){if(rx(n))throw new Error(`Absolute path ${n} passed to PathFilter`);let i=n;for(let s=0;s<1e4;s++){let c=this._ignorePathMap.get(i);if(c)return c;if(Fu(i)===i)return;i=Fu(i)}throw new Error(`Too-deep or malformed directory name ${n}`)}},ig=class extends Bu{constructor(n,i){super(i);this._ignoreStack=n}_getIgnoreStack(n){return this._ignoreStack}};var og=class extends Error{constructor(){super("SingletonExecutor has been disposed")}},$u=class t extends yt{constructor(n){super();this._execute=n;this.addDisposable({dispose:()=>this._stopping=!0})}static _disposedError=new og;_nextExecutionScheduled=!1;_kickPromise=Promise.resolve();_stopping=!1;kick(){return this._nextExecutionScheduled?this._kickPromise:(this._nextExecutionScheduled=!0,this._kickPromise=this._kickPromise.then(async()=>(this._nextExecutionScheduled=!1,this._stopping?Promise.reject(t._disposedError):this._execute())),this._kickPromise)}};var sg=class{_items=new Map;_inProgress=!1;_stopping=!1;dispose(){this._stopping=!0}get size(){return this._items.size}cancel(e){this._items.delete(e)}_insert(e,n,i=!1){let s=this._items.has(e);return!i&&s?!1:(this._items.set(e,n),!s)}async kick(){if(!(this._inProgress||this._stopping||this._items.size===0)){for(this._inProgress=!0;this._items.size>0&&!this._stopping;){let e=this._items;this._items=new Map;for(let n of e){try{await this._processEntry(n)}catch{}if(this._stopping)break}}this._inProgress=!1,await this._processEntry(void 0)}}};var jn=class extends sg{constructor(n){super();this._processItem=n}insert(n,i,s=!1){return this._insert(n,i,s)}get(n){return this._items.get(n)}async _processEntry(n){return this._processItem(n)}},Wu=class{constructor(e){this._processItem=e}_keys=new Set;_items=new Array;_inProgress=!1;_stopping=!1;get size(){return this._items.length}dispose(){this._stopping=!0}insert(e){return this._keys.has(e)?!1:(this._keys.add(e),this._items.push(e),!0)}async kick(){if(!(this._inProgress||this._stopping)){for(this._inProgress=!0;this._items.length>0&&!this._stopping;){let e=this._items;this._keys.clear(),this._items=new Array;for(let n of e){try{await this._processItem(n)}catch{}if(this._stopping)break}}this._inProgress=!1,await this._processItem(void 0)}}},hi=class{constructor(e,n){this._toKick=e;this._intervalId=setInterval(this._kick.bind(this),n)}_intervalId;_kick(){this._toKick.kick()}dispose(){this._intervalId!==void 0&&clearInterval(this._intervalId)}};var YF=Object.freeze({git:{name:".git",type:"Directory"}});async function ux(t){for(let[e,n]of Object.entries(YF)){let i=await Au(t,n.name,n.type);if(i!==void 0)return{root:i,toolName:e}}}var Ns=class extends Error{constructor(n,i){let s=n instanceof Error?n.message:`${n}`;super(`WorkQueueItemFailed: ${s}, retry = ${i}`);this.toThrow=n;this.retry=i}},ag=class{throwError(e,n){throw new Ns(e,n)}},cg=class{progressReporter;completedItems=0;totalItems;constructor(e,n){this.progressReporter=e,this.totalItems=n,this.update(0,this.totalItems)}update(e,n){this.completedItems+=e,this.totalItems=this.completedItems+n,this.progressReporter.update(this.completedItems,this.totalItems)}cancel(){this.progressReporter.cancel()}},ug=class{constructor(e,n){this.item=e;this.process=n}itemCount(){return 1}start(e){return this.process(this.item,e)}},lg=class{constructor(e,n){this.items=e;this.process=n}itemCount(){return this.items.size}start(e){return this.process(this.items,e)}},ju=class{queue=new Set;get size(){return this.queue.size}add(e){this.queue.add(e)}delete(e){this.queue.delete(e)}},dg=class extends ju{constructor(n){super();this.process=n}dequeue(){let n=this.queue.values().next();if(n.done)throw new Error("Cannot dequeue from empty queue");let i=n.value;return this.queue.delete(i),new ug(i,this.process)}},fg=class extends ju{constructor(n,i){super();this.process=n;this._maxBatchSize=i}dequeue(){let n;if(this._maxBatchSize===void 0||this.queue.size<=this._maxBatchSize)n=this.queue,this.queue=new Set;else{n=new Set;let i=this.queue.values();for(let s=0;s<this._maxBatchSize;s++){let c=i.next();if(c.done)break;let u=c.value;this.queue.delete(u),n.add(u)}}return new lg(n,this.process)}},zu=class t{constructor(e,n,i,s){this.name=e;this.shutdownError=i;if("processOne"in n)this.queue=new dg(n.processOne);else if("processBatch"in n)this.queue=new fg(n.processBatch,n.maxBatchSize);else throw new Error("Invalid processor type");this.backoffParams=s||t.defaultBackoffParams,this.logger=Oe(`WorkQueue[${e}]`),this.errorHandler=new ag}static queueStatusChanged="QueueStatusChanged";static itemFailed="ItemFailed";static defaultBackoffParams={initialMS:100,mult:2,maxMS:3e4};eventEmitters={[t.queueStatusChanged]:new Ve,[t.itemFailed]:new Ve};queue;countReporters=new Set;progressReporters=new Set;errorHandler;backoffParams;itemsInProgress=0;stopping=!1;logger;stop(){this.stopping=!0,this.update(),this.notifyStatusChanged()}add(e){this.stopping||(this.queue.add(e),this.update(),this.kick())}delete(e){this.stopping||(this.queue.delete(e),this.update())}size(){return this.queue.size+this.itemsInProgress}reportQueueSize(e){let n=this.size();e.update(n),this.countReporters.add(e)}awaitEmpty(e,n=!0){if(this.stopping)return Promise.resolve();let i=this.size();return i===0?Promise.resolve():(e&&this.progressReporters.add(new cg(e,i)),new Promise((s,c)=>{let u=[];function h(){for(let g of u)g.dispose()}u.push(this.eventEmitters[t.queueStatusChanged].event(()=>{h(),this.stopping?c(this.shutdownError):s()})),n&&u.push(this.eventEmitters[t.itemFailed].event(g=>{h(),c(g)}))}))}update(e=0){if(this.stopping){for(let n of this.countReporters)n.cancel();for(let n of this.progressReporters)n.cancel()}else{this.itemsInProgress-=e;let n=this.size();for(let i of this.countReporters)i.update(n);for(let i of this.progressReporters)i.update(e,n)}}notifyStatusChanged(){this.eventEmitters[t.queueStatusChanged].fire(null),this.progressReporters.clear()}notifyItemFailed(e){let n=e instanceof Ns?e.toThrow:e;this.eventEmitters[t.itemFailed].fire(n)}delay(e){return new Promise(n=>setTimeout(n,e))}async kick(){if(!this.itemsInProgress){for(;!this.stopping&&this.queue.size!==0;){let e=this.queue.dequeue();this.itemsInProgress=e.itemCount();let n=0,i=0;do{try{await e.start(this.errorHandler),i&&this.logger.debug(`item succeeded; retries = ${i}`);break}catch(s){if(this.notifyItemFailed(s),!(s instanceof Ns&&s.retry)){this.logger.debug(`item failed, not retrying; retries = ${i}`);break}}this.logger.debug(`item failed, retrying in ${n} ms; retries = ${i}`),await this.delay(n),this.logger.debug("retrying"),n===0?n=this.backoffParams.initialMS:n=Math.min(n*this.backoffParams.mult,this.backoffParams.maxMS),i++}while(!this.stopping);this.stopping||this.update(this.itemsInProgress)}this.notifyStatusChanged()}}};function Bo(t,e){let n=new Set(e);return t.filter(i=>!n.has(i))}var Hu=class t extends yt{static defaultCheckpointThreshold=1e3;_checkpointId;_checkpointBlobNames=new Map;_toAdd=new Map;_toRemove=new Set;_apiServer;_logger;_checkpointQueue;_checkpointThreshold;_maxCheckpointBatchSize=1e4;_featureFlagManager;_onContextChange=new Ve;onContextChange=this._onContextChange.event;get _flags(){return this._featureFlagManager.currentFlags}constructor(e,n,i,s){super(),this._logger=Oe("BlobsCheckpointManager"),this._checkpointId=void 0,this._apiServer=e,this._featureFlagManager=n,this._checkpointThreshold=s??t.defaultCheckpointThreshold,this.addDisposable(i(c=>{this.updateBlob(c.absPath,c.prevBlobName,c.newBlobName)})),this._checkpointQueue=new zu("checkpoint",{processOne:async(c,u)=>await this._checkpoint(c,u)}),this._logger.info(`BlobsCheckpointManager created. checkpointThreshold: ${this._checkpointThreshold}`)}refBlob(e){let n=this._checkpointBlobNames.get(e);n!==void 0?(this._checkpointBlobNames.set(e,n+1),n===0&&this._toRemove.delete(e)):this._toAdd.set(e,(this._toAdd.get(e)??0)+1)}derefBlob(e){!this.derefFromCheckpoint(e)&&!this.derefFromAdded(e)&&this._logger.error(`derefBlob: blob ${e} not found in checkpoint or toAdd`)}derefFromCheckpoint(e){let n=this._checkpointBlobNames.get(e);return n===void 0||n<=0?(n!==void 0&&this._logger.error(`derefFromCheckpoint: blob ${e} has reference count ${n}. In toRemove? ${this._toRemove.has(e)}`),!1):(this._checkpointBlobNames.set(e,n-1),n===1&&this._toRemove.add(e),!0)}derefFromAdded(e){let n=this._toAdd.get(e);return n===void 0?!1:n<=1?(this._toAdd.delete(e),n===1):(this._toAdd.set(e,n-1),!0)}getCheckpointedBlobNames(){return Array.from(this._checkpointBlobNames.keys())}getContext(){return{checkpointId:this._checkpointId,addedBlobs:Array.from(this._toAdd.keys()),deletedBlobs:Array.from(this._toRemove)}}getContextAdjusted(e,n){let i=new Set(this._toAdd.keys()),s=new Set(this._toRemove);for(let c of e)this._checkpointBlobNames.has(c)||i.add(c),s.delete(c);for(let c of n)this._checkpointBlobNames.has(c)&&s.add(c),i.delete(c);return{checkpointId:this._checkpointId,addedBlobs:Array.from(i),deletedBlobs:Array.from(s)}}blobsPayload(e){let n=this.getCheckpointedBlobNames(),i=Bo(e,n),s=Bo(n,e);return{checkpointId:this._checkpointId,addedBlobs:i,deletedBlobs:s}}expandBlobs(e){if(e.checkpointId===void 0)return e.addedBlobs;if(e.checkpointId!==this._checkpointId)throw new Error(`expandBlobs: checkpointId mismatch: ${e.checkpointId} != ${this._checkpointId}`);let n=this.getCheckpointedBlobNames();if(n.push(...e.addedBlobs),e.deletedBlobs.length>0){let i=new Set(e.deletedBlobs);return n.filter(s=>!i.has(s))}return n}validateMatching(e,n,i=!1){if(e.checkpointId!==n.checkpointId)return this._logger.error(`checkpointId mismatch: ${e.checkpointId} vs ${n.checkpointId}`),!1;let s=!0,c=Bo(e.addedBlobs,n.addedBlobs),u=Bo(n.addedBlobs,e.addedBlobs);return(c.length>0||u.length>0)&&(s=!1,this._logger.error(`addedBlobs mismatch: -${c.length}/+${u.length}`),i&&(this._logger.error(`left-added: ${c.slice(0,5).join(",")}`),this._logger.error(`right-added: ${u.slice(0,5).join(",")}`))),c=Bo(e.deletedBlobs,n.deletedBlobs),u=Bo(n.deletedBlobs,e.deletedBlobs),(c.length>0||u.length>0)&&(s=!1,this._logger.error(`deletedBlobs mismatch: -${c.length}/+${u.length}`),i&&(this._logger.error(`left-deleted: ${c.slice(0,5).join(",")}`),this._logger.error(`right-deleted: ${u.slice(0,5).join(",")}`))),s}updateBlob(e,n,i){this._logger.verbose(`notifyBlobChange ${e}: ${n} to ${i}`),i&&i!==n&&this.refBlob(i),n&&i!==n&&this.derefBlob(n),this._toAdd.size+this._toRemove.size>=this._checkpointThreshold&&this._checkpointQueue.size()===0&&this._queueCheckpoint()}resetCheckpoint(){for(let[e,n]of this._checkpointBlobNames)n>0?this._toAdd.set(e,n):this._toRemove.delete(e)||this._logger.warn(`blob with 0 references was not found in toRemove: ${e}`);for(let e of this._toRemove)this._logger.warn(`blob in toRemove was not found in checkpoint: ${e}`);this._toRemove.clear(),this._checkpointId=void 0,this._checkpointBlobNames.clear(),this._onContextChange.fire(this.getContext())}async awaitEmptyQueue(){await this._checkpointQueue.awaitEmpty(void 0,!1)}async _checkpoint(e,n){let{checkpointId:i,addedBlobs:s,deletedBlobs:c}=e;this._logger.debug(`Begin checkpoint of working set into ${i}`),this._logger.debug(`add ${s.length} blobs, remove ${c.length} blobs into ${i}`);let u={newCheckpointId:""};try{u=await this._apiServer.checkpointBlobs(e)}catch(h){let g=h instanceof Error?h.message:`${h}`,b=this._checkpointId?this._checkpointId:"{initial}";Mt.isAPIErrorWithStatus(h,5)?(this._logger.warn(`checkpoint-blobs from ${b} failed with invalid argument: ${g}. Recreating checkpoint.`),this.resetCheckpoint(),this._queueCheckpoint(),n.throwError(h,!1)):(this._logger.error(`checkpoint-blobs failed with error: ${g}.`),n.throwError(h,!1))}if(i!==this._checkpointId)this._logger.warn(`original checkpointId ${i} does not match current checkpointId ${this._checkpointId}. Abandoning new checkpoint.`);else{this._logger.debug(`checkpointId ${i} advanced to ${u.newCheckpointId}`),this._checkpointId=u.newCheckpointId;for(let h of s){let g=this._toAdd.get(h);g===void 0?(this._checkpointBlobNames.set(h,0),this._toRemove.add(h)):(this._checkpointBlobNames.set(h,g),this._toAdd.delete(h))}for(let h of c){let g=this._checkpointBlobNames.get(h);g===void 0?this._logger.warn(`In _checkpoint: deleted blob ${h} not found in checkpoint`):g>0&&this._toAdd.set(h,g),this._checkpointBlobNames.delete(h),this._toRemove.delete(h)}this._onContextChange.fire(this.getContext())}this._toAdd.size+this._toRemove.size>=this._checkpointThreshold&&(this._logger.debug(`starting a new round of checkpointing due to size ${this._toAdd.size} + ${this._toRemove.size}`),this._queueCheckpoint())}_queueCheckpoint(){this._logger.debug("queue checkpoint");let e=Array.from(this._toAdd.keys()).slice(0,this._maxCheckpointBatchSize),n=Array.from(this._toRemove).slice(0,this._maxCheckpointBatchSize),i={checkpointId:this._checkpointId,addedBlobs:e,deletedBlobs:n};this._logger.debug(`queue checkpoint: version: ${i.checkpointId}, add: ${i.addedBlobs.length} blobs, rm: ${i.deletedBlobs.length} blob`),this._checkpointQueue.add(i)}};function qs(t,e,n,i){let s=0;for(let c of n)if(t.log(e,`  ${c}`),s++,i!==void 0&&s>=i){t.log(e,"  ...");break}}var lx=Tt(require("crypto")),Os=2023102300,Ls=class extends Error{constructor(e){super(`content exceeds maximum size of ${e}`)}},Vu=class{constructor(e){this.maxBlobSize=e}_textEncoder=new TextEncoder;_hash(e,n){let i=lx.createHash("sha256");return i.update(e),i.update(n),i.digest("hex")}calculateOrThrow(e,n,i=!0){if(typeof n=="string"&&(n=this._textEncoder.encode(n)),i&&n.length>this.maxBlobSize)throw new Ls(this.maxBlobSize);return this._hash(e,n)}calculate(e,n){try{return this.calculateOrThrow(e,n,!0)}catch{return}}calculateNoThrow(e,n){return this.calculateOrThrow(e,n,!1)}};var hg=class{constructor(e,n){this.maxItems=e;this.maxByteSize=n}items=new Map;byteSize=0;addItem(e,n){let i=this.items.get(e);if(i===void 0){if(this.items.size>=this.maxItems||this.byteSize+n.byteSize>=this.maxByteSize)return!1;this.items.set(e,[n]),this.byteSize+=n.byteSize}else i.push(n);return!0}},gg=class{constructor(e){this.maxItemCount=e}items=new Map;get full(){return this.items.size>=this.maxItemCount}addItem(e,n){if(this.items.has(e))return!1;this.items.set(e,n)}},Gu=class t extends yt{constructor(n,i,s,c,u){super();this.workspaceName=n;this._apiServer=i;this._pathHandler=s;this._pathMap=c;this._logger=Oe(`DiskFileManager[${n}]`),u===void 0?this._probeBatchSize=t.maxProbeBatchSize:(u<t.minProbeBatchSize?this._logger.verbose(`Rejecting requested probe batch size of ${u} (min = ${t.minProbeBatchSize})`):u>t.maxProbeBatchSize&&this._logger.verbose(`Rejecting requested probe batch size of ${u} (max = ${t.maxProbeBatchSize})`),this._probeBatchSize=Math.max(Math.min(u,t.maxProbeBatchSize),t.minProbeBatchSize)),this._toCalculate=new jn(this._calculate.bind(this)),this.addDisposable(this._toCalculate),this._toProbe=new jn(this._probe.bind(this)),this.addDisposable(this._toProbe),this._probeBatch=this._newProbeBatch(),this._toUpload=new jn(this._upload.bind(this)),this.addDisposable(this._toUpload),this._uploadBatch=this._newUploadBatch(),this._probeRetryWaiters=new jn(this._enqueueForProbe.bind(this)),this.addDisposable(this._probeRetryWaiters),this._probeRetryKicker=new hi(this._probeRetryWaiters,t.probeRetryPeriodMs),this.addDisposable(this._probeRetryKicker),this._probeRetryBackoffWaiters=new jn(this._enqueueForProbe.bind(this)),this._probeRetryBackoffKicker=new hi(this._probeRetryBackoffWaiters,t.probeRetryBackoffPeriodMs),this.addDisposable(this._probeRetryBackoffKicker)}static minProbeBatchSize=1;static maxProbeBatchSize=1e3;static maxUploadBatchBlobCount=128;static maxUploadBatchByteSize=1e6;static probeRetryPeriodMs=3*1e3;static probeBackoffAfterMs=60*1e3;static probeRetryBackoffPeriodMs=60*1e3;_notAPlainFile="Not a file";_fileNotAccessible="File not readable";_fileNotText="Binary file";_fileUploadFailure="Upload failed";_onDidChangeInProgressItemCountEmitter=new Ve;onDidChangeInProgressItemCount=this._onDidChangeInProgressItemCountEmitter.event;_onQuiescedEmitter=new Ve;_onQuiesced=this._onQuiescedEmitter.event;_textDecoder=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});_toCalculate;_toProbe;_probeBatch;_probeBatchSize;_probeRetryWaiters;_probeRetryKicker;_probeRetryBackoffWaiters;_probeRetryBackoffKicker;_toUpload;_uploadBatch;_itemsInFlight=new Map;_seq=1e3;metrics=new Lo("File metrics");_logger;_stopping=!1;_pathsAccepted=this.metrics.counterMetric("paths accepted");_pathsNotAccessible=this.metrics.counterMetric("paths not accessible");_nonFiles=this.metrics.counterMetric("not plain files");_largeFiles=this.metrics.counterMetric("large files");_blobNameCalculationFails=this.metrics.counterMetric("blob name calculation fails");_encodingErrors=this.metrics.counterMetric("encoding errors");_mtimeCacheHits=this.metrics.counterMetric("mtime cache hits");_mtimeCacheMisses=this.metrics.counterMetric("mtime cache misses");_probeBatches=this.metrics.counterMetric("probe batches");_blobNamesProbed=this.metrics.counterMetric("blob names probed");_filesRead=this.metrics.counterMetric("files read");_blobsUploaded=this.metrics.counterMetric("blobs uploaded");_ingestPathMs=this.metrics.timingMetric("ingestPath");_probeMs=this.metrics.timingMetric("probe");_statMs=this.metrics.timingMetric("stat");_readMs=this.metrics.timingMetric("read");_uploadMs=this.metrics.timingMetric("upload");stop(){this.dispose()}dispose(){this._stopping=!0,super.dispose()}get probeBatchSize(){return this._probeBatchSize}get itemsInFlight(){return this._itemsInFlight.size}ingestPath(n,i){this._ingestPathMs.start(),!this._stopping&&(i=ix(i),this._enqueueForCalculate(n,i),this._ingestPathMs.stop())}async awaitQuiesced(){if(!(this._stopping||this._itemsInFlight.size===0))return ks(this._onQuiesced)}_nextSeq(){return this._seq++}_makeAbsPath(n,i){let s=this._pathMap.getRepoRoot(n);if(s!==void 0)return ut(s,i)}_fileTooLargeString(n){return`File too large (${n} > ${this._pathHandler.maxBlobSize})`}_getMtime(n,i,s,c){this._statMs.start();let u=this._pathHandler.classifyPath(n);switch(this._statMs.stop(),u.type){case"inaccessible":this._pathsNotAccessible.increment(),this._pathMapInvalidate(i,s,c,this._fileNotAccessible);return;case"not a file":this._nonFiles.increment(),this._pathMapInvalidate(i,s,c,this._notAPlainFile);return;case"large file":this._largeFiles.increment(),this._pathMapInvalidate(i,s,c,this._fileTooLargeString(u.size));return;case"accepted":return u.mtime}}async _readAndValidate(n,i,s,c){this._readMs.start();let u=await this._pathHandler.readText(n);switch(this._readMs.stop(),this._filesRead.increment(),u.type){case"inaccessible":this._pathsNotAccessible.increment(),this._pathMapInvalidate(i,s,c,this._fileNotAccessible);return;case"large file":this._largeFiles.increment(),this._pathMapInvalidate(i,s,c,this._fileTooLargeString(u.size));return;case"binary":this._pathMapInvalidate(i,s,c,this._fileNotText);return;case"text":return u.contents}}_calculateBlobName(n,i,s,c){try{return this._pathHandler.calculateBlobName(n,i)}catch(u){if(u instanceof Ls){this._largeFiles.increment();let h=this._fileTooLargeString(i.length);this._pathMapInvalidate(s,n,c,h)}else this._blobNameCalculationFails.increment(),this._pathMapInvalidate(s,n,c,De(u));return}}async _calculate(n){if(n===void 0)return;let[i,[s,c]]=n;if(!this._pathMapVerify(s,c,i))return;let u=this._makeAbsPath(s,c);if(u===void 0){this._inflightItemRemove(i);return}let h=this._getMtime(u,s,c,i);if(h===void 0)return;let g,b=this._pathMap.getBlobInfo(s,c,h);if(b!==void 0){this._mtimeCacheHits.increment();let[T,F]=b;if(F>0){this._pathMapUpdate(s,c,i,T,h);return}g=T}else{let T=await this._readAndValidate(u,s,c,i);if(T===void 0||(this._mtimeCacheMisses.increment(),g=this._calculateBlobName(c,T,s,i),g===void 0))return}this._pathsAccepted.increment();let y={folderId:s,relPath:c,blobName:g,mtime:h,startTime:Date.now()};this._enqueueForProbeRetry(i,y)}_newProbeBatch(){return new gg(this._probeBatchSize)}_grabProbeBatch(){if(this._probeBatch.items.size===0)return;let n=this._probeBatch;return this._probeBatch=this._newProbeBatch(),n}async _probe(n){if(n!==void 0){let[u,h]=n;if(!this._pathMapVerify(h.folderId,h.relPath,u)||(this._probeBatch.addItem(u,h),!this._probeBatch.full))return}let i=this._grabProbeBatch();if(i===void 0)return;let s=new Set;for(let[u,h]of i.items)s.add(h.blobName);this._probeBatches.increment(),this._blobNamesProbed.increment(i.items.size),this._logger.verbose(`probe ${s.size} blobs`),this._probeMs.start();let c;try{c=await br(async()=>this._apiServer.findMissing([...s]),this._logger)}catch{}if(this._probeMs.stop(),c!==void 0){this._logger.verbose(`find-missing reported ${c.unknownBlobNames.length} unknown blob names and ${c.nonindexedBlobNames.length} nonindexed blob names.`),c.unknownBlobNames.length>0&&(this._logger.verbose("unknown blob names:"),qs(this._logger,"verbose",c.unknownBlobNames,5)),c.nonindexedBlobNames.length>0&&(this._logger.verbose("nonindexed blob names:"),qs(this._logger,"verbose",c.nonindexedBlobNames,5));let u=new Set(c.unknownBlobNames),h=new Set(c.nonindexedBlobNames),g=this._beginUploadBatch();for(let[b,y]of i.items)this._pathMapVerify(y.folderId,y.relPath,b)&&(u.has(y.blobName)?this._enqueueForUpload(b,y.folderId,y.relPath,!1):h.has(y.blobName)?this._enqueueForProbeRetry(b,y):this._pathMapUpdate(y.folderId,y.relPath,b,y.blobName,y.mtime));g.dispose()}else for(let[u,h]of i.items)this._enqueueForProbeRetry(u,h)}_newUploadBatch(){return new hg(t.maxUploadBatchBlobCount,t.maxUploadBatchByteSize)}_grabUploadBatch(){if(this._uploadBatch.items.size===0)return;let n=this._uploadBatch;return this._uploadBatch=this._newUploadBatch(),n}async _upload(n){let i;if(n!==void 0){let[h,{seq:g,folderId:b,relPath:y}]=n;if(!this._pathMapVerify(b,y,g))return;let T=this._getMtime(h,b,y,g);if(T===void 0)return;let F=await this._readAndValidate(h,b,y,g);if(F===void 0)return;let E=this._calculateBlobName(y,F,b,g);if(E===void 0)return;let L;try{L=this._textDecoder.decode(F)}catch($){this._pathMapInvalidate(b,y,g,De($)),this._encodingErrors.increment();return}let B={seq:g,folderId:b,pathName:y,text:L,blobName:E,mtime:T,byteSize:F.length,metadata:[]};if(this._uploadBatch.addItem(E,B))return;i=B}let s=this._grabUploadBatch();if(s===void 0)return;i!==void 0&&this._uploadBatch.addItem(i.blobName,i),this._logger.verbose(`upload ${s.items.size} blobs`);let c=new Array;for(let[h,g]of s.items)c.push(g[0]);this._uploadMs.start();let u=await this._uploadBlobBatch(c);this._uploadMs.stop(),this._blobsUploaded.increment(u.size);for(let[h,g]of s.items){let b=u.get(h);if(b===void 0)for(let y of g)this._pathMapInvalidate(y.folderId,y.pathName,y.seq,this._fileUploadFailure);else for(let y of g){let T={folderId:y.folderId,relPath:y.pathName,blobName:b,mtime:y.mtime,startTime:Date.now()};this._enqueueForProbeRetry(y.seq,T)}}}async _uploadBlobBatch(n){this._logger.verbose(`upload begin: ${n.length} blobs`);for(let c of n)this._logger.verbose(`    - ${c.folderId}:${c.pathName}; expected blob name ${c.blobName}`);let i;try{i=await br(async()=>await this._apiServer.batchUpload(n),this._logger)}catch(c){this._logger.error(`batch upload failed: ${De(c)}`)}let s=new Map;if(i!==void 0)for(let c=0;c<i.blobNames.length;c++)s.set(n[c].blobName,i.blobNames[c]);return await this._uploadBlobsSequentially(n,i?.blobNames.length??0,s),s}async _uploadBlobsSequentially(n,i,s){for(let c=i;c<n.length;c++){let u=n[c];try{this._logger.verbose(`sequential upload of ${u.pathName} -> ${u.blobName}`);let h=await br(async()=>this._apiServer.memorize(u.pathName,u.text,u.blobName,[]),this._logger);s.set(u.blobName,h.blobName)}catch{}}}_inflightItemAdd(n,i,s){this._itemsInFlight.set(n,[i,s])}_inflightItemRemove(n){this._itemsInFlight.delete(n),this._onDidChangeInProgressItemCountEmitter.fire(this._itemsInFlight.size),this._itemsInFlight.size===0&&(this._logger.verbose("inflight items signaling empty"),this._onQuiescedEmitter.fire())}_pathMapVerify(n,i,s){if(!this._pathMap.shouldTrack(n,i))return this._inflightItemRemove(s),!1;let c=this._pathMap.getContentSeq(n,i);return c!==void 0&&c>=s?(this._inflightItemRemove(s),!1):!0}_pathMapUpdate(n,i,s,c,u){this._inflightItemRemove(s),this._pathMap.update(n,i,s,c,u)}_pathMapInvalidate(n,i,s,c){this._logger.verbose(`path map invalidate: ${n}:${i} (${c})`),this._pathMap.markUntrackable(n,i,s,c),this._inflightItemRemove(s),this._pathMap.markUntrackable(n,i,s,c)}_enqueueForCalculate(n,i){let s=this._nextSeq();this._inflightItemAdd(s,n,i),this._toCalculate.insert(s,[n,i])?this._toCalculate.kick():this._inflightItemRemove(s)}_enqueueForProbe(n){if(n===void 0)this._toProbe.kick();else{let[i,s]=n;this._logger.verbose(`probe enqueue ${s.blobName} -> ${i}, ${s.folderId}:${s.relPath}`),this._toProbe.insert(i,s)}return Promise.resolve()}_beginUploadBatch(){return new Nr(()=>this._toUpload.kick())}_enqueueForUpload(n,i,s,c=!0){this._logger.verbose(`upload enqueue ${i}:${s} -> ${n}`);let u=this._makeAbsPath(i,s);if(u===void 0){this._inflightItemRemove(n);return}let h=this._toUpload.get(u);if(h!==void 0){let g=h.seq;if(g>n)this._inflightItemRemove(g);else if(g<n){this._inflightItemRemove(n);return}}this._toUpload.insert(u,{seq:n,folderId:i,relPath:s},!0),c&&this._toUpload.kick()}_enqueueForProbeRetry(n,i){Date.now()-i.startTime<t.probeBackoffAfterMs?(this._logger.verbose(`probe-retry enqueue ${i.blobName} -> ${n}, ${i.folderId}:${i.relPath}`),this._probeRetryWaiters.insert(n,i)):(this._logger.verbose(`probe-retry enqueue backoff ${i.blobName} -> ${n}, ${i.folderId}:${i.relPath}`),this._probeRetryBackoffWaiters.insert(n,i))}};var Or=class{static cacheFileName="mtime-cache.json";static tmpFileName="mtime-cache.json.tmp"},pg=class{constructor(e=Os){this.namingVersion=e}entries=new Array};function ZF(t){if(!(t.mtime===void 0||typeof t.mtime!="number"||!t.mtime)&&!(t.name===void 0||typeof t.name!="string"||!t.name))return{mtime:t.mtime,name:t.name}}function eM(t){return ut(t,Or.cacheFileName)}function Ju(t){let e=eM(t);return NP(e)}async function fx(t,e){let n=ut(t,Or.cacheFileName),i=ut(e,Or.cacheFileName);await Cs(e),await Nh(n,i)}async function hx(t,e){let n=new Map,i=Oe(`MtimeCache[${t}]`),s=ut(e,Or.cacheFileName);i.info(`reading blob name cache from ${s}`);try{let c=0,u=await Io(s),h=JSON.parse(u);if(h.namingVersion===void 0||h.namingVersion!==Os)i.info(`blob naming version ${h.namingVersion} !== ${Os}`);else if(Array.isArray(h.entries))for(let[g,b]of h.entries){let y=ZF(b);y!==void 0&&(n.set(g,{mtime:y.mtime,name:y.name}),c++)}i.info(`read ${c} entries from ${s}`)}catch(c){let u=De(c);c instanceof Error&&"code"in c&&c.code==="ENOENT"?i.info(`no blob name cache found at ${s} (probably new source folder); error = ${u}`):i.error(`failed to read blob name cache ${s}: ${u}`)}return n}var Qu=class extends Or{constructor(n,i){super();this._name=n;this._cacheDirName=i;this._cacheFileName=ut(this._cacheDirName,Or.cacheFileName),this._tmpFileName=ut(this._cacheDirName,Or.tmpFileName)}_cacheFileName;_tmpFileName;_logger=Oe("MTimeCacheWriter");get cacheFileName(){return this._cacheFileName}async write(n){this._logger.debug(`persisting to ${this._cacheFileName}`);let i=new pg;for(let[s,c,u]of n)i.entries.push([s,{mtime:c,name:u}]);await Cs(this._cacheDirName),await du(this._tmpFileName,JSON.stringify(i,void 0,4)),await Nh(this._tmpFileName,this._cacheFileName),this._logger.debug(`persisted ${i.entries.length} entries at naming version ${Os} to ${this._cacheFileName}`)}};var gx=require("node:buffer");var Xu=class{constructor(e,n){this._fileReader=n;this._blobNameCalculator=new Vu(e)}_blobNameCalculator;get maxBlobSize(){return this._blobNameCalculator.maxBlobSize}classifyPath(e){let n=this._fileReader.stat(e);return n?n.type!=="File"?{type:"not a file",mtime:n.mtime}:n.size>this._blobNameCalculator.maxBlobSize?{type:"large file",mtime:n.mtime,size:n.size}:{type:"accepted",size:n.size,mtime:n.mtime}:{type:"inaccessible"}}async readText(e){let n;try{if(n=await this._fileReader.read(e),n===void 0)return{type:"inaccessible"}}catch{return{type:"inaccessible"}}return(0,gx.isUtf8)(n)?n.length>this._blobNameCalculator.maxBlobSize?{type:"large file",size:n.length}:{type:"text",contents:n}:{type:"binary"}}calculateBlobName(e,n){return this._blobNameCalculator.calculateOrThrow(e,n)}};var rr=class t{constructor(e,n){this.rootPath=e;this.relPath=n}static from(e){return new t(e.rootPath,e.relPath)}get absPath(){return ut(this.rootPath,this.relPath)}equals(e){return t.equals(this,e)}static equals(e,n){if(e===n)return!0;if(e==null||n==null)return!1;let i=px(e)?ut(e.rootPath,e.relPath):e.fsPath,s=px(n)?ut(n.rootPath,n.relPath):n.fsPath;return i===s}};function px(t){return t!=null&&typeof t=="object"&&("rootPath"in t||"relPath"in t)}var Yu=class{_nextFolderId=100;_sourceFolders=new Map;_blobNameChangedEmitter=new Ve;_nextEntryTS=1e3;_logger=Oe("PathMap");constructor(){}dispose(){for(let[e,n]of this._sourceFolders)n.dispose()}get nextEntryTS(){return this._nextEntryTS}get onDidChangeBlobName(){return this._blobNameChangedEmitter.event}onDidChangePathStatus(e){return this._sourceFolders.get(e)?.onDidChangePathStatus}openSourceFolder(e,n){for(let[u,h]of this._sourceFolders){if(Mu(h.folderRoot,e))throw new Error(`Source folder ${e} is already open`);if(nr(e,h.folderRoot))throw new Error(`Source folder ${e} contains ${h.folderRoot}`);if(nr(h.folderRoot,e))throw new Error(`Source folder ${h.folderRoot} contains ${e}`)}let i=this._nextFolderId++,s=new mg(e,n);this._sourceFolders.set(i,s);let c=s.onDidChangeBlobName(this._handleBlobNameChangeEvent.bind(this));return s.addDisposable(c),this._logger.info(`Opened source folder ${e} with id ${i}`),i}closeSourceFolder(e){let n=this._sourceFolders.get(e);if(n===void 0)return;n.clear();let i=n.folderRoot;this._sourceFolders.delete(e),n.dispose(),this._logger.info(`Closed source folder ${i} with id ${e}`)}_handleBlobNameChangeEvent(e){this._blobNameChangedEmitter.fire(e)}getRepoRoot(e){return this._sourceFolders.get(e)?.repoRoot}hasFile(e,n){return this._sourceFolders.get(e)?.hasFile(n)??!1}getBlobName(e,n){return this._sourceFolders.get(e)?.getBlobName(n)}getBlobInfo(e,n,i){return this._sourceFolders.get(e)?.getBlobInfo(n,i)}getAnyPathName(e){for(let n of this._sourceFolders.values()){let i=n.getPathName(e);if(i!==void 0)return this._makeQualifiedPathName(n,i)}}getAllPathNames(e){let n=new Array;for(let i of this._sourceFolders.values()){let s=i.getPathName(e);s!==void 0&&n.push(new rr(i.repoRoot,s))}return n}getUniquePathCount(e){let n=0;for(let i of this._sourceFolders.values())i.getPathName(e)!==void 0&&n++;return n}getAllQualifiedPathNames(e){return this.getAllQualifiedPathInfos(e).map(n=>n.qualifiedPathName)}getAllQualifiedPathInfos(e){let n=new Array;for(let i of this._sourceFolders.values()){let s=i.getPathInfo(e);if(s!==void 0){let[c,u]=s;n.push({qualifiedPathName:new rr(i.repoRoot,e),fileType:c,isAccepted:u.accepted})}}return n}getAllPathInfo(e){let n=new Array;for(let i of this._sourceFolders.values()){let s=i.getPathName(e);s!==void 0&&n.push([i.folderRoot,i.repoRoot,s])}return n}getPathInfo(e,n){return this._sourceFolders.get(e)?.getPathInfo(n)}reportMissing(e){for(let n of this._sourceFolders.values()){let i=n.reportMissing(e);if(i!==void 0)return this._makeQualifiedPathName(n,i)}}insert(e,n,i,s){let c=this._nextEntryTS++;this._sourceFolders.get(e)?.insert(n,c,i,s)}remove(e,n){this._sourceFolders.get(e)?.remove(n)}shouldTrack(e,n){return this._sourceFolders.get(e)?.shouldTrack(n)??!1}getContentSeq(e,n){return this._sourceFolders.get(e)?.getContentSeq(n)}update(e,n,i,s,c){this._sourceFolders.get(e)?.update(n,i,s,c)}markUntrackable(e,n,i,s){this._sourceFolders.get(e)?.markUntrackable(n,i,s)}purge(e,n){this._sourceFolders.get(e)?.purge(n)}*pathsWithBlobNames(){for(let[e,n]of this._sourceFolders)for(let[i,s,c]of n.pathsWithBlobNames())yield[e,n.repoRoot,i,s,c]}*pathsInFolder(e){let n=this._sourceFolders.get(e);n!==void 0&&(yield*n.allPaths())}enablePersist(e,n,i){this._sourceFolders.get(e)?.enablePersist(n,i)}_makeQualifiedPathName(e,n){return new rr(e.repoRoot,n)}trackedFileCount(e){return this._sourceFolders.get(e)?.trackedFileCount??0}getFolderIds(){return Array.from(this._sourceFolders.keys())}},mg=class extends yt{constructor(n,i){super();this.folderRoot=n;this.repoRoot=i}static defaultPersistThreshold=100;_allPathNames=new Map;_trackableFilePaths=new Set;_blobNameToPathName=new Map;_persistState=void 0;_pathStatusChangedEmitter=new Ve;_blobNameChangedEmitter=new Ve;get onDidChangePathStatus(){return this._pathStatusChangedEmitter.event}get onDidChangeBlobName(){return this._blobNameChangedEmitter.event}get trackedFileCount(){return this._trackableFilePaths.size}shouldTrack(n){let i=this._allPathNames.get(n);return i===void 0?!1:i.fileType==="File"&&i.pathAcceptance.accepted}getContentSeq(n){return this._allPathNames.get(n)?.fileInfo?.contentSeq}insert(n,i,s,c){let u=this._allPathNames.get(n),h=u===void 0||u.fileType!==s||u.pathAcceptance.format()!==c.format();if(u===void 0)u={entryTS:i,fileType:s,pathAcceptance:c},this._allPathNames.set(n,u);else{let g=u.fileInfo;u.entryTS=i,u.fileType=s,u.pathAcceptance=c,c.accepted||(u.fileInfo=void 0,g?.trackable&&(this._blobNameToPathName.delete(g.blobName),this._publishBlobNameChange(n,g.blobName,void 0),this._markDirty()))}u.fileType==="File"&&u.pathAcceptance.accepted&&u.fileInfo?.trackable!==!1?this._trackableFilePaths.add(n):this._trackableFilePaths.delete(n),h&&this._pathStatusChangedEmitter.fire({relPath:n})}remove(n){let i=this._allPathNames.get(n);if(i!==void 0){if(this._allPathNames.delete(n),this._trackableFilePaths.delete(n),i.fileInfo!==void 0&&i.fileInfo.trackable){let s=i.fileInfo.blobName;this._blobNameToPathName.delete(s),this._publishBlobNameChange(n,s,void 0),this._markDirty()}this._pathStatusChangedEmitter.fire({relPath:n})}}clear(){for(let[n,i]of this._allPathNames)i.fileInfo!==void 0&&i.fileInfo.trackable&&this._publishBlobNameChange(n,i.fileInfo.blobName,void 0);this._allPathNames.clear(),this._trackableFilePaths.clear(),this._blobNameToPathName.clear(),this._markDirty()}update(n,i,s,c){let u=this._allPathNames.get(n);if(u===void 0||u.fileType!=="File"||!u.pathAcceptance.accepted||u.fileInfo!==void 0&&u.fileInfo.contentSeq>i)return;let h=u.fileInfo===void 0?!0:u.fileInfo.trackable,g;u.fileInfo?.trackable&&(g=u.fileInfo.blobName),u.fileInfo={trackable:!0,contentSeq:i,blobName:s,mtime:c},this._trackableFilePaths.add(n),s!==g&&(g!==void 0&&this._blobNameToPathName.delete(g),this._blobNameToPathName.set(s,n),this._publishBlobNameChange(n,g,s),this._markDirty()),(!h||g===void 0)&&this._pathStatusChangedEmitter.fire({relPath:n})}markUntrackable(n,i,s){let c=this._allPathNames.get(n);if(c===void 0||c.fileType!=="File"||!c.pathAcceptance.accepted||c.fileInfo!==void 0&&c.fileInfo.contentSeq>i)return;let u=c.fileInfo;c.fileInfo={trackable:!1,contentSeq:i,reason:s},this._trackableFilePaths.delete(n);let h=!1;if(u===void 0)h=!0;else if(u.trackable===!0){h=!0;let g=u.blobName;this._blobNameToPathName.delete(g),this._publishBlobNameChange(n,g,void 0),this._markDirty()}else h=s!==u.reason;h&&this._pathStatusChangedEmitter.fire({relPath:n})}_makeAbsPath(n){return ut(this.repoRoot,n)}_publishBlobNameChange(n,i,s){i!==s&&this._blobNameChangedEmitter.fire({absPath:this._makeAbsPath(n),prevBlobName:i,newBlobName:s})}purge(n){let i=new Array;for(let[s,c]of this._allPathNames)c.entryTS<n&&i.push(s);for(let s of i)this.remove(s)}hasFile(n){return this._trackableFilePaths.has(n)}getBlobName(n){let i=this._allPathNames.get(n);if(i?.fileInfo?.trackable)return i.fileInfo?.blobName}getBlobInfo(n,i){let s=this._allPathNames.get(n);if(s?.fileInfo?.trackable&&s.fileInfo.mtime===i)return[s.fileInfo.blobName,s.fileInfo.contentSeq]}getPathName(n){return this._blobNameToPathName.get(n)}getPathInfo(n){let i=this._allPathNames.get(n);if(i!==void 0)return[i.fileType,i.pathAcceptance]}reportMissing(n){let i=this._blobNameToPathName.get(n);if(i===void 0)return;let s=this._allPathNames.get(i);if(s?.fileInfo?.trackable)return s.fileInfo.contentSeq=0,i}*pathsWithBlobNames(){for(let[n,i]of this._allPathNames){let s=i.fileInfo;s?.trackable&&(yield[n,s.mtime,s.blobName,s.contentSeq])}}*allPaths(){for(let[n,i]of this._allPathNames){let s=i.pathAcceptance.accepted,c=!1,u=i.pathAcceptance.format();s&&(i.fileType==="Other"?(s=!1,u="Not a file"):i.fileInfo!==void 0&&(i.fileInfo?.trackable===!0?c=!0:(s=!1,u=i.fileInfo.reason))),yield[n,i.fileType,s,c,u]}}_markDirty(){this._persistState!==void 0&&this._persistState.dirtyCount++}enablePersist(n,i){if(this._persistState)return;this._persistState={dirtyCount:this._trackableFilePaths.size,lastPersistDirtyCount:0,mtimeCacheWriter:n,persisting:!1},this._maybePersist();let s=setInterval(()=>void this._maybePersist(),i);this.addDisposable({dispose:()=>clearInterval(s)})}async _maybePersist(){if(!(this._persistState===void 0||this._persistState.persisting)){this._persistState.persisting=!0;try{this._persistState.dirtyCount>this._persistState.lastPersistDirtyCount&&await this._persist(this._persistState)}finally{this._persistState.persisting=!1}}}async _persist(n){let i=function*(u){for(let[h,g]of u){let b=g.fileInfo;b?.trackable&&(yield[h,b.mtime,b.blobName])}},s=n.dirtyCount;await n.mtimeCacheWriter.write(i(this._allPathNames.entries())),n.lastPersistDirtyCount=s}};var bg=class extends di{constructor(n){super();this.reason=n}format(){return this.reason}},Ku=class extends yt{constructor(n,i,s,c,u){super();this.folderName=n;this.folderRoot=i;this.repoRoot=s;this._pathFilter=c;this._workspaceFolder=u;this._logger=Oe(`PathNotifier[${i}]`)}_pathFoundEmitter=new Ve;_pathCreatedEmitter=new Ve;_pathChangedEmitter=new Ve;_pathDeletedEmitter=new Ve;_logger;_filesystemWatcherCreated=!1;_stopping=!1;_deletedPaths=void 0;get onDidFindPath(){return this._pathFoundEmitter.event}get onDidCreatePath(){return this._pathCreatedEmitter.event}get onDidChangePath(){return this._pathChangedEmitter.event}get onDidDeletePath(){return this._pathDeletedEmitter.event}dispose(){this._stopping=!0,super.dispose()}async enumeratePaths(){if(this._stopping)return;this._deletedPaths=new Set,this._workspaceFolder!==void 0&&!this._filesystemWatcherCreated&&(this._createFilesystemWatcher(this._workspaceFolder),this._filesystemWatcherCreated=!0);let n=new Oo(this.folderName,ht.file(this.folderRoot),ht.file(this.repoRoot),this._pathFilter);for await(let[s,c,u,h]of n){if(this._stopping)return;this._pathFoundEmitter.fire({relPath:c,fileType:u,acceptance:h})}if(this._stopping)return;let i=this._deletedPaths;this._deletedPaths=void 0;for(let s of i)this._pathDeletedEmitter.fire(s);return n.stats}_handlePathChanged(n,i){let s=this._getRelPath(n);if(s===void 0)return;let c,u;try{c=xs(Jt(n)).type,u=this._pathFilter.getPathInfo(s,c)}catch(g){c="Other",u=new bg(De(g))}let h=i?"created":"changed";this._logger.verbose(`${c} ${h}: ${s}, acceptance = ${u.format()}`),this._deletedPaths?.delete(s),i?this._pathCreatedEmitter.fire({relPath:s,fileType:c,acceptance:u}):this._pathChangedEmitter.fire({relPath:s,fileType:c,acceptance:u})}_handlePathDeleted(n){let i=this._getRelPath(n);i!==void 0&&(this._logger.verbose(`Path deleted: ${i}`),this._deletedPaths!==void 0?this._deletedPaths?.add(i):this._pathDeletedEmitter.fire(i))}_getRelPath(n){if(this._stopping)return;let i=No(n);if(i!==void 0)return Fs(this.repoRoot,i)}_createFilesystemWatcher(n){}};async function mx(t,e,n,i){let s=Jt(t),c=Jt(e),u=new Array;u.push(s);let h=new Array,g=200,b=Date.now(),y;for(;(y=u.pop())!==void 0&&(i===void 0||h.length<i);){Date.now()-b>=g&&(await new Promise(B=>setTimeout(B,0)),b=Date.now());let F=Lr(c,y),E=n.makeLocalPathFilter(F),L=Ss(y);for(let[B,$]of L){if(Date.now()-b>=g&&(await new Promise(x=>setTimeout(x,0)),b=Date.now()),B==="."||B==="..")continue;let D=ut(F,B,$==="Directory");E.acceptsPath(D,$)&&($==="File"?h.push(D):$==="Directory"&&u.push(ut(y,B)))}}return Promise.resolve(h)}var Zu=class t{constructor(e,n,i,s){this._apiServer=e;this._pathHandler=n;this._fileExtensions=i;this._maxTrackedFiles=s}static verifyBatchSize=1e3;async describe(e,n,i){let s=await this._getAllPathNames(e,n,i);if(s.length>this._maxTrackedFiles)return{trackable:!1};let c=s.length,u=await this._chooseBlobNameSample(n,s);if(u.length===0)return{trackable:!0,trackableFiles:0,uploadedFraction:1};let h=await this._apiServer.findMissing(u),g=u.length,b=Math.min(h.unknownBlobNames.length,g);return{trackable:!0,trackableFiles:c,uploadedFraction:(g-b)/g}}async _getAllPathNames(e,n,i){let s=await Uu(ht.file(e),ht.file(n),new qo(i),this._fileExtensions);return await mx(ht.file(e),ht.file(n),s,this._maxTrackedFiles+1)}async _chooseBlobNameSample(e,n){let i=new Array;for(;i.length<t.verifyBatchSize&&n.length>0;){let s=Math.floor(Math.random()*n.length),c=n[s];n[s]=n[n.length-1],n.pop();let u=ut(e,c),h=await this._pathHandler.readText(u);if(h.type!=="text")continue;let g=this._pathHandler.calculateBlobName(c,h.contents);i.push(g)}return i}};var el=class t extends yt{constructor(n,i){super();this._apiServer=n;this._workspaceManager=i;this._logger=Oe("UnknownBlobHandler"),this._toProbe=new jn(this._probe.bind(this)),this.addDisposable(this._toProbe),this._probeWaiters=new jn(this._enqueueForProbe.bind(this)),this.addDisposable(this._probeWaiters),this._probeWaitersKicker=new hi(this._probeWaiters,t.probeRetryWaitMs),this.addDisposable(this._probeWaitersKicker),this._longWaiters=new jn(this._enqueueForProbe.bind(this)),this.addDisposable(this._longWaiters),this._longWaitersKicker=new hi(this._longWaiters,t.longRetryWaitMs),this.addDisposable(this._longWaitersKicker)}static probeBatchSize=1e3;static probeRetryWaitMs=5*1e3;static probePatienceMs=2*60*1e3;static longRetryWaitMs=60*1e3;_toProbe;_currentBatch=new Map;_probeWaiters;_probeWaitersKicker;_longWaiters;_longWaitersKicker;_logger;enqueue(n){for(let[i,s]of n)this._logger.verbose(`enqueue: ${s.rootPath}:${s.relPath}`),this._toProbe.insert(i,{qualifiedPath:s,startTime:Date.now()});this._toProbe.kick()}_grabCurrentBatch(){if(this._currentBatch.size===0)return;let n=this._currentBatch;return this._currentBatch=new Map,n}async _probe(n){if(n!==void 0){let[u,h]=n;if(this._workspaceManager.getBlobName(h.qualifiedPath)!==u||(this._currentBatch.set(u,h),this._currentBatch.size<t.probeBatchSize))return}let i=this._grabCurrentBatch();if(i===void 0)return;let s=[...i.keys()],c;try{c=await br(async()=>this._apiServer.findMissing(s),this._logger)}catch{}if(c===void 0)for(let[u,h]of i)this._addRetryWaiter(u,h);else{this._logger.verbose(`find-missing reported ${c.nonindexedBlobNames.length} nonindexed blob names`),c.nonindexedBlobNames.length>0&&qs(this._logger,"verbose",c.nonindexedBlobNames,5);let u=new Set(c.unknownBlobNames),h=new Set(c.nonindexedBlobNames);for(let[g,b]of i)u.has(g)?this._workspaceManager.notifyBlobMissing(b.qualifiedPath,g):h.has(g)&&this._addRetryWaiter(g,b)}}_enqueueForProbe(n){if(n===void 0)this._toProbe.kick();else{let[i,s]=n;this._logger.verbose(`probe enqueue: ${s.qualifiedPath.rootPath}:${s.qualifiedPath.relPath}: ${i}`),this._toProbe.insert(i,s)}return Promise.resolve()}_addRetryWaiter(n,i){Date.now()-i.startTime<t.probePatienceMs?(this._logger.verbose(`retry enqueue: ${i.qualifiedPath.rootPath}:${i.qualifiedPath.relPath}: ${n}`),this._probeWaiters.insert(n,i)):(this._logger.verbose(`long retry enqueue: ${i.qualifiedPath.rootPath}:${i.qualifiedPath.relPath}: ${n}`),this._longWaiters.insert(n,i))}};var Uo=class t{constructor(e,n,i,s,c){this.blobs=e;this.recentChunks=n;this.trackedPaths=i;this.lastChatResponse=s;this.blobNames=c}static empty(){return new t({checkpointId:void 0,addedBlobs:[],deletedBlobs:[]},new Array,new Map,void 0,[])}};function yx(t){return Ao(Jt(t))}function bx(t){if(t.scheme==="file")return yx(t)}var _g=class extends yt{constructor(n,i,s,c,u,h,g,b,y,T,F){super(y,T);this.folderName=n;this.folderRoot=i;this.repoRoot=s;this.workspaceFolder=c;this.vcsDetails=u;this.folderId=h;this.diskFileManager=g;this.cacheDirPath=b;this.logger=F;this._operationQueue=new Wu(async E=>await this._runSerializedOperation(E)),this.addDisposables(this._operationQueue,{dispose:()=>this._disposeTracker()})}_operationQueue;_tracker;_newlyTracked=!1;_initialEnumerationComplete=!1;_initialSyncComplete=!1;_stopped=!1;dispose(){this._stopped=!0,super.dispose()}get stopped(){return this._stopped}get type(){return this.workspaceFolder===void 0?1:0}_disposeTracker(){this._tracker?.dispose(),this._tracker=void 0}setTracker(n){if(this.stopped)throw new Error("Source folder has been disposed");this._disposeTracker(),this._tracker=n}get tracker(){return this._tracker}get initialEnumerationComplete(){return this._initialEnumerationComplete}setInitialEnumerationComplete(){this._initialEnumerationComplete=!0}get initialSyncComplete(){return this._initialSyncComplete}setInitialSyncComplete(){this._initialSyncComplete=!0}relativePathName(n){if(nr(this.folderRoot,n))return Es(this.repoRoot,n)}acceptsPath(n){return this._tracker===void 0?!1:this._tracker.pathFilter.acceptsPath(n)}async enqueueSerializedOperation(n){this._operationQueue.insert(n),await this._operationQueue.kick()}async _runSerializedOperation(n){n!==void 0&&(!this._initialEnumerationComplete||this._stopped||await n())}},vg=class extends yt{constructor(n,i,s){super(s);this.pathFilter=n;this.pathNotifier=i}};var tM=new Set(["home directory","too large"]),nM=new Set(["nested"]);function Bs(t){return tM.has(t)}function _x(t){return nM.has(t)}function ir(t){return t.containingFolderRoot!==void 0?"nested":t.isHomeDir?"home directory":t.folderQualification!==void 0&&!t.folderQualification.trackable?"too large":t.syncingPermission==="denied"?"permission denied":t.syncingPermission==="granted"?"trackable":t.folderQualification===void 0?"qualifying":"permission needed"}var tl=class t extends yt{constructor(n,i,s,c,u,h,g=new Array,b){super();this._storageUriProvider=n;this._apiServer=i;this._featureFlagManager=s;this._completionServer=c;this._maxUploadSizeBytes=u;this._workspaceFolders=h;this._enableFileLimitsForSyncingPermission=this._featureFlagManager.currentFlags.enableFileLimitsForSyncingPermission,this._maxTrackableFiles=this._featureFlagManager.currentFlags.maxTrackableFileCount,this._maxTrackableFilesWithoutPermission=Math.min(this._featureFlagManager.currentFlags.maxTrackableFileCountWithoutPermission,this._maxTrackableFiles);let y=Math.min(this._featureFlagManager.currentFlags.minUploadedPercentageWithoutPermission,100);if(this._verifyFolderIsSourceRepo=this._featureFlagManager.currentFlags.verifyFolderIsSourceRepo,this._minUploadedFractionWithoutPermission=y*.01,this._refuseToSyncHomeDirectories=this._featureFlagManager.currentFlags.refuseToSyncHomeDirectories,this._useCheckpointManagerContext=!0,this._validateCheckpointManagerContext=!1,this._folderEnumeratedEmitter=this.addDisposable(new Ve),this._folderSyncedEmitter=this.addDisposable(new Ve),this._syncingProgressEmitter=this.addDisposable(new Ve),this._syncingStateEmitter=this.addDisposable(new Ve),this._sourceFoldersChangedEmitter=this.addDisposable(new Ve),this._sourceFolderContentsChangedEmitter=this.addDisposable(new Ve),this._sourceFolderContentsChangedEmitter=this.addDisposable(new Ve),this._featureFlagManager.currentFlags.bypassLanguageFilter)this._fileExtensions=void 0;else{let F=new Set;for(let E of g)for(let L of E.extensions)F.add(L);this._fileExtensions=F}this._pathHandler=new Xu(this._maxUploadSizeBytes,zP()),this._pathMap=this.addDisposable(new Yu);let T=b?.blobsCheckpointThreshold;this._blobsCheckpointManager=this.addDisposable(new Hu(this._apiServer,this._featureFlagManager,this._pathMap.onDidChangeBlobName,T)),this._unknownBlobHandler=this.addDisposable(new el(this._apiServer,this)),this._sourceFolderReconciler=this.addDisposable(new $u(()=>this._reconcileSourceFolders())),this._sourceFolderDescriber=new Zu(this._apiServer,this._pathHandler,this._fileExtensions,this._maxTrackableFiles),this.addDisposable(new Nr(()=>this._disposeSourceFolders())),this._registerInitialSourceFolders(),this._awaitInitialSourceFolders()}static augmentRootName=".augmentroot";static ignoreSources(n){return[new Ms(".gitignore"),new qu(n),new Ms(".augmentignore")]}static pathMapPersistFrequencyMs=6e4;static defaultPathAccept=new fi;static _textEncoder=new TextEncoder;_initialSourceFolders=new Set;_registeredSourceFolders=new Map;_trackedSourceFolders=new Map;_fileExtensions;_pathMap;_pathHandler;_blobsCheckpointManager;_unknownBlobHandler;_sourceFolderDescriber;_logger=Oe("WorkspaceManager");_folderEnumeratedEmitter;_folderSyncedEmitter;_syncingProgressEmitter;_syncingPermissionInitialized=!1;_sourceFolderReconciler;_syncingStateEmitter;_sourceFoldersChangedEmitter;_sourceFolderContentsChangedEmitter;_lastChatResponse=void 0;_enableFileLimitsForSyncingPermission;_maxTrackableFiles;_maxTrackableFilesWithoutPermission;_verifyFolderIsSourceRepo;_minUploadedFractionWithoutPermission;_refuseToSyncHomeDirectories;_useCheckpointManagerContext;_validateCheckpointManagerContext;_stopping=!1;dispose(){this._stopping=!0,super.dispose()}get verifyFolderIsSourceRepo(){return this._verifyFolderIsSourceRepo}get minUploadedFractionWithoutPermission(){return this._minUploadedFractionWithoutPermission}get refuseToSyncHomeDirectories(){return this._refuseToSyncHomeDirectories}get initialFoldersEnumerated(){return Array.from(this._initialSourceFolders).every(n=>{let i=this._registeredSourceFolders.get(n);if(i===void 0)return!0;let s=ir(i);return Bs(s)||_x(s)||s==="permission denied"?!0:this._trackedSourceFolders.get(n)?.sourceFolder?.initialEnumerationComplete})}async awaitInitialFoldersEnumerated(){for(;!this.initialFoldersEnumerated;)await ks(this._folderEnumeratedEmitter.event)}get initialFoldersSynced(){return Array.from(this._initialSourceFolders).every(n=>{let i=this._registeredSourceFolders.get(n);if(i===void 0)return!0;let s=ir(i);return Bs(s)||_x(s)||s==="permission denied"?!0:this._trackedSourceFolders.get(n)?.sourceFolder?.initialSyncComplete})}async awaitInitialFoldersSynced(){for(;!this.initialFoldersSynced;)await ks(this._folderSyncedEmitter.event)}get syncingEnabledState(){if(!this._syncingPermissionInitialized)return"initializing";let n=0;for(let[i,s]of this._registeredSourceFolders){let c=ir(s);if(Bs(c)||c==="permission denied")return"disabled";c==="permission needed"&&n++}return n>0?"partial":"enabled"}get onDidChangeSyncingState(){return this._syncingStateEmitter.event}get completionServer(){return this._completionServer}_disposeSourceFolders(){this._registeredSourceFolders.forEach(n=>{n.cancel?.cancel(),n.cancel?.dispose(),n.cancel=void 0}),this._trackedSourceFolders.forEach(n=>n.sourceFolder?.dispose()),this._trackedSourceFolders.clear()}getSyncingProgress(){let n=new Array;return this._trackedSourceFolders.forEach((i,s)=>{n.push(this._getSyncingProgress(s,i.sourceFolder))}),n}_getSyncingProgress(n,i){let s=i?.initialEnumerationComplete?{newlyTracked:i._newlyTracked,trackedFiles:this._pathMap.trackedFileCount(i.folderId),backlogSize:i.diskFileManager.itemsInFlight}:void 0;return{folderRoot:n,progress:s}}_isHomeDir(n){return this._featureFlagManager.currentFlags.refuseToSyncHomeDirectories?cx(n):!1}_registerInitialSourceFolders(){let n=new Array;this._workspaceFolders?.forEach(s=>{let c=bx(s.uri);c!==void 0&&this._mtimeCacheExists(c)&&n.push(c)});let i=new Array;this._workspaceFolders?.forEach(s=>{let c=s.name,u=bx(s.uri);if(u===void 0)return;let h="granted";this._logger.info(`Adding workspace folder ${c}; folderRoot = ${u}; syncingPermission = ${h}`),this._initialSourceFolders.add(u),this._registeredSourceFolders.set(u,{folderName:c,isHomeDir:this._isHomeDir(u),folderType:0,syncingPermission:h,workspaceFolder:s}),h==="granted"&&i.push(u)})}_mtimeCacheExists(n){let i=this._computeCacheDirPath(n);return Ju(i)}async _awaitInitialSourceFolders(){let n=Date.now();this._kickSourceFolderReconciler(),await this.awaitInitialFoldersSynced(),this._reportWorkspaceStartup(Date.now()-n),this._folderSyncedEmitter.fire()}enableSyncing(){this._logger.info("Enabling syncing for all trackable source folders");let n=new Array;this._registeredSourceFolders.forEach((i,s)=>{let c=ir(i);Bs(c)||c==="qualifying"||(i.syncingPermission="granted",n.push(s))}),this._kickSourceFolderReconciler()}disableSyncing(){this._logger.info("Disabling syncing for all trackable source folders"),this._registeredSourceFolders.forEach(n=>{let i=ir(n);Bs(i)||(n.syncingPermission="denied")}),this._kickSourceFolderReconciler()}requalifyLargeFolders(){this._registeredSourceFolders.forEach(n=>{n.folderQualification=void 0}),this._kickSourceFolderReconciler()}_kickSourceFolderReconciler(){let n=new Set;for(let[i,s]of this._registeredSourceFolders)if(ir(s)==="trackable"){for(let[u,h]of this._registeredSourceFolders)if(ir(h)==="trackable"&&i!==u&&nr(u,i)){n.add(i);break}}for(let[i,s]of this._registeredSourceFolders){if(!n.has(i)){s.containingFolderRoot=void 0;continue}for(let c of this._registeredSourceFolders.keys())if(!(i===c||n.has(c))&&nr(c,i)){s.containingFolderRoot!==c&&this._logger.info(`Source folder ${i} will not be tracked. Containing folder: ${c}`),s.containingFolderRoot=c;break}}for(let[i,s]of this._registeredSourceFolders)ir(s)==="qualifying"&&s.cancel===void 0&&this._qualifySourceFolder(i,s);this._syncingStateEmitter.fire(this.syncingEnabledState),this._sourceFoldersChangedEmitter.fire(),this._sourceFolderReconciler.kick()}async _qualifySourceFolder(n,i){let[s,c]=await this._findRepoRoot(n),u,h;if(this._enableFileLimitsForSyncingPermission){h="full",this._logger.info(`Beginning ${h} qualification of source folder ${n}`);let b=new Ni;if(i.cancel=b,u=await this._sourceFolderDescriber.describe(n,s,t.ignoreSources(n)),b.token.isCancellationRequested){this._logger.info(`Cancelled qualification of source folder ${n}`);return}i.cancel=void 0,b.dispose()}else h="phony",this._logger.info(`Beginning ${h} qualification of source folder ${n} per feature flag`),u={trackable:!0,trackableFiles:0,uploadedFraction:1};let g={...u,repoRoot:s,isRepo:c};i.folderQualification=g,g.trackable?(this._logger.info(`Finished ${h} qualification of source folder ${n}: trackable files: ${g.trackableFiles}, uploaded fraction: ${g.uploadedFraction}, is repo: ${g.isRepo}`),g.trackableFiles>this._maxTrackableFilesWithoutPermission?this._logger.info(`Requesting syncing permission because source folder has more than ${this._maxTrackableFilesWithoutPermission} files`):this._verifyFolderIsSourceRepo&&!g.isRepo?this._logger.info("Requesting syncing permission because source folder does not appear to be a source repo"):g.uploadedFraction<this._minUploadedFractionWithoutPermission?this._logger.info(`Requesting syncing permission because source folder has less than ${this._minUploadedFractionWithoutPermission*100}% of files uploaded`):i.syncingPermission="granted"):this._logger.info(`Finished ${h} qualification of source folder ${n}: folder not trackable; too large`),this._kickSourceFolderReconciler()}async _reconcileSourceFolders(){let n=this.syncingEnabledState==="disabled",i=new Map;for(let[c,u]of this._trackedSourceFolders){let h=this._registeredSourceFolders.get(c),g;if(h===void 0)g="source folder has been removed";else if(n)g="syncing is disabled";else if(h.containingFolderRoot!==void 0)g=`source folder is nested inside folder ${h.containingFolderRoot}`;else if(h.isHomeDir)g="source folder is a home directory";else if(h.folderQualification?.trackable===!1)g="source folder is too large";else{let b=ir(h);b==="permission denied"?g="syncing permission denied for this source folder":b==="permission needed"?g="syncing permission not yet granted for this source folder":b==="qualifying"&&(g="source folder is being qualified")}g!==void 0&&i.set(c,[u,g])}let s=new Map;for(let[c,u]of this._registeredSourceFolders){if(ir(u)!=="trackable")continue;let g=this._trackedSourceFolders.get(c);g===void 0&&(g={folderName:u.folderName,folderSpec:(0,vx.cloneDeep)(u),cancel:new Ni,sourceFolder:void 0,logger:Oe(`WorkspaceManager[${u.folderName}]`)},s.set(c,g))}for(let[c,[u,h]]of i)u.logger.info(`Stop tracking: ${h}`),this._trackedSourceFolders.delete(c),this._stopTracking(u);for(let[c,u]of s)u.logger.info("Start tracking"),this._trackedSourceFolders.set(c,u),this._startTracking(c,u);return Promise.resolve()}async _startTracking(n,i){let s=new Lu("Startup metrics"),c=i.cancel,u=await this._createSourceFolder(n,i,c.token);if(c.token.isCancellationRequested){i.logger.info("Cancelled in-progress creation of source folder"),u?.dispose();return}if(s.charge("create SourceFolder"),c.dispose(),u===void 0||this._stopping){i.logger.info("Stopped tracking source folder");return}i.sourceFolder=u;let h=i.folderName,g=u.folderId,b=await hx(h,u.cacheDirPath);if(s.charge("read MtimeCache"),u.stopped){i.logger.info("Stopped tracking source folder");return}for(let[T,F]of b)this._pathMap.insert(g,T,"File",t.defaultPathAccept),this._pathMap.update(g,T,0,F.name,F.mtime);s.charge("pre-populate PathMap");let y=new tr;try{u._newlyTracked=b.size===0,y.add({dispose:()=>u._newlyTracked=!1});let T=await this._refreshSourceFolder(u,s);if(T===void 0||u.stopped)return;s.charge("enumerate"),u.setInitialEnumerationComplete(),this._folderEnumeratedEmitter.fire();let F=this._pathMap.onDidChangePathStatus(g);if(F===void 0)return;u.addDisposable(F(L=>{this._sourceFolderContentsChangedEmitter.fire(n)}),!0),this._sourceFoldersChangedEmitter.fire(),await u.diskFileManager.awaitQuiesced(),u.setInitialSyncComplete(),this._folderSyncedEmitter.fire(),s?.charge("await DiskFileManager quiesced");let E=new Qu(h,u.cacheDirPath);this._pathMap.enablePersist(g,E,t.pathMapPersistFrequencyMs),s.charge("enable persist"),this._reportSourceFolderStartup(i.logger,u,s,T)}finally{y.dispose()}}async _createSourceFolder(n,i,s){let c=i.folderName,u=new tr,h=new tr,g=i.folderSpec.folderType===1?void 0:i.folderSpec.workspaceFolder,[b,y]=await this._findRepoRoot(n);if(s.isCancellationRequested)return;let T=this._pathMap.openSourceFolder(n,b);u.add(new Nr(()=>this._pathMap.closeSourceFolder(T)));let F=new Gu(c,this._apiServer,this._pathHandler,this._pathMap);u.add(F);let E=void 0,L=await this._migrateMtimeCache(n,i);return new _g(c,n,b,g,E,T,F,L,u,h,i.logger)}async _migrateMtimeCache(n,i){let s=this._computeCacheDirPath(n);if(Ju(s))return s;let c=this._computeCacheDirPath(i.folderName);if(!Ju(c))return s;try{i.logger.info(`Migrating mtime cache for ${i.folderName} from "${c}" to "${s}"`),await fx(c,s)}catch(u){i.logger.error(`Failed to migrate mtime cache for ${i.folderName} from "${c}" to "${s}": ${De(u)}`)}return s}_computeCacheDirPath(n){return t.computeCacheDirPath(n,this._storageUriProvider.storageUri)}static computeCacheDirPath(n,i){let s=Jt(i),c=VP(t._textEncoder.encode(n));return ut(s,c)}async refreshSourceFolders(){this.requalifyLargeFolders();let n=Array.from(this._trackedSourceFolders.values()).map(i=>i.sourceFolder).filter(i=>i!==void 0).map(i=>i.enqueueSerializedOperation(async()=>{await this._refreshSourceFolder(i)}));try{await Promise.allSettled(n)}catch(i){this._logger.info(`One or more source folders failed to refresh: ${De(i)}`)}}async _refreshSourceFolder(n,i){n.logger.debug(`Refreshing source folder ${n.folderName}`);let s=await this._createSourceFolderTracker(n,i);try{n.setTracker(s)}catch(u){n.logger.info(`Failed to install SourceFolderTracker for ${n.folderName}: ${De(u)}`),s.dispose();return}return await this._enumerateSourceFolder(n,i)}async _enumerateSourceFolder(n,i){let s=n.tracker;if(s===void 0)return;let c=this._pathMap.nextEntryTS,u=await s.pathNotifier.enumeratePaths();if(!n.stopped)return i?.charge("enumerate paths"),this._pathMap.purge(n.folderId,c),i?.charge("purge stale PathMap entries"),u}async _createSourceFolderTracker(n,i){let s=new tr,c=await Uu(ht.file(n.folderRoot),ht.file(n.repoRoot),new qo(t.ignoreSources(n.folderRoot)),this._fileExtensions);i?.charge("create PathFilter");let u=this._createPathNotifier(n,c);return s.add(u),i?.charge("create PathNotifier"),new vg(c,u,s)}_createPathNotifier(n,i){let s=new Ku(n.folderName,n.folderRoot,n.repoRoot,i,n.workspaceFolder);return s.addDisposables(s.onDidFindPath(c=>{this._handlePathFound(n,c.relPath,c.fileType,c.acceptance)}),s.onDidCreatePath(c=>{this._handlePathCreated(n,c.relPath,c.fileType,c.acceptance)}),s.onDidChangePath(c=>{c.fileType==="File"&&this._handleFileChanged(n,c.relPath,c.acceptance)}),s.onDidDeletePath(c=>{this._handlePathDeleted(n,c)})),s}async _findRepoRoot(n){let i;return i=await Au(n,t.augmentRootName),i===void 0&&(i=(await ux(n))?.root),i!==void 0?[yx(i),!0]:[n,!1]}_stopTracking(n){if(n.sourceFolder===void 0){let i=n.cancel;i.cancel(),i.dispose(),n.logger.info("Cancelled in-progress tracking of source folder")}else{let i=n.sourceFolder;n.sourceFolder=void 0,i.dispose(),n.logger.info("Stopped tracking source folder")}this._folderSyncedEmitter.fire(),this._folderEnumeratedEmitter.fire()}translateRange(n,i,s){let c=this._resolveAbsPath(n.absPath);if(c===void 0)return;let[u,h]=c,g={folderId:u.folderId,relPath:h,beginOffset:i,endOffset:s}}getContext(){if(this._pathMap===void 0)return Uo.empty();let n={folderMap:new Map,recentChunks:[]},i=new Set,s=new Map,c=new Map;for(let[E,L]of n.folderMap){let B=this._pathMap.getRepoRoot(E);B!==void 0&&c.set(B,L);for(let[$,X]of L){i.add(X);let D=this._pathMap.getBlobName(E,$);D!==void 0&&D!==X&&s.set(D,(s.get(D)??0)+1)}}let u=new Set;for(let[E,L]of s)i.has(E)||L===this._pathMap.getUniquePathCount(E)&&u.add(E);let h=new Array;for(let E of n.recentChunks);let g=this._blobsCheckpointManager,b=g!==void 0&&this._useCheckpointManagerContext,y=b&&this._validateCheckpointManagerContext,T;if(!b||y){let E=new Set(i);for(let[$,X,D,x,O]of this._pathMap.pathsWithBlobNames())n.folderMap.get($)?.has(D)||E.add(O);let L=Array.from(E),B=this._blobNamesToBlobs(L);if(T=new Uo(B,h,c,this._lastChatResponse,L),!b)return T}let F=g.getContextAdjusted(i,u);return T!==void 0&&(g.validateMatching(T.blobs,F)||this._logger.error("blob context mismatch")),new Uo(F,h,c,this._lastChatResponse)}getContextWithBlobNames(){let n=this.getContext();return n.blobNames!==void 0?n:{...n,blobNames:this._blobsCheckpointManager.expandBlobs(n.blobs)}}_blobNamesToBlobs(n){return this._blobsCheckpointManager===void 0?{checkpointId:void 0,addedBlobs:n,deletedBlobs:[]}:this._blobsCheckpointManager.blobsPayload(n)}handleUnknownBlobs(n,i){if(i.length===0)return;let s=new Set(i),c=new Array;for(let[u,h]of n.trackedPaths)if(u!==void 0)for(let[g,b]of h)s.has(b)&&(c.push([b,new rr(u,g)]),s.delete(b));for(let u of s){let h=this._pathMap.getAnyPathName(u);h!==void 0&&c.push([u,h])}this._unknownBlobHandler.enqueue(c)}handleUnknownCheckpoint(n,i){this._logger.info(`received checkpoint not found for request id ${n}`),this._blobsCheckpointManager.resetCheckpoint(),this._blobsCheckpointManager.updateBlob("")}notifyBlobMissing(n,i){let s=this._pathMap.reportMissing(i);if(s!==void 0){let u=this._getSourceFolder(s.rootPath);if(u!==void 0){u.diskFileManager.ingestPath(u.folderId,n.relPath);return}}this._getSourceFolder(n.rootPath)}_getSourceFolder(n){return this._trackedSourceFolders.get(n)?.sourceFolder}resolvePathName(n){let i=typeof n=="string"?n:No(n);if(i===void 0)return;let s=this._resolveAbsPath(i);if(s===void 0)return;let[c,u]=s;return new rr(c.repoRoot,u)}getFolderRoot(n){let i=typeof n=="string"?n:No(n);if(i===void 0)return;let s=this._resolveAbsPath(i);if(s===void 0)return;let[c,u]=s;return c.folderRoot}safeResolvePathName(n){let i=typeof n=="string"?n:No(n);if(i===void 0)return;let s=this._resolveAbsPath(i);if(s===void 0)return new rr("",i);let[c,u]=s;return new rr(c.repoRoot,u)}_resolveAbsPath(n){for(let[i,s]of this._trackedSourceFolders){if(s.sourceFolder===void 0)continue;let c=s.sourceFolder.relativePathName(n);if(c!==void 0)return[s.sourceFolder,c]}}hasFile(n){let[i,s]=this._resolveAbsPath(n.absPath)??[void 0,void 0];return i===void 0||s===void 0?!1:this._pathMap.hasFile(i.folderId,n.relPath)}getBlobName(n){let[i,s]=this._resolveAbsPath(n.absPath)??[void 0,void 0];if(!(i===void 0||s===void 0))return this._pathMap.getBlobName(i.folderId,n.relPath)}getAllPathNames(n){return this._pathMap.getAllPathNames(n)}getAllQualifiedPathInfos(n){return this._pathMap.getAllQualifiedPathInfos(n)}getAllQualifiedPathNames(n){return this._pathMap.getAllQualifiedPathNames(n)}getAllPathInfo(n){return this._pathMap.getAllPathInfo(n)}_handlePathFound(n,i,s,c){let u=n.folderId;this._pathMap.insert(u,i,s,c),s==="File"&&c.accepted&&n.diskFileManager.ingestPath(u,i)}_handlePathCreated(n,i,s,c){let u=n.folderId;if(this._pathMap.insert(u,i,s,c),!!c.accepted){if(s==="File")n.diskFileManager.ingestPath(n.folderId,i),this._emitFileNotification(u,i,"disk");else if(s==="Directory"){let h=n.tracker?.pathFilter;if(h===void 0)return;n.enqueueSerializedOperation(()=>this._handleDirectoryCreated(n,i,h))}}}_handleFileChanged(n,i,s){let c=n.folderId;this._pathMap.insert(c,i,"File",s),s.accepted&&(n.diskFileManager.ingestPath(c,i),this._emitFileNotification(c,i,"disk"))}_handlePathDeleted(n,i){let s=n.folderId,c=this._pathMap.getPathInfo(s,i);if(c===void 0)return;this._deletePath(n.folderId,i);let[u,h]=c;h.accepted&&(u==="Directory"?this._handleDirectoryRemoved(n,i):u==="File"&&this._emitFileNotification(s,i,"disk"))}_deletePath(n,i){this._pathMap.remove(n,i)}async _handleDirectoryCreated(n,i,s){n.logger.info(`Directory created: ${i}`);let c=ht.file(n.repoRoot),u=new Oo(n.folderName,vt.joinPath(c,i),c,s);for await(let[h,g,b,y]of u)this._handlePathFound(n,g,b,y)}_handleDirectoryRemoved(n,i){n.logger.info(`Directory removed: ${i}`);let s=n.folderId,c=new Array;for(let[u]of this._pathMap.pathsInFolder(s))Fs(i,u)!==void 0&&c.push(u);for(let u of c)this._deletePath(s,u)}_emitFileNotification(n,i,s){}_reportSourceFolderStartup(n,i,s,c){let u=i.diskFileManager.metrics;n.info("Tracking enabled"),n.info(c.format()),n.info(u.format()),n.info(s.format())}_reportWorkspaceStartup(n){this._logger.info(`Workspace startup complete in ${n} ms`)}trackedSourceFolderNames(){return Array.from(this._registeredSourceFolders).filter(([n,i])=>ir(i)==="trackable").map(([n,i])=>({folderRoot:n}))}unitTestOnlyGetRepoRoot(n){let i=this._trackedSourceFolders.get(n);if(i!==void 0)return i.sourceFolder?.repoRoot}unitTestOnlySourceFolderBacklog(n){let i=this._trackedSourceFolders.get(n);if(i===void 0)return;let s=i.sourceFolder;if(s!==void 0&&s.initialEnumerationComplete)return s.diskFileManager.itemsInFlight}};var nl=class extends yt{constructor(n,i,s,c,u,h,g){super();this._extensionContext=n;this._augmentConfigListener=i;this._apiServer=s;this._auth=c;this._featureFlagManager=u;this._workspaceFolders=h;this._initialModelConfig=g;this._completionAcceptanceReporter=new Du(s),this._completionsModel=new ku(this,this._augmentConfigListener)}_completionServer=void 0;workspaceManager=void 0;_enableCancel;_modelInfo;get modelInfo(){return this._modelInfo}_completionAcceptanceReporter;enabled=!1;disposeOnDisable=[];_completionsModel;_logger=Oe("AugmentExtension");get completionServer(){return this._completionServer}get completionsModel(){return this._completionsModel}get completionReporter(){return this._completionAcceptanceReporter}get enableInProgress(){return this._enableCancel!==void 0}get ready(){return this.enabled&&!this.enableInProgress}async enable(){if(this.enabled||this.enableInProgress)return;let n=new Ni;this._enableCancel=n;try{await this._enable(n.token)}catch(i){if(this._logger.info(`Unable to enable extension: ${De(i)}`),process.env.JEST_WORKER_ID)throw i}finally{n.dispose(),this._enableCancel=void 0}}async _enable(n){(0,wx.assert)(!this.enabled);let i=this._workspaceFolders.map((u,h)=>({uri:ht.parse(u.uri),name:u.name,index:h}));if(this._auth.useOAuth){if(!await this._auth.getSession())return}else{if(!this._augmentConfigListener.config.apiToken){this._logger.warn("No API token is configured");return}if(!this._augmentConfigListener.config.completionURL){this._logger.warn("No completion URL is configured");return}}let s;try{if(s=this._initialModelConfig,s.models.length===0)throw new So;let u=s.defaultModel;if(this._modelInfo=s.models.find(h=>[h.name,h.internalName].includes(u)||h.name===(0,Px.createHash)("sha256").update(u).digest("hex")),this._modelInfo===void 0)throw new xo(u)}catch(u){let h=De(u);throw this._logger.error(`Failed to get model config: ${h}`),u}this._completionServer=new Su(this._apiServer,this._modelInfo.completionTimeoutMs,this._modelInfo.suggestedPrefixCharCount,this._modelInfo.suggestedSuffixCharCount);let c=this._featureFlagManager.currentFlags.maxUploadSizeBytes;this.workspaceManager=new tl(this._extensionContext,this._apiServer,this._featureFlagManager,this._completionServer,c,i),this.disposeOnDisable.push(this.workspaceManager);{let u=[this._completionAcceptanceReporter];for(let h of u)h.enableUpload(),this.disposeOnDisable.push(h)}}updateModelInfo(n){if(!this._modelInfo)throw new Error("Model info not set");n.suggestedPrefixCharCount!==void 0&&(this._modelInfo.suggestedPrefixCharCount=n.suggestedPrefixCharCount),n.suggestedSuffixCharCount!==void 0&&(this._modelInfo.suggestedSuffixCharCount=n.suggestedSuffixCharCount),this._modelInfo.completionTimeoutMs=n.completionTimeoutMs}disable(){for(this.enabled=!1;this.disposeOnDisable.length;)this.disposeOnDisable.pop().dispose();this.reset()}reset(){this._enableCancel?.cancel(),this._enableCancel?.dispose(),this._enableCancel=void 0,this.workspaceManager?.dispose(),this.workspaceManager=void 0}};function xx(t){let e=t.get("sessionId");return(e===void 0||!mh(e))&&(e=vs(),t.update("sessionId",e)),e}var Tn=(0,Me.createConnection)(),wg=new Me.TextDocuments(Na),Tx,rM=".config/augment/api_token",yg="https://staging-shard-0.api.augmentcode.com/",iM={clientID:"augment-vim-extension",url:"https://auth.augmentcode.com"},oM=process.env.TEST_TMPDIR?Us.join(process.env.TEST_TMPDIR,"data"):process.env.XDG_DATA_HOME||Us.join(Rx.default.homedir(),".local","share"),Dx=Us.join(oM,"vim-augment"),Sx=Us.join(process.env.HOME||"~",rM),Cx=il.existsSync(Sx)?il.readFileSync(Sx,"utf8").trim():null,be=Oe("server"),rl={apiToken:Cx??"",completionURL:Cx?yg:"",chat:{url:yg},modelName:"",enableUpload:!1,enableDebugFeatures:!1,oauth:iM,completions:{}},$o,Pg,or,kx=new eu,tn;async function Ix(t,e){if(await or.initState(),!or.isLoggedIn)throw new Error("Not logged in. Please login first.");let n=await $o.getModelConfig();if(n.models.length===0)throw new So;be.debug(`Received modelConfig: ${JSON.stringify(n,null,2)}`);let i=rl.modelName||n.defaultModel,s=n.models.find(u=>u.name===n.defaultModel);if(s===void 0)throw new xo(i);s.name=i,kx.update(n.featureFlags);let c=new vu;return new nl(t,c,$o,or,kx,e,n)}Tn.onInitialize(async t=>{be.info("Initializing Language Server"),Tx=t;let e=t.initializationOptions?.editor??"unknown",n=t.initializationOptions?.pluginVersion??"unknown",i=t.initializationOptions?.vimVersion??"unknown",s=`Augment.vim/${n} ${e}/${i}`;be.info(`User agent: ${s}`);let c=t.workspaceFolders??[];be.info(`Roots: ${JSON.stringify(c)}`);for(let y of c)be.info(`Root name, URI: ${y.name}, ${y.uri}`);let u;try{u=new Eo(ht.file(Dx))}catch(y){throw be.error(`Error initializing server context storage: ${De(y)}`),y}or=new wu(u,rl);let h=new Iu(u),g=xx(h);be.info(`Session ID: ${g}`),$o=new pu(rl,or,g,s,global.fetch),Pg=new xu(u,rl,$o,or);let b={capabilities:{completionProvider:{resolveProvider:!1},textDocumentSync:Me.TextDocumentSyncKind.Incremental}};try{tn=await Ix(u,c),await tn.enable(),be.info("Initialized completion server")}catch(y){be.error(`Error initializing completion server: ${De(y)}`)}return b});Tn.onInitialized(()=>{be.info("Language server initialized")});Tn.onCompletion(async t=>{let e=wg.get(t.textDocument.uri);if(!e)return be.warn(`Not tracking the document ${t.textDocument.uri}`),new Me.ResponseError(Me.ErrorCodes.InternalError,`Not tracking the document ${t.textDocument.uri}`);if(tn?.completionServer===void 0)return be.warn("Completion server is not initialized."),new Me.ResponseError(Me.ErrorCodes.InternalError,"Completion server is not initialized");if(!or.isLoggedIn)return be.warn("Not logged in. Please login first."),new Me.ResponseError(Me.ErrorCodes.InternalError,"Not logged in. Please login first.");try{let n=new hu(e),i=await tn.completionsModel.generateCompletion(n,t.position);return be.info(`Completion result: ${JSON.stringify(i)}`),[{label:i?.requestId??"",insertText:i?.completions[0]?.completionText??""}]}catch(n){return be.error(`Error getting completion: ${De(n)}`),new Me.ResponseError(Me.ErrorCodes.InternalError,`Error getting completion: ${De(n)}`)}});Tn.onRequest("augment/login",async()=>{try{return or.isLoggedIn?(be.info("Already logged in"),{loggedIn:!0,url:""}):(be.info("Logging in..."),{loggedIn:!1,url:await Pg.startFlow()})}catch(t){let e=t instanceof Error?t.stack:"No stack trace available",n=De(t);return be.error(`Error handling augment/login: ${n}`),be.error(`Stack trace: ${e}`),new Me.ResponseError(Me.ErrorCodes.InternalError,"Failed to process request. See server log for details.")}});Tn.onRequest("augment/logout",async()=>{try{return await or.removeSession(),tn?.disable(),be.info("Logged out."),{success:!0}}catch(t){let e=t instanceof Error?t.stack:"No stack trace available",n=De(t);return be.error(`Error handling augment/logout: ${n}`),be.error(`Stack trace: ${e}`),new Me.ResponseError(Me.ErrorCodes.InternalError,"Failed to process request. See server log for details.")}});Tn.onRequest("augment/token",async t=>{try{if(await Pg.handleAuthJson(t.code),!tn){let e=new Eo(ht.file(Dx)),n=Tx?.workspaceFolders??[];tn=await Ix(e,n),be.info("Initialized completion server")}return await tn.enable(),be.info("Logged in."),{success:!0}}catch(e){let n=e instanceof Error?e.stack:"No stack trace available",i=De(e);return be.error(`Error creating completion server: ${i}`),be.error(`Stack trace: ${n}`),new Me.ResponseError(Me.ErrorCodes.InternalError,"Failed to process request. See server log for details.")}});Tn.onRequest("augment/status",()=>{let t=!!or.isLoggedIn,e;if(tn?.workspaceManager){let n=0,i=0,s=tn.workspaceManager.getSyncingProgress();for(let c of s)c.progress&&c.progress.newlyTracked&&(be.info(`New folder ${c.folderRoot} sync progress: tracked=${c.progress.trackedFiles}, backlog=${c.progress.backlogSize}`),n+=c.progress.trackedFiles,i+=c.progress.trackedFiles-c.progress.backlogSize);e=n>0?Math.floor(i/n*100):100}return{loggedIn:t,syncPercentage:e}});Tn.onRequest("augment/chat",async t=>{let e=t.textDocumentPosition.textDocument.uri,n=wg.get(e);if(n||be.warn(`Not tracking the document ${e}`),tn?.completionServer===void 0)return be.warn("Completion server is not initialized."),new Me.ResponseError(Me.ErrorCodes.InternalError,"Completion server is not initialized");if(!or.isLoggedIn)return be.warn("Not logged in. Please login first."),new Me.ResponseError(Me.ErrorCodes.InternalError,"Not logged in. Please login first.");let i=t.textDocumentPosition.position,s=n?.offsetAt(i)||0,c=n?.getText()||"",u=s,h=c.length-s,g=c.slice(Math.max(0,s-u),s),b=c.slice(s,s+h),y=tn.completionServer.createRequestId();be.info(`Chat (${y}) requested`),n&&(be.info(`Document URI: ${n.uri}`),be.info(`Language ID: ${n.languageId}`)),t.selectedText!==void 0&&be.info(`Selected text: ${t.selectedText}`);let F=tn?.workspaceManager?.getContext()?.blobs??{checkpointId:void 0,addedBlobs:[],deletedBlobs:[]};if(t.partialResultToken===void 0){be.info("No partialResultToken provided. Sending full response.");try{let E=await $o.chat(y,t.message,[],F,[],[],void 0,[],void 0,t.selectedText,g,b,n?.uri,n?.languageId);return be.info(`Chat result: ${JSON.stringify(E)}`),{label:y,text:E.text}}catch(E){return be.error(`Error getting chat: ${De(E)}`),new Me.ResponseError(Me.ErrorCodes.InternalError,`Error getting chat: ${De(E)}`)}}be.info(`PartialResultToken provided: ${t.partialResultToken}`);try{let E=await $o.chatStream(y,t.message,[],F,[],[],void 0,[],void 0,t.selectedText,g,b,n?.uri,n?.languageId,void 0,!1,void 0,void 0);for await(let L of E)be.debug(`Chat chunk for ${y}: ${L.text}`),await Tn.sendNotification("augment/chatChunk",{token:t.partialResultToken,value:{label:y,text:L.text}})}catch(E){return be.error(`Error streaming chat: ${De(E)}`),new Me.ResponseError(Me.ErrorCodes.InternalError,`Error streaming chat: ${De(E)}`)}return{label:y,text:""}});var sM="https://api.github.com/repos/augmentcode/augment.vim/tags?per_page=1";Tn.onRequest("augment/pluginVersion",async()=>{try{let t=await fetch(sM);if(!t.ok)return be.error(`Failed to fetch version: ${t.statusText}`),new Me.ResponseError(Me.ErrorCodes.InternalError,`Failed to fetch plugin version: ${t.statusText}`);let e=await t.json();return Array.isArray(e)&&e.length>0&&typeof e[0].name=="string"?{version:e[0].name}:new Me.ResponseError(Me.ErrorCodes.InternalError,"No version tags found for plugin")}catch(t){return be.error(`Error fetching version: ${De(t)}`),new Me.ResponseError(Me.ErrorCodes.InternalError,`Failed to fetch plugin version: ${De(t)}`)}});Tn.onNotification("augment/resolveCompletion",t=>{if(be.info(`Completion (${t.requestId}) resolved with accept=${t.accept}`),tn?.completionReporter===void 0){be.warn("Completion reporter is not yet initialized.");return}tn.completionReporter.reportResolution(t.requestId,Date.now(),Date.now(),t.accept?0:void 0)});wg.listen(Tn);Tn.listen();be.info("Language server started");0&&(module.exports={API_ENDPOINT});
/*! Bundled license information:

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
